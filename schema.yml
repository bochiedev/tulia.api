openapi: 3.0.3
info:
  title: Tulia AI WhatsApp Commerce API
  version: 1.0.0
  description: "\nMulti-tenant WhatsApp commerce and services platform with comprehensive\
    \ RBAC.\n\n## Authentication\n\nAll API requests require JWT authentication:\n\
    - `Authorization: Bearer <token>` - JWT token obtained from `/v1/auth/login` or\
    \ `/v1/auth/register`\n- `X-TENANT-ID`: UUID of the tenant context (required for\
    \ tenant-scoped operations)\n\n**Note:** Webhooks are public endpoints verified\
    \ by signature, not by JWT tokens.\n\n## Rate Limiting\n\nAuthentication endpoints\
    \ are rate limited to prevent abuse:\n\n| Endpoint | Rate Limit | Key Type |\n\
    |----------|-----------|----------|\n| `POST /v1/auth/register` | 3/hour | IP\
    \ address |\n| `POST /v1/auth/login` | 5/min per IP, 10/hour per email | IP +\
    \ Email |\n| `POST /v1/auth/verify-email` | 10/hour | IP address |\n| `POST /v1/auth/forgot-password`\
    \ | 3/hour | IP address |\n| `POST /v1/auth/reset-password` | 5/hour | IP address\
    \ |\n\nWhen rate limit is exceeded, the API returns `429 Too Many Requests` with\
    \ a `Retry-After` header.\n\nSee the [Rate Limiting Guide](/docs/RATE_LIMITING.md)\
    \ for complete documentation.\n\n## Authorization (RBAC)\n\nThe platform implements\
    \ Role-Based Access Control (RBAC) with the following components:\n\n### Permissions\n\
    Granular capabilities identified by codes (e.g., `catalog:view`, `finance:withdraw:approve`).\n\
    See the `/v1/permissions` endpoint for the complete list.\n\n### Roles\nCollections\
    \ of permissions that can be assigned to users. Each tenant has default roles:\n\
    - **Owner**: All permissions\n- **Admin**: All permissions except `finance:withdraw:approve`\n\
    - **Finance Admin**: `analytics:view`, `finance:*`, `orders:view`\n- **Catalog\
    \ Manager**: `analytics:view`, `catalog:*`, `services:*`, `availability:edit`\n\
    - **Support Lead**: `conversations:view`, `handoff:perform`, `orders:view`, `appointments:view`\n\
    - **Analyst**: `analytics:view`, `catalog:view`, `services:view`, `orders:view`,\
    \ `appointments:view`\n\n### Scopes\nThe effective set of permission codes a user\
    \ has for a specific tenant, resolved from:\n1. Roles assigned to the user\n2.\
    \ User-specific permission overrides (grants or denies)\n\nDeny overrides always\
    \ take precedence over role grants.\n\n### Four-Eyes Approval\nSensitive operations\
    \ like financial withdrawals require two different users:\n- One user initiates\
    \ the action (`finance:withdraw:initiate`)\n- A different user approves it (`finance:withdraw:approve`)\n\
    \n## Multi-Tenant Isolation\n\nAll data is strictly isolated by tenant. Users\
    \ can be members of multiple tenants with different roles in each.\nThe `X-TENANT-ID`\
    \ header determines which tenant context is active for the request.\n\n## Canonical\
    \ Permissions\n\n| Code | Description | Category |\n|------|-------------|----------|\n\
    | `catalog:view` | View products and catalog | Catalog |\n| `catalog:edit` | Create,\
    \ update, delete products | Catalog |\n| `services:view` | View services | Services\
    \ |\n| `services:edit` | Create, update, delete services | Services |\n| `availability:edit`\
    \ | Manage service availability windows | Services |\n| `conversations:view` |\
    \ View customer conversations | Messaging |\n| `handoff:perform` | Perform human\
    \ handoff | Messaging |\n| `orders:view` | View orders | Orders |\n| `orders:edit`\
    \ | Create, update orders | Orders |\n| `appointments:view` | View appointments\
    \ | Appointments |\n| `appointments:edit` | Create, update, cancel appointments\
    \ | Appointments |\n| `analytics:view` | View analytics and reports | Analytics\
    \ |\n| `finance:view` | View wallet and transactions | Finance |\n| `finance:withdraw:initiate`\
    \ | Initiate withdrawal requests | Finance |\n| `finance:withdraw:approve` | Approve\
    \ withdrawal requests | Finance |\n| `finance:reconcile` | Perform financial reconciliation\
    \ | Finance |\n| `integrations:manage` | Manage external integrations | Integrations\
    \ |\n| `users:manage` | Invite users, assign roles, manage permissions | Users\
    \ |\n\n## Example Workflows\n\n### Login and Get JWT Token\n```bash\n# Login to\
    \ get JWT token\ncurl -X POST https://api.tulia.ai/v1/auth/login \\\n  -H \"Content-Type:\
    \ application/json\" \\\n  -d '{\n    \"email\": \"user@example.com\",\n    \"\
    password\": \"your-password\"\n  }'\n# Returns: {\"token\": \"eyJ...\", \"user\"\
    : {...}}\n\n# Use the token in subsequent requests\nexport TOKEN=\"eyJ...\"\n\
    ```\n\n### Invite a User and Assign Roles\n```bash\n# 1. Invite user (requires\
    \ users:manage scope)\ncurl -X POST https://api.tulia.ai/v1/memberships/{tenant_id}/invite\
    \ \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"X-TENANT-ID: {tenant_id}\"\
    \ \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"email\": \"newuser@example.com\"\
    ,\n    \"role_ids\": [\"role-uuid-1\", \"role-uuid-2\"]\n  }'\n\n# 2. User accepts\
    \ invitation and logs in\n\n# 3. Assign additional roles\ncurl -X POST https://api.tulia.ai/v1/memberships/{tenant_id}/{user_id}/roles\
    \ \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"X-TENANT-ID: {tenant_id}\"\
    \ \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"role_ids\": [\"\
    role-uuid-3\"]\n  }'\n```\n\n### Grant User-Specific Permission Override\n```bash\n\
    # Grant a specific permission to a user (overrides role permissions)\ncurl -X\
    \ POST https://api.tulia.ai/v1/users/{user_id}/permissions \\\n  -H \"Authorization:\
    \ Bearer $TOKEN\" \\\n  -H \"X-TENANT-ID: {tenant_id}\" \\\n  -H \"Content-Type:\
    \ application/json\" \\\n  -d '{\n    \"permission_code\": \"finance:reconcile\"\
    ,\n    \"granted\": true,\n    \"reason\": \"Temporary access for Q4 audit\"\n\
    \  }'\n\n# Deny a permission (even if granted by role)\ncurl -X POST https://api.tulia.ai/v1/users/{user_id}/permissions\
    \ \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"X-TENANT-ID: {tenant_id}\"\
    \ \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"permission_code\"\
    : \"catalog:edit\",\n    \"granted\": false,\n    \"reason\": \"Suspended pending\
    \ investigation\"\n  }'\n```\n\n### Four-Eyes Withdrawal Approval\n```bash\n#\
    \ 1. User A initiates withdrawal (requires finance:withdraw:initiate)\ncurl -X\
    \ POST https://api.tulia.ai/v1/wallet/withdraw \\\n  -H \"Authorization: Bearer\
    \ $TOKEN_USER_A\" \\\n  -H \"X-TENANT-ID: {tenant_id}\" \\\n  -H \"Content-Type:\
    \ application/json\" \\\n  -d '{\n    \"amount\": 1000.00,\n    \"currency\":\
    \ \"USD\",\n    \"destination\": \"bank_account_123\"\n  }'\n# Returns: {\"transaction_id\"\
    : \"txn-uuid\", \"status\": \"pending_approval\"}\n\n# 2. User B approves withdrawal\
    \ (requires finance:withdraw:approve, must be different user)\ncurl -X POST https://api.tulia.ai/v1/wallet/withdrawals/{transaction_id}/approve\
    \ \\\n  -H \"Authorization: Bearer $TOKEN_USER_B\" \\\n  -H \"X-TENANT-ID: {tenant_id}\"\
    \ \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"notes\": \"Approved\
    \ for monthly payout\"\n  }'\n# Returns: {\"transaction_id\": \"txn-uuid\", \"\
    status\": \"approved\"}\n\n# If User A tries to approve their own withdrawal:\n\
    # Returns: 409 Conflict - \"Four-eyes validation failed: initiator and approver\
    \ must be different users\"\n```\n    "
paths:
  /v1/admin/tenants:
    get:
      operationId: admin_tenants_list
      description: Retrieve paginated list of all tenants with subscription and wallet
        info. Requires platform operator (superuser) access.
      summary: List all tenants (admin)
      parameters:
      - in: query
        name: page
        schema:
          type: integer
        description: Page number
      - in: query
        name: page_size
        schema:
          type: integer
        description: Number of items per page (max 100)
      - in: query
        name: search
        schema:
          type: string
        description: Search by tenant name or slug
      - in: query
        name: status
        schema:
          type: string
          enum:
          - active
          - canceled
          - suspended
          - trial
          - trial_expired
        description: Filter by tenant status
      - in: query
        name: tier
        schema:
          type: string
          format: uuid
        description: Filter by subscription tier ID
      tags:
      - Admin - Tenants
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AdminTenantList'
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/admin/tenants/{tenant_id}:
    get:
      operationId: admin_tenants_retrieve
      description: Retrieve detailed information about a specific tenant. Requires
        platform operator (superuser) access.
      summary: Get tenant details (admin)
      parameters:
      - in: path
        name: tenant_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Admin - Tenants
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminTenantDetail'
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/admin/tenants/{tenant_id}/subscription:
    post:
      operationId: admin_tenants_subscription_create
      description: "\nChange a tenant's subscription tier. This will:\n- Update the\
        \ tenant's subscription_tier\n- Create or update the Subscription record\n\
        - Log a SubscriptionEvent for audit trail\n- Apply new feature limits immediately\n\
        \n**Example curl:**\n```bash\ncurl -X POST https://api.tulia.ai/v1/admin/tenants/{tenant_id}/subscription\
        \ \\\n  -H \"Authorization: Bearer {admin_token}\" \\\n  -H \"Content-Type:\
        \ application/json\" \\\n  -d '{\n    \"tier_id\": \"tier-uuid\",\n    \"\
        billing_cycle\": \"monthly\",\n    \"notes\": \"Upgraded to Growth tier\"\n\
        \  }'\n```\n\nRequires platform operator (superuser) access.\n        "
      summary: Change tenant subscription tier (admin)
      parameters:
      - in: path
        name: tenant_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Admin - Tenants
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AdminSubscriptionChangeRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminTenantDetail'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/admin/tenants/{tenant_id}/subscription/waiver:
    post:
      operationId: admin_tenants_subscription_waiver_create
      description: "\nWaive or unwaive subscription fees for a tenant. When waived:\n\
        - Tenant status remains 'active'\n- No invoices are generated\n- All tier\
        \ features remain accessible\n- Displayed as \"Subscription Waived\" in tenant\
        \ dashboard\n\n**Example curl:**\n```bash\ncurl -X POST https://api.tulia.ai/v1/admin/tenants/{tenant_id}/subscription/waiver\
        \ \\\n  -H \"Authorization: Bearer {admin_token}\" \\\n  -H \"Content-Type:\
        \ application/json\" \\\n  -d '{\n    \"waived\": true,\n    \"notes\": \"\
        Strategic partnership - waive fees for 12 months\"\n  }'\n```\n\nRequires\
        \ platform operator (superuser) access.\n        "
      summary: Waive subscription fees (admin)
      parameters:
      - in: path
        name: tenant_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Admin - Tenants
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AdminSubscriptionWaiverRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminTenantDetail'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/admin/wallet/withdrawals/{transaction_id}/process:
    post:
      operationId: admin_wallet_withdrawals_process_create
      description: "\nComplete or fail a pending withdrawal. This is for platform\
        \ operator processing.\n\n**Actions:**\n- `complete`: Mark withdrawal as completed\
        \ (funds transferred)\n- `fail`: Mark withdrawal as failed and credit amount\
        \ back to wallet\n\n**Example curl:**\n```bash\ncurl -X POST https://api.tulia.ai/v1/admin/wallet/withdrawals/{transaction_id}/process\
        \ \\\n  -H \"Authorization: Bearer {admin_token}\" \\\n  -H \"Content-Type:\
        \ application/json\" \\\n  -d '{\n    \"action\": \"complete\",\n    \"notes\"\
        : \"Bank transfer completed\"\n  }'\n```\n\nFor four-eyes approval within\
        \ a tenant, use `/v1/wallet/withdrawals/{id}/approve` instead.\n\nRequires\
        \ platform operator (superuser) access.\n        "
      summary: Process withdrawal (admin)
      parameters:
      - in: path
        name: transaction_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Admin - Withdrawals
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WithdrawalProcessRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Transaction'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/analytics/admin/revenue:
    get:
      operationId: analytics_admin_revenue_retrieve
      description: |-
        Get platform revenue analytics (admin/platform operator only).

        This endpoint is NOT tenant-scoped and requires superuser access.

        Query Parameters:
            range: Date range like '7d', '30d' (default: '30d')
            group_by: 'date', 'tier', or 'tenant' (default: 'date')

        Returns:
            200: Revenue metrics
            400: Invalid parameters
            403: Not a superuser

        Example:
            GET /v1/admin/analytics/revenue?range=30d&group_by=tier

        Required scope: Platform operator (superuser)
      tags:
      - analytics
      security:
      - JWTAuth: []
      responses:
        '200':
          description: No response body
  /v1/analytics/daily:
    get:
      operationId: analytics_daily_retrieve
      description: |-
        Get daily analytics metrics with optional date filtering.

        Query Parameters:
            date: Specific date (YYYY-MM-DD)
            start_date: Start of date range (YYYY-MM-DD)
            end_date: End of date range (YYYY-MM-DD)

        Returns:
            200: List of daily analytics records
            400: Invalid date format
            403: Missing analytics:view permission

        Example:
            GET /v1/analytics/daily?start_date=2025-11-01&end_date=2025-11-10

        Required scope: analytics:view
      tags:
      - analytics
      security:
      - JWTAuth: []
      responses:
        '200':
          description: No response body
  /v1/analytics/funnel:
    get:
      operationId: analytics_funnel_retrieve
      description: |-
        Get conversion funnel metrics for products and services.

        Query Parameters:
            range: Date range like '7d', '30d' (default: '7d')

        Returns:
            200: Funnel metrics
            400: Invalid date range
            403: Missing analytics:view permission

        Example:
            GET /v1/analytics/funnel?range=30d
      tags:
      - analytics
      security:
      - JWTAuth: []
      responses:
        '200':
          description: No response body
  /v1/analytics/messaging:
    get:
      operationId: analytics_messaging_retrieve
      description: |-
        Get messaging analytics grouped by message_type.

        Query Parameters:
            range: Date range like '7d', '30d' (default: '7d')

        Returns:
            200: Messaging metrics by type
            400: Invalid date range
            403: Missing analytics:view permission

        Example:
            GET /v1/analytics/messaging?range=30d
      tags:
      - analytics
      security:
      - JWTAuth: []
      responses:
        '200':
          description: No response body
  /v1/analytics/overview:
    get:
      operationId: analytics_overview_retrieve
      description: |-
        Get overview metrics for dashboard with date range aggregation.

        Query Parameters:
            range: Date range like '7d', '30d', '90d' (default: '7d')

        Returns:
            200: Aggregated metrics
            400: Invalid date range
            403: Missing analytics:view permission

        Example:
            GET /v1/analytics/overview?range=30d

        Required scope: analytics:view
      tags:
      - analytics
      security:
      - JWTAuth: []
      responses:
        '200':
          description: No response body
  /v1/audit-logs:
    get:
      operationId: audit_logs_list
      description: "\nList audit logs for the tenant. Supports filtering by action,\
        \ target_type, user, and date range.\n\n**Required scope:** `analytics:view`\n\
        \nAudit logs track all RBAC changes and sensitive operations including:\n\
        - User invitations and role assignments\n- Permission grants and denials\n\
        - Role modifications\n- Financial operations (withdrawals, approvals)\n- Catalog\
        \ changes\n\nQuery parameters:\n- `action`: Filter by action type (e.g., 'user_invited',\
        \ 'role_assigned')\n- `target_type`: Filter by target type (e.g., 'TenantUser',\
        \ 'Role')\n- `user_id`: Filter by user who performed the action\n- `from_date`:\
        \ Filter by date range start (ISO 8601)\n- `to_date`: Filter by date range\
        \ end (ISO 8601)\n        "
      summary: List audit logs
      parameters:
      - in: query
        name: action
        schema:
          type: string
        description: Filter by action type
      - in: query
        name: from_date
        schema:
          type: string
          format: date-time
        description: Filter from date
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      - name: page_size
        required: false
        in: query
        description: Number of results to return per page.
        schema:
          type: integer
      - in: query
        name: target_type
        schema:
          type: string
        description: Filter by target type
      - in: query
        name: to_date
        schema:
          type: string
          format: date-time
        description: Filter to date
      - in: query
        name: user_id
        schema:
          type: string
          format: uuid
        description: Filter by user ID
      tags:
      - RBAC - Audit
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedAuditLogList'
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/auth/forgot-password:
    post:
      operationId: auth_forgot_password_create
      description: "\nRequest password reset for a user account.\n\nSends password\
        \ reset email with token valid for 24 hours.\n\n**No authentication required**\
        \ - this is a public endpoint.\n\n**Rate limit**: 3 requests/hour per IP\n\
        \    "
      summary: Request password reset
      tags:
      - Authentication
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordResetRequestRequest'
            examples:
              PasswordResetRequest:
                value:
                  email: user@example.com
                summary: Password Reset Request
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: If an account exists with this email, a password reset
                      link has been sent.
                  summary: Success Response
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                RateLimitExceeded:
                  value:
                    error: Rate limit exceeded. Please try again later.
                  summary: Rate Limit Exceeded
          description: ''
  /v1/auth/login:
    post:
      operationId: auth_login_create
      description: "\nAuthenticate user with email and password.\n\nReturns JWT token\
        \ for API authentication and user information.\n\n**No authentication required**\
        \ - this is a public endpoint.\n\n**Rate limits**:\n- 5 requests/minute per\
        \ IP address\n- 10 requests/hour per email address\n    "
      summary: Login user
      tags:
      - Authentication
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
            examples:
              LoginRequest:
                value:
                  email: user@example.com
                  password: SecurePass123!
                summary: Login Request
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    user:
                      id: 123e4567-e89b-12d3-a456-426614174000
                      email: user@example.com
                      first_name: John
                      last_name: Doe
                      full_name: John Doe
                      email_verified: true
                    token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                    message: Login successful
                  summary: Success Response
          description: ''
        '401':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                InvalidCredentials:
                  value:
                    error: Invalid email or password
                  summary: Invalid Credentials
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                RateLimitExceeded:
                  value:
                    error: Rate limit exceeded. Please try again later.
                    code: RATE_LIMIT_EXCEEDED
                  summary: Rate Limit Exceeded
          description: ''
  /v1/auth/logout:
    post:
      operationId: auth_logout_create
      description: "\nLogout the authenticated user.\n\nSince JWT tokens are stateless,\
        \ this endpoint primarily serves as a client-side signal\nto clear the token.\
        \ The token will remain valid until expiration.\n\nFor enhanced security,\
        \ consider implementing a token blacklist if needed.\n\nRequires valid JWT\
        \ token in Authorization header.\n    "
      summary: Logout user
      tags:
      - Authentication
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Logout successful
                  summary: Success Response
          description: ''
        '401':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/auth/me:
    get:
      operationId: auth_me_retrieve
      description: "\nGet comprehensive profile information for the authenticated\
        \ user.\n\nReturns complete user data including:\n- Basic profile information\
        \ (name, email, phone)\n- Account status (active, verified, 2FA enabled)\n\
        - All tenant memberships with roles and permissions\n- Pending tenant invitations\n\
        - Activity timestamps\n\nThis endpoint is useful for:\n- Displaying user profile\
        \ in the UI\n- Building tenant switcher (workspace selector)\n- Checking user\
        \ permissions across tenants\n- Managing pending invitations\n\nRequires valid\
        \ JWT token in Authorization header.\n    "
      summary: Get current user profile
      tags:
      - Authentication
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfile'
              examples:
                SuccessResponse:
                  value:
                    id: 123e4567-e89b-12d3-a456-426614174000
                    email: user@example.com
                    first_name: John
                    last_name: Doe
                    full_name: John Doe
                    phone: '+1234567890'
                    is_active: true
                    is_superuser: false
                    email_verified: true
                    two_factor_enabled: false
                    last_login_at: '2025-01-15T10:30:00Z'
                    created_at: '2025-01-01T00:00:00Z'
                    updated_at: '2025-01-15T10:30:00Z'
                    total_tenants: 2
                    tenants:
                    - membership_id: 456e4567-e89b-12d3-a456-426614174001
                      tenant:
                        id: 789e4567-e89b-12d3-a456-426614174002
                        name: Acme Corp
                        slug: acme-corp
                        status: active
                        subscription:
                          tier: professional
                          status: active
                          trial_ends_at: null
                      roles:
                      - id: abc12345-e89b-12d3-a456-426614174003
                        name: Owner
                        description: Full access to all features
                        is_system: true
                      scopes:
                      - analytics:view
                      - catalog:edit
                      - catalog:view
                      - conversations:view
                      - finance:view
                      - integrations:manage
                      - orders:edit
                      - orders:view
                      - users:manage
                      joined_at: '2025-01-01T00:00:00Z'
                      last_seen_at: '2025-01-15T10:30:00Z'
                    - membership_id: 456e4567-e89b-12d3-a456-426614174004
                      tenant:
                        id: 789e4567-e89b-12d3-a456-426614174005
                        name: Beta Inc
                        slug: beta-inc
                        status: active
                        subscription:
                          tier: trial
                          status: active
                          trial_ends_at: '2025-02-01T00:00:00Z'
                      roles:
                      - id: def12345-e89b-12d3-a456-426614174006
                        name: Catalog Manager
                        description: Manage products and services
                        is_system: true
                      scopes:
                      - analytics:view
                      - catalog:edit
                      - catalog:view
                      - services:edit
                      - services:view
                      joined_at: '2025-01-10T00:00:00Z'
                      last_seen_at: '2025-01-14T15:20:00Z'
                    pending_invites:
                    - id: ghi12345-e89b-12d3-a456-426614174007
                      tenant:
                        id: jkl12345-e89b-12d3-a456-426614174008
                        name: Gamma LLC
                        slug: gamma-llc
                      invited_by:
                        email: admin@gamma-llc.com
                        name: Jane Admin
                      invited_at: '2025-01-14T12:00:00Z'
                  summary: Success Response
          description: ''
        '401':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    put:
      operationId: auth_me_update
      description: "\nGet comprehensive profile information for the authenticated\
        \ user.\n\nReturns complete user data including:\n- Basic profile information\
        \ (name, email, phone)\n- Account status (active, verified, 2FA enabled)\n\
        - All tenant memberships with roles and permissions\n- Pending tenant invitations\n\
        - Activity timestamps\n\nThis endpoint is useful for:\n- Displaying user profile\
        \ in the UI\n- Building tenant switcher (workspace selector)\n- Checking user\
        \ permissions across tenants\n- Managing pending invitations\n\nRequires valid\
        \ JWT token in Authorization header.\n    "
      summary: Get current user profile
      tags:
      - Authentication
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfile'
              examples:
                SuccessResponse:
                  value:
                    id: 123e4567-e89b-12d3-a456-426614174000
                    email: user@example.com
                    first_name: John
                    last_name: Doe
                    full_name: John Doe
                    phone: '+1234567890'
                    is_active: true
                    is_superuser: false
                    email_verified: true
                    two_factor_enabled: false
                    last_login_at: '2025-01-15T10:30:00Z'
                    created_at: '2025-01-01T00:00:00Z'
                    updated_at: '2025-01-15T10:30:00Z'
                    total_tenants: 2
                    tenants:
                    - membership_id: 456e4567-e89b-12d3-a456-426614174001
                      tenant:
                        id: 789e4567-e89b-12d3-a456-426614174002
                        name: Acme Corp
                        slug: acme-corp
                        status: active
                        subscription:
                          tier: professional
                          status: active
                          trial_ends_at: null
                      roles:
                      - id: abc12345-e89b-12d3-a456-426614174003
                        name: Owner
                        description: Full access to all features
                        is_system: true
                      scopes:
                      - analytics:view
                      - catalog:edit
                      - catalog:view
                      - conversations:view
                      - finance:view
                      - integrations:manage
                      - orders:edit
                      - orders:view
                      - users:manage
                      joined_at: '2025-01-01T00:00:00Z'
                      last_seen_at: '2025-01-15T10:30:00Z'
                    - membership_id: 456e4567-e89b-12d3-a456-426614174004
                      tenant:
                        id: 789e4567-e89b-12d3-a456-426614174005
                        name: Beta Inc
                        slug: beta-inc
                        status: active
                        subscription:
                          tier: trial
                          status: active
                          trial_ends_at: '2025-02-01T00:00:00Z'
                      roles:
                      - id: def12345-e89b-12d3-a456-426614174006
                        name: Catalog Manager
                        description: Manage products and services
                        is_system: true
                      scopes:
                      - analytics:view
                      - catalog:edit
                      - catalog:view
                      - services:edit
                      - services:view
                      joined_at: '2025-01-10T00:00:00Z'
                      last_seen_at: '2025-01-14T15:20:00Z'
                    pending_invites:
                    - id: ghi12345-e89b-12d3-a456-426614174007
                      tenant:
                        id: jkl12345-e89b-12d3-a456-426614174008
                        name: Gamma LLC
                        slug: gamma-llc
                      invited_by:
                        email: admin@gamma-llc.com
                        name: Jane Admin
                      invited_at: '2025-01-14T12:00:00Z'
                  summary: Success Response
          description: ''
        '401':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/auth/refresh-token:
    post:
      operationId: auth_refresh_token_create
      description: "\nRefresh JWT token for authenticated user.\n\nReturns a new JWT\
        \ token with extended expiration.\n\nRequires valid JWT token in Authorization\
        \ header.\n    "
      summary: Refresh JWT token
      tags:
      - Authentication
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                    message: Token refreshed successfully
                  summary: Success Response
          description: ''
        '401':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/auth/register:
    post:
      operationId: auth_register_create
      description: "\nRegister a new user account with first tenant.\n\nCreates:\n\
        - User account with hashed password\n- First tenant (trial status)\n- TenantUser\
        \ membership with Owner role\n- TenantSettings with defaults\n- Email verification\
        \ token\n\nReturns JWT token for immediate login and tenant information.\n\
        \n**No authentication required** - this is a public endpoint.\n\n**Rate limit**:\
        \ 3 requests/hour per IP\n    "
      summary: Register new user
      tags:
      - Authentication
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegistrationRequest'
            examples:
              RegistrationRequest:
                value:
                  email: user@example.com
                  password: SecurePass123!
                  first_name: John
                  last_name: Doe
                  business_name: Acme Corp
                summary: Registration Request
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    user:
                      id: 123e4567-e89b-12d3-a456-426614174000
                      email: user@example.com
                      first_name: John
                      last_name: Doe
                      full_name: John Doe
                      email_verified: false
                    tenant:
                      id: 123e4567-e89b-12d3-a456-426614174001
                      name: Acme Corp
                      slug: acme-corp
                      status: active
                    token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                    message: Registration successful. Please check your email to verify
                      your account.
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                EmailAlreadyExists:
                  value:
                    error: Validation error
                    details:
                      email:
                      - A user with this email already exists.
                  summary: Email Already Exists
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                RateLimitExceeded:
                  value:
                    error: Rate limit exceeded. Please try again later.
                  summary: Rate Limit Exceeded
          description: ''
  /v1/auth/reset-password:
    post:
      operationId: auth_reset_password_create
      description: "\nReset user password with reset token.\n\nToken is sent via email\
        \ and is valid for 24 hours.\n\n**No authentication required** - this is a\
        \ public endpoint.\n\n**Rate limit**: 5 requests/hour per IP\n    "
      summary: Reset password
      tags:
      - Authentication
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordResetRequest'
            examples:
              PasswordResetRequest:
                value:
                  token: abc123def456...
                  new_password: NewSecurePass123!
                summary: Password Reset Request
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Password reset successfully
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                InvalidToken:
                  value:
                    error: Invalid or expired reset token
                  summary: Invalid Token
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                RateLimitExceeded:
                  value:
                    error: Rate limit exceeded. Please try again later.
                    code: RATE_LIMIT_EXCEEDED
                  summary: Rate Limit Exceeded
          description: ''
  /v1/auth/verify-email:
    post:
      operationId: auth_verify_email_create
      description: "\nVerify user email address with verification token.\n\nToken\
        \ is sent via email during registration and is valid for 24 hours.\n\n**No\
        \ authentication required** - this is a public endpoint.\n\n**Rate limit**:\
        \ 10 requests/hour per IP\n    "
      summary: Verify email address
      tags:
      - Authentication
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EmailVerificationRequest'
            examples:
              VerificationRequest:
                value:
                  token: abc123def456...
                summary: Verification Request
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Email verified successfully
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                InvalidToken:
                  value:
                    error: Invalid or expired verification token
                  summary: Invalid Token
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                RateLimitExceeded:
                  value:
                    error: Rate limit exceeded. Please try again later.
                    code: RATE_LIMIT_EXCEEDED
                  summary: Rate Limit Exceeded
          description: ''
  /v1/bot/agent-config:
    get:
      operationId: bot_agent_config_retrieve
      description: Retrieve the AI agent configuration for the authenticated tenant.
        If no configuration exists, returns default configuration.
      summary: Get agent configuration
      tags:
      - Bot
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentConfiguration'
          description: ''
        '403':
          description: Forbidden - Missing required scope 'integrations:manage'
        '404':
          description: Not found - Tenant does not exist
    put:
      operationId: bot_agent_config_update
      description: Update the AI agent configuration for the authenticated tenant.
        Supports partial updates - only provided fields will be updated.
      summary: Update agent configuration
      tags:
      - Bot
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AgentConfigurationUpdateRequest'
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentConfiguration'
          description: ''
        '400':
          description: Bad request - Invalid configuration data
        '403':
          description: Forbidden - Missing required scope 'integrations:manage'
        '404':
          description: Not found - Tenant does not exist
        '429':
          description: Too many requests - Rate limit exceeded
  /v1/bot/analytics/conversations:
    get:
      operationId: bot_analytics_conversations_retrieve
      description: Retrieve statistics about AI agent conversations including total
        interactions, average confidence scores, response times, and message type
        distribution.
      summary: Get conversation statistics
      parameters:
      - in: query
        name: end_date
        schema:
          type: string
        description: 'End date for analytics (YYYY-MM-DD). Default: today'
      - in: query
        name: start_date
        schema:
          type: string
        description: 'Start date for analytics (YYYY-MM-DD). Default: 30 days ago'
      tags:
      - Bot - Analytics
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  total_interactions:
                    type: integer
                  total_conversations:
                    type: integer
                  average_confidence:
                    type: number
                  average_processing_time_ms:
                    type: number
                  high_confidence_rate:
                    type: number
                  low_confidence_rate:
                    type: number
                  message_type_distribution:
                    type: object
                    properties:
                      text:
                        type: integer
                      button:
                        type: integer
                      list:
                        type: integer
                      media:
                        type: integer
                  model_usage:
                    type: object
                    additionalProperties:
                      type: integer
          description: Conversation statistics
        '403':
          description: Forbidden - Missing required scope 'analytics:view'
  /v1/bot/analytics/costs:
    get:
      operationId: bot_analytics_costs_retrieve
      description: Retrieve cost analytics including total token usage, estimated
        costs by model, and cost trends over time.
      summary: Get cost tracking analytics
      parameters:
      - in: query
        name: end_date
        schema:
          type: string
        description: 'End date for analytics (YYYY-MM-DD). Default: today'
      - in: query
        name: group_by
        schema:
          type: string
        description: 'Group results by: day, week, month, model. Default: model'
      - in: query
        name: start_date
        schema:
          type: string
        description: 'Start date for analytics (YYYY-MM-DD). Default: 30 days ago'
      tags:
      - Bot - Analytics
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  total_tokens:
                    type: integer
                  total_cost:
                    type: string
                  average_cost_per_interaction:
                    type: string
                  cost_by_model:
                    type: object
                    additionalProperties:
                      type: object
                      properties:
                        total_tokens:
                          type: integer
                        total_cost:
                          type: string
                        interaction_count:
                          type: integer
          description: Cost analytics
        '403':
          description: Forbidden - Missing required scope 'analytics:view'
  /v1/bot/analytics/handoffs:
    get:
      operationId: bot_analytics_handoffs_retrieve
      description: Retrieve analytics about handoffs to human agents including handoff
        rate, reasons, and trends over time.
      summary: Get handoff analytics
      parameters:
      - in: query
        name: end_date
        schema:
          type: string
        description: 'End date for analytics (YYYY-MM-DD). Default: today'
      - in: query
        name: start_date
        schema:
          type: string
        description: 'Start date for analytics (YYYY-MM-DD). Default: 30 days ago'
      tags:
      - Bot - Analytics
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  total_handoffs:
                    type: integer
                  handoff_rate:
                    type: number
                  handoff_reasons:
                    type: object
                    additionalProperties:
                      type: integer
                  average_attempts_before_handoff:
                    type: number
          description: Handoff analytics
        '403':
          description: Forbidden - Missing required scope 'analytics:view'
  /v1/bot/analytics/topics:
    get:
      operationId: bot_analytics_topics_retrieve
      description: Retrieve analytics about common topics and intents detected in
        customer messages.
      summary: Get common topics and intents
      parameters:
      - in: query
        name: end_date
        schema:
          type: string
        description: 'End date for analytics (YYYY-MM-DD). Default: today'
      - in: query
        name: limit
        schema:
          type: integer
        description: 'Maximum number of topics to return. Default: 10'
      - in: query
        name: start_date
        schema:
          type: string
        description: 'Start date for analytics (YYYY-MM-DD). Default: 30 days ago'
      tags:
      - Bot - Analytics
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  common_intents:
                    type: array
                    items:
                      type: object
                      properties:
                        intent:
                          type: string
                        count:
                          type: integer
                        percentage:
                          type: number
                  total_unique_intents:
                    type: integer
          description: Topic analytics
        '403':
          description: Forbidden - Missing required scope 'analytics:view'
  /v1/bot/catalog/return/success:
    get:
      operationId: bot_catalog_return_success_retrieve
      description: |-
        Show catalog return success page.

        Query parameters:
        - tenant_id: Tenant identifier
        - conversation_id: Conversation identifier
        - product_id: Selected product identifier
      tags:
      - bot
      security:
      - JWTAuth: []
      - {}
      responses:
        '200':
          description: No response body
  /v1/bot/catalog/return/webhook:
    post:
      operationId: bot_catalog_return_webhook_create
      description: |-
        Handle catalog return webhook.

        Expected payload:
        {
            "tenant_id": "uuid",
            "conversation_id": "uuid",
            "selected_product_id": "uuid",
            "return_message": "optional message from catalog"
        }
      tags:
      - bot
      security:
      - JWTAuth: []
      - {}
      responses:
        '200':
          description: No response body
  /v1/bot/corrections/:
    get:
      operationId: bot_corrections_list
      description: |-
        Manage human corrections to bot responses.

        Required scopes:
        - GET: analytics:view
        - POST/PUT/DELETE: users:manage
      parameters:
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedHumanCorrectionList'
          description: ''
    post:
      operationId: bot_corrections_create
      description: |-
        Manage human corrections to bot responses.

        Required scopes:
        - GET: analytics:view
        - POST/PUT/DELETE: users:manage
      tags:
      - bot
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HumanCorrectionRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HumanCorrection'
          description: ''
  /v1/bot/corrections/{id}/:
    get:
      operationId: bot_corrections_retrieve
      description: |-
        Manage human corrections to bot responses.

        Required scopes:
        - GET: analytics:view
        - POST/PUT/DELETE: users:manage
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HumanCorrection'
          description: ''
    put:
      operationId: bot_corrections_update
      description: |-
        Manage human corrections to bot responses.

        Required scopes:
        - GET: analytics:view
        - POST/PUT/DELETE: users:manage
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - bot
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HumanCorrectionRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HumanCorrection'
          description: ''
    patch:
      operationId: bot_corrections_partial_update
      description: |-
        Manage human corrections to bot responses.

        Required scopes:
        - GET: analytics:view
        - POST/PUT/DELETE: users:manage
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - bot
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedHumanCorrectionRequest'
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HumanCorrection'
          description: ''
    delete:
      operationId: bot_corrections_destroy
      description: |-
        Manage human corrections to bot responses.

        Required scopes:
        - GET: analytics:view
        - POST/PUT/DELETE: users:manage
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '204':
          description: No response body
  /v1/bot/corrections/{id}/approve/:
    post:
      operationId: bot_corrections_approve_create
      description: Approve or reject correction for training
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - bot
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CorrectionApprovalRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HumanCorrection'
          description: ''
  /v1/bot/corrections/approved/:
    get:
      operationId: bot_corrections_approved_list
      description: Get corrections approved for training
      parameters:
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedHumanCorrectionList'
          description: ''
  /v1/bot/documents/:
    get:
      operationId: bot_documents_list
      description: |-
        List all documents for the tenant.

        Required scope: integrations:manage

        GET /v1/documents

        Query parameters:
            - status: Filter by status (pending, processing, completed, failed)
            - file_type: Filter by file type (pdf, txt)
            - search: Search by file name
            - ordering: Order by field (created_at, file_name, status)
      parameters:
      - name: ordering
        required: false
        in: query
        description: Which field to use when ordering the results.
        schema:
          type: string
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      - name: search
        required: false
        in: query
        description: A search term.
        schema:
          type: string
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedDocumentList'
          description: ''
  /v1/bot/documents/{document_id}/chunks:
    get:
      operationId: bot_documents_chunks_list
      description: |-
        List chunks for a document.

        Required scope: integrations:manage

        GET /v1/documents/{document_id}/chunks
      parameters:
      - in: path
        name: document_id
        schema:
          type: string
          format: uuid
        required: true
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedDocumentChunkList'
          description: ''
  /v1/bot/documents/{id}:
    get:
      operationId: bot_documents_retrieve
      description: |-
        Get document details.

        Required scope: integrations:manage

        GET /v1/documents/{id}
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Document'
          description: ''
  /v1/bot/documents/{id}/status:
    get:
      operationId: bot_documents_status_retrieve
      description: |-
        Get document status.

        Response:
            - 200: Status information
            - 404: Document not found
            - 403: Missing required scope
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          description: No response body
  /v1/bot/documents/upload:
    post:
      operationId: bot_documents_upload_create
      description: |-
        Upload a document.

        Request:
            - file: Document file (PDF or TXT, max 10MB)

        Response:
            - 201: Document uploaded successfully
            - 400: Invalid file or validation error
            - 403: Missing required scope
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          description: No response body
  /v1/bot/feedback/:
    get:
      operationId: bot_feedback_list
      description: |-
        View feedback history and analytics.

        Required scope: analytics:view
      parameters:
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedInteractionFeedbackList'
          description: ''
  /v1/bot/feedback/{id}/:
    get:
      operationId: bot_feedback_retrieve
      description: |-
        View feedback history and analytics.

        Required scope: analytics:view
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InteractionFeedback'
          description: ''
  /v1/bot/feedback/analytics/:
    get:
      operationId: bot_feedback_analytics_retrieve
      description: Get aggregated feedback analytics
      parameters:
      - in: query
        name: days
        schema:
          type: integer
        description: 'Number of days to analyze (default: 30)'
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FeedbackAnalytics'
          description: ''
  /v1/bot/feedback/submit/:
    post:
      operationId: bot_feedback_submit_create
      description: Submit feedback (thumbs up/down) for a bot interaction
      tags:
      - bot
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FeedbackSubmitRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InteractionFeedback'
          description: ''
  /v1/bot/interactions:
    get:
      operationId: bot_interactions_list
      description: Retrieve all AI agent interactions for the authenticated tenant.
        Supports filtering by conversation, model, confidence, handoff status, and
        date range.
      summary: List agent interactions
      parameters:
      - in: query
        name: conversation_id
        schema:
          type: string
        description: Filter by conversation ID
      - in: query
        name: end_date
        schema:
          type: string
        description: End date (YYYY-MM-DD)
      - in: query
        name: handoff_triggered
        schema:
          type: string
        description: Filter by handoff status (true/false)
      - in: query
        name: max_confidence
        schema:
          type: number
          format: double
        description: Maximum confidence score (0.0-1.0)
      - in: query
        name: min_confidence
        schema:
          type: number
          format: double
        description: Minimum confidence score (0.0-1.0)
      - in: query
        name: model_used
        schema:
          type: string
        description: Filter by model name
      - in: query
        name: page
        schema:
          type: integer
        description: Page number
      - in: query
        name: page_size
        schema:
          type: integer
        description: Page size (max 200)
      - in: query
        name: start_date
        schema:
          type: string
        description: Start date (YYYY-MM-DD)
      tags:
      - Bot - Agent Interactions
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedAgentInteractionListList'
          description: ''
        '400':
          description: Bad request - Invalid filter parameters
        '403':
          description: Forbidden - Missing required scope 'analytics:view'
  /v1/bot/interactions/{interaction_id}:
    get:
      operationId: bot_interactions_retrieve
      description: Retrieve detailed information about a specific agent interaction.
      summary: Get agent interaction details
      parameters:
      - in: path
        name: interaction_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Bot - Agent Interactions
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentInteraction'
          description: ''
        '403':
          description: Forbidden - Missing required scope 'analytics:view'
        '404':
          description: Not found - Interaction does not exist
  /v1/bot/interactions/stats:
    get:
      operationId: bot_interactions_stats_retrieve
      description: Retrieve aggregated statistics about agent interactions including
        total interactions, costs, confidence scores, handoff rates, and more.
      summary: Get agent interaction statistics
      parameters:
      - in: query
        name: end_date
        schema:
          type: string
        description: 'End date (YYYY-MM-DD). Default: today'
      - in: query
        name: start_date
        schema:
          type: string
        description: 'Start date (YYYY-MM-DD). Default: 30 days ago'
      tags:
      - Bot - Agent Interactions
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentInteractionStats'
          description: ''
        '400':
          description: Bad request - Invalid date parameters
        '403':
          description: Forbidden - Missing required scope 'analytics:view'
  /v1/bot/knowledge/:
    get:
      operationId: bot_knowledge_list
      description: Retrieve all knowledge base entries for the authenticated tenant.
        Supports filtering by entry_type, category, and is_active.
      summary: List knowledge entries
      parameters:
      - in: query
        name: category
        schema:
          type: string
        description: Filter by category
      - in: query
        name: entry_type
        schema:
          type: string
        description: Filter by entry type (faq, policy, product_info, service_info,
          procedure, general)
      - in: query
        name: is_active
        schema:
          type: string
        description: 'Filter by active status (true, false, all). Default: true'
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      - name: page_size
        required: false
        in: query
        description: Number of results to return per page.
        schema:
          type: integer
      tags:
      - Bot - Knowledge Base
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedKnowledgeEntryList'
          description: ''
        '403':
          description: Forbidden - Missing required scope 'integrations:manage'
    post:
      operationId: bot_knowledge_create
      description: Create a new knowledge base entry. Automatically generates semantic
        embeddings for search functionality.
      summary: Create knowledge entry
      tags:
      - Bot - Knowledge Base
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/KnowledgeEntryCreateRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KnowledgeEntry'
          description: ''
        '400':
          description: Bad request - Invalid entry data
        '403':
          description: Forbidden - Missing required scope 'integrations:manage'
        '429':
          description: Too many requests - Rate limit exceeded
  /v1/bot/knowledge/{id}/:
    get:
      operationId: bot_knowledge_retrieve
      description: Retrieve a specific knowledge entry by ID.
      summary: Get knowledge entry
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - Bot - Knowledge Base
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KnowledgeEntry'
          description: ''
        '403':
          description: Forbidden - Missing required scope 'integrations:manage'
        '404':
          description: Not found - Entry does not exist
    put:
      operationId: bot_knowledge_update
      description: Update a knowledge entry. Regenerates embeddings if title or content
        changed.
      summary: Update knowledge entry
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - Bot - Knowledge Base
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/KnowledgeEntryUpdateRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KnowledgeEntry'
          description: ''
        '400':
          description: Bad request - Invalid entry data
        '403':
          description: Forbidden - Missing required scope 'integrations:manage'
        '404':
          description: Not found - Entry does not exist
    patch:
      operationId: bot_knowledge_partial_update
      description: Partially update a knowledge entry. Only provided fields will be
        updated.
      summary: Partial update knowledge entry
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - Bot - Knowledge Base
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedKnowledgeEntryUpdateRequest'
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KnowledgeEntry'
          description: ''
        '400':
          description: Bad request - Invalid entry data
        '403':
          description: Forbidden - Missing required scope 'integrations:manage'
        '404':
          description: Not found - Entry does not exist
    delete:
      operationId: bot_knowledge_destroy
      description: Soft delete a knowledge entry (sets is_active=False).
      summary: Delete knowledge entry
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - Bot - Knowledge Base
      security:
      - JWTAuth: []
      responses:
        '204':
          description: No content - Entry deleted successfully
        '403':
          description: Forbidden - Missing required scope 'integrations:manage'
        '404':
          description: Not found - Entry does not exist
  /v1/bot/knowledge/bulk_import/:
    post:
      operationId: bot_knowledge_bulk_import_create
      description: Import multiple knowledge entries at once. Accepts JSON array or
        CSV data. Maximum 100 entries per request.
      summary: Bulk import knowledge entries
      tags:
      - Bot - Knowledge Base
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/KnowledgeEntryBulkImportRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                type: object
                properties:
                  success_count:
                    type: integer
                  error_count:
                    type: integer
                  errors:
                    type: array
                    items:
                      type: object
                  created_ids:
                    type: array
                    items:
                      type: string
          description: Created - Returns summary of import results
        '400':
          description: Bad request - Invalid import data
        '403':
          description: Forbidden - Missing required scope 'integrations:manage'
  /v1/bot/knowledge/search/:
    get:
      operationId: bot_knowledge_search_list
      description: Search knowledge base using semantic similarity. Returns entries
        ranked by relevance.
      summary: Search knowledge entries
      parameters:
      - in: query
        name: entry_type
        schema:
          type: string
        description: Filter by entry type (comma-separated for multiple)
      - in: query
        name: limit
        schema:
          type: integer
        description: 'Maximum number of results (default: 5, max: 20)'
      - in: query
        name: min_similarity
        schema:
          type: number
          format: double
        description: 'Minimum similarity score 0.0-1.0 (default: 0.7)'
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      - name: page_size
        required: false
        in: query
        description: Number of results to return per page.
        schema:
          type: integer
      - in: query
        name: q
        schema:
          type: string
        description: Search query
        required: true
      tags:
      - Bot - Knowledge Base
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedKnowledgeEntrySearchList'
          description: ''
        '400':
          description: Bad request - Missing or invalid query parameter
        '403':
          description: Forbidden - Missing required scope 'integrations:manage'
        '429':
          description: Too many requests - Rate limit exceeded
  /v1/bot/langgraph/health/:
    get:
      operationId: bot_langgraph_health_retrieve
      description: |-
        Check LangGraph system health.

        Returns:
            JSON response with system status
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          description: No response body
  /v1/bot/langgraph/webhook/:
    post:
      operationId: bot_langgraph_webhook_create
      description: |-
        Process incoming WhatsApp message through LangGraph.

        Expected payload:
        {
            "tenant_id": "tenant_uuid",
            "conversation_id": "conv_uuid",
            "request_id": "req_uuid",
            "message_text": "User message",
            "phone_e164": "+254700000000",
            "customer_id": "optional_customer_uuid"
        }

        Returns:
            JSON response with processed state and response text
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          description: No response body
  /v1/bot/monitoring/escalations/:
    get:
      operationId: bot_monitoring_escalations_retrieve
      description: Returns detailed escalation frequencies, reasons, and trigger analysis.
      summary: Get escalation frequency metrics
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          description: Escalation metrics retrieved successfully
        '403':
          description: Insufficient permissions
  /v1/bot/monitoring/health/:
    get:
      operationId: bot_monitoring_health_retrieve
      description: Returns comprehensive system health metrics including journey completion
        rates, payment success, escalation frequency, and performance data.
      summary: Get system health metrics
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          description: System health metrics retrieved successfully
        '403':
          description: Insufficient permissions
  /v1/bot/monitoring/journeys/:
    get:
      operationId: bot_monitoring_journeys_retrieve
      description: Returns detailed journey completion rates, durations, and failure
        analysis.
      summary: Get journey completion metrics
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          description: Journey metrics retrieved successfully
        '403':
          description: Insufficient permissions
  /v1/bot/monitoring/payments/:
    get:
      operationId: bot_monitoring_payments_retrieve
      description: Returns detailed payment success rates, processing times, and method
        performance.
      summary: Get payment success metrics
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          description: Payment metrics retrieved successfully
        '403':
          description: Insufficient permissions
  /v1/bot/monitoring/performance/:
    get:
      operationId: bot_monitoring_performance_retrieve
      description: Returns detailed performance metrics including response times,
        success rates, and component health.
      summary: Get system performance metrics
      tags:
      - bot
      security:
      - JWTAuth: []
      responses:
        '200':
          description: Performance metrics retrieved successfully
        '403':
          description: Insufficient permissions
  /v1/customers:
    get:
      operationId: customers_retrieve
      description: List all customers for the authenticated tenant with filtering
        and pagination
      summary: List customers
      parameters:
      - in: query
        name: active_days
        schema:
          type: integer
        description: Filter customers active in last N days
      - in: query
        name: has_promotional_consent
        schema:
          type: boolean
        description: Filter by promotional message consent
      - in: query
        name: page
        schema:
          type: integer
        description: 'Page number (default: 1)'
      - in: query
        name: page_size
        schema:
          type: integer
        description: 'Items per page (default: 50, max: 100)'
      - in: query
        name: search
        schema:
          type: string
        description: Search by name or phone number
      - in: query
        name: tag
        schema:
          type: string
        description: Filter by tag
      tags:
      - Customers
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  count:
                    type: integer
                  next:
                    type: string
                    nullable: true
                  previous:
                    type: string
                    nullable: true
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/CustomerList'
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/customers/{customer_id}/checkout-options:
    get:
      operationId: customers_checkout_options_retrieve
      description: "\nGet checkout options for customer including preferred method\
        \ and available providers.\n\n**Required scope**: `conversations:view`\n\n\
        **Use case**: Present payment options when customer is checking out to pay\
        \ for products/services.\n        "
      summary: Get customer checkout options
      parameters:
      - in: query
        name: amount
        schema:
          type: number
          format: double
        description: Payment amount
        required: true
      - in: path
        name: customer_id
        schema:
          type: string
        description: Customer UUID
        required: true
      tags:
      - Customer Payments
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  preferred_provider:
                    type: string
                    nullable: true
                  preferred_method:
                    type: object
                    nullable: true
                  available_providers:
                    type: array
                  saved_methods:
                    type: array
                  can_change_provider:
                    type: boolean
                  amount:
                    type: number
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Invalid amount
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Forbidden
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Customer not found
          description: ''
  /v1/customers/{customer_id}/payment-methods:
    post:
      operationId: customers_payment_methods_create
      description: "\nSave a payment method for customer to reuse in future payments.\n\
        \n**Required scope**: `conversations:view`\n\n**Use case**: After successful\
        \ payment, save the method for faster checkout next time.\n    "
      summary: Save customer payment method
      parameters:
      - in: path
        name: customer_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Customer Payments
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                provider:
                  type: string
                  enum:
                  - mpesa
                  - paystack
                  - pesapal
                  - stripe
                details:
                  type: object
                  description: Provider-specific payment method details
                set_as_default:
                  type: boolean
                  default: false
              required:
              - provider
              - details
            examples:
              M-Pesa:
                value:
                  provider: mpesa
                  details:
                    phone_number: '254712345678'
                  set_as_default: true
              Paystack:
                value:
                  provider: paystack
                  details:
                    authorization_code: AUTH_xxx
                    last4: '1234'
                    bank: Access Bank
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                description: Payment method saved
              examples:
                M-Pesa:
                  value:
                    provider: mpesa
                    details:
                      phone_number: '254712345678'
                    set_as_default: true
                Paystack:
                  value:
                    provider: paystack
                    details:
                      authorization_code: AUTH_xxx
                      last4: '1234'
                      bank: Access Bank
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Invalid method details
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Forbidden
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Customer not found
          description: ''
  /v1/customers/{customer_id}/payment-methods/{method_id}:
    delete:
      operationId: customers_payment_methods_destroy
      description: "\nRemove a saved payment method.\n\n**Required scope**: `conversations:view`\n\
        \    "
      summary: Remove customer payment method
      parameters:
      - in: path
        name: customer_id
        schema:
          type: string
          format: uuid
        required: true
      - in: path
        name: method_id
        schema:
          type: string
        required: true
      tags:
      - Customer Payments
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Payment method removed
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Method not found
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Forbidden
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Customer not found
          description: ''
  /v1/customers/{customer_id}/payment-methods/{method_id}/default:
    put:
      operationId: customers_payment_methods_default_update
      description: "\nSet a saved payment method as default for future checkouts.\n\
        \n**Required scope**: `conversations:view`\n    "
      summary: Set default payment method
      parameters:
      - in: path
        name: customer_id
        schema:
          type: string
          format: uuid
        required: true
      - in: path
        name: method_id
        schema:
          type: string
        required: true
      tags:
      - Customer Payments
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Default method updated
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Method not found
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Forbidden
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Customer not found
          description: ''
  /v1/customers/{customer_id}/payment-preferences:
    get:
      operationId: customers_payment_preferences_retrieve
      description: "\nGet payment preferences for a customer including:\n- Preferred\
        \ payment provider\n- Saved payment methods\n- Available payment providers\
        \ for this tenant\n\n**Required scope**: `conversations:view`\n\n**Use case**:\
        \ Display customer's payment preferences in conversation or checkout.\n  \
        \      "
      summary: Get customer payment preferences
      parameters:
      - in: path
        name: customer_id
        schema:
          type: string
        description: Customer UUID
        required: true
      tags:
      - Customer Payments
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  preferred_provider:
                    type: string
                    nullable: true
                    enum:
                    - mpesa
                    - paystack
                    - pesapal
                    - stripe
                  saved_methods:
                    type: array
                    items:
                      type: object
                  available_providers:
                    type: array
                    items:
                      type: string
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Forbidden - Missing required scope
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Customer not found
          description: ''
  /v1/customers/{customer_id}/preferred-provider:
    put:
      operationId: customers_preferred_provider_update
      description: "\nSet customer's preferred payment provider for future checkouts.\n\
        \n**Required scope**: `conversations:view`\n\n**Use case**: Customer selects\
        \ their preferred payment method during or after checkout.\n    "
      summary: Set customer preferred payment provider
      parameters:
      - in: path
        name: customer_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Customer Payments
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                provider:
                  type: string
                  enum:
                  - mpesa
                  - paystack
                  - pesapal
                  - stripe
              required:
              - provider
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Preferred provider updated
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Invalid provider or not configured
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Forbidden
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Customer not found
          description: ''
  /v1/customers/{id}:
    get:
      operationId: customers_retrieve_2
      description: Retrieve detailed information about a specific customer
      summary: Get customer details
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: Customer UUID
        required: true
      tags:
      - Customers
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CustomerDetail'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/customers/{id}/export:
    post:
      operationId: customers_export_create
      description: Export customer data with optional PII masking for compliance
      summary: Export customer data
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: Customer UUID
        required: true
      tags:
      - Customers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerExportRequest'
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                description: Customer data export (JSON or CSV)
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/health/:
    get:
      operationId: health_retrieve
      description: Check the health of the system and its dependencies
      summary: Health check
      tags:
      - health
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  database:
                    type: string
                  cache:
                    type: string
                  celery:
                    type: string
          description: ''
        '503':
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  database:
                    type: string
                  cache:
                    type: string
                  celery:
                    type: string
                  errors:
                    type: array
                    items:
                      type: string
          description: ''
  /v1/memberships/{tenant_id}/{user_id}/roles:
    post:
      operationId: memberships_roles_create
      description: "\nAssign roles to a tenant user. Adds the specified roles to the\
        \ user's existing roles.\n\n**Required scope:** `users:manage`\n\n**Example\
        \ curl:**\n```bash\ncurl -X POST https://api.tulia.ai/v1/memberships/{tenant_id}/{user_id}/roles\
        \ \\\n  -H \"X-TENANT-ID: {tenant_id}\" \\\n  -H \"X-TENANT-API-KEY: {api_key}\"\
        \ \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"role_ids\": [\"\
        role-uuid-1\", \"role-uuid-2\"]}'\n```\n        "
      summary: Assign roles to user
      parameters:
      - in: path
        name: tenant_id
        schema:
          type: string
          format: uuid
        required: true
      - in: path
        name: user_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - RBAC - Memberships
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AssignRolesRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MembershipDetail'
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/memberships/{tenant_id}/{user_id}/roles/{role_id}:
    delete:
      operationId: memberships_roles_destroy
      description: "\nRemove a role from a tenant user.\n\n**Required scope:** `users:manage`\n\
        \        "
      summary: Remove role from user
      parameters:
      - in: path
        name: role_id
        schema:
          type: string
          format: uuid
        required: true
      - in: path
        name: tenant_id
        schema:
          type: string
          format: uuid
        required: true
      - in: path
        name: user_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - RBAC - Memberships
      security:
      - JWTAuth: []
      responses:
        '204':
          description: No response body
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/memberships/{tenant_id}/invite:
    post:
      operationId: memberships_invite_create
      description: "\nInvite a user to join a tenant.\nCreates a TenantUser record\
        \ with invite_status='pending' and optionally assigns roles.\n\n**Required\
        \ scope:** `users:manage`\n\nThe invited user will receive an email with an\
        \ acceptance link.\nIf the user doesn't exist, a new User account is created.\n\
        \n**Example curl:**\n```bash\ncurl -X POST https://api.tulia.ai/v1/memberships/{tenant_id}/invite\
        \ \\\n  -H \"X-TENANT-ID: {tenant_id}\" \\\n  -H \"X-TENANT-API-KEY: {api_key}\"\
        \ \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"email\":\
        \ \"newuser@example.com\",\n    \"role_ids\": [\"role-uuid-1\", \"role-uuid-2\"\
        ]\n  }'\n```\n        "
      summary: Invite user to tenant
      parameters:
      - in: path
        name: tenant_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - RBAC - Memberships
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InviteMemberRequest'
            examples:
              InviteRequest:
                value:
                  email: newuser@example.com
                  role_ids:
                  - 123e4567-e89b-12d3-a456-426614174000
                summary: Invite Request
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MembershipDetail'
              examples:
                SuccessResponse:
                  value:
                    id: 123e4567-e89b-12d3-a456-426614174000
                    tenant:
                      id: 123e4567-e89b-12d3-a456-426614174001
                      name: Acme Corp
                    user:
                      id: 123e4567-e89b-12d3-a456-426614174002
                      email: newuser@example.com
                    roles:
                    - id: role-1
                      name: Catalog Manager
                    invite_status: pending
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/memberships/me:
    get:
      operationId: memberships_me_list
      description: "\nList all tenant memberships for the authenticated user.\nReturns\
        \ tenants where the user has an active TenantUser record with roles.\n\n**No\
        \ scope required** - users can always see their own memberships.\n\nThis endpoint\
        \ is typically used for:\n- Workspace switcher in the UI\n- Determining which\
        \ tenants a user can access\n- Displaying user's roles per tenant\n      \
        \  "
      summary: List user memberships
      tags:
      - RBAC - Memberships
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MembershipDetail'
              examples:
                SuccessResponse:
                  value:
                  - count: 2
                    memberships:
                    - id: 123e4567-e89b-12d3-a456-426614174000
                      tenant:
                        id: 123e4567-e89b-12d3-a456-426614174001
                        name: Acme Corp
                        slug: acme-corp
                      user:
                        id: 123e4567-e89b-12d3-a456-426614174002
                        email: user@example.com
                      roles:
                      - id: role-1
                        name: Owner
                      - id: role-2
                        name: Admin
                      invite_status: accepted
                      joined_at: '2025-01-01T00:00:00Z'
                  summary: Success Response
          description: ''
  /v1/messages/campaigns:
    get:
      operationId: messages_campaigns_list
      description: Get all message campaigns for the tenant
      summary: List campaigns
      parameters:
      - in: query
        name: status
        schema:
          type: string
          enum:
          - canceled
          - completed
          - draft
          - scheduled
          - sending
        description: Filter by campaign status
      tags:
      - Campaigns
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MessageCampaign'
          description: ''
    post:
      operationId: messages_campaigns_create
      description: Create a new message campaign with targeting and optional A/B testing
      summary: Create campaign
      tags:
      - Campaigns
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MessageCampaignCreateRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageCampaign'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/messages/campaigns/{campaign_id}:
    get:
      operationId: messages_campaigns_retrieve
      description: Retrieve details for a specific campaign
      summary: Get campaign details
      parameters:
      - in: path
        name: campaign_id
        schema:
          type: string
          format: uuid
        description: Campaign UUID
        required: true
      tags:
      - Campaigns
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageCampaign'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/messages/campaigns/{campaign_id}/button-click:
    post:
      operationId: messages_campaigns_button_click_create
      description: Record when a customer clicks a button in a campaign message
      summary: Track campaign button click
      parameters:
      - in: path
        name: campaign_id
        schema:
          type: string
          format: uuid
        description: Campaign UUID
        required: true
      tags:
      - Campaigns
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TrackButtonClickRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignButtonInteraction'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/messages/campaigns/{campaign_id}/execute:
    post:
      operationId: messages_campaigns_execute_create
      description: Execute a campaign by sending messages to all matching customers
        with consent
      summary: Execute campaign
      parameters:
      - in: path
        name: campaign_id
        schema:
          type: string
          format: uuid
        description: Campaign UUID
        required: true
      tags:
      - Campaigns
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CampaignExecuteRequest'
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  campaign_id:
                    type: string
                    format: uuid
                  status:
                    type: string
                  results:
                    type: object
                    properties:
                      targeted:
                        type: integer
                      sent:
                        type: integer
                      failed:
                        type: integer
                      skipped_no_consent:
                        type: integer
                      errors:
                        type: array
                        items:
                          type: string
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/messages/campaigns/{campaign_id}/report:
    get:
      operationId: messages_campaigns_report_retrieve
      description: Generate comprehensive analytics report for a campaign including
        A/B test results
      summary: Get campaign report
      parameters:
      - in: path
        name: campaign_id
        schema:
          type: string
          format: uuid
        description: Campaign UUID
        required: true
      tags:
      - Campaigns
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignReport'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/messages/conversations:
    get:
      operationId: messages_conversations_retrieve
      description: List all conversations for the authenticated tenant with filtering
        and pagination
      summary: List conversations
      parameters:
      - in: query
        name: channel
        schema:
          type: string
        description: Filter by channel (whatsapp, sms, telegram, web)
      - in: query
        name: customer_id
        schema:
          type: string
          format: uuid
        description: Filter by customer ID
      - in: query
        name: page
        schema:
          type: integer
        description: 'Page number (default: 1)'
      - in: query
        name: page_size
        schema:
          type: integer
        description: 'Items per page (default: 50, max: 100)'
      - in: query
        name: status
        schema:
          type: string
        description: Filter by status (open, bot, handoff, closed, dormant)
      tags:
      - Conversations
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  count:
                    type: integer
                  next:
                    type: string
                    nullable: true
                  previous:
                    type: string
                    nullable: true
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/ConversationList'
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/messages/conversations/{id}:
    get:
      operationId: messages_conversations_retrieve_2
      description: Retrieve detailed information about a specific conversation
      summary: Get conversation details
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: Conversation UUID
        required: true
      tags:
      - Conversations
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConversationDetail'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/messages/conversations/{id}/handoff:
    post:
      operationId: messages_conversations_handoff_create
      description: Mark a conversation for human agent handoff
      summary: Request human handoff
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: Conversation UUID
        required: true
      tags:
      - Conversations
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConversationHandoffRequest'
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  conversation:
                    $ref: '#/components/schemas/ConversationDetail'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/messages/conversations/{id}/messages:
    get:
      operationId: messages_conversations_messages_retrieve
      description: List all messages in a conversation with pagination
      summary: List conversation messages
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: Conversation UUID
        required: true
      - in: query
        name: page
        schema:
          type: integer
        description: 'Page number (default: 1)'
      - in: query
        name: page_size
        schema:
          type: integer
        description: 'Items per page (default: 50, max: 100)'
      tags:
      - Conversations
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  count:
                    type: integer
                  next:
                    type: string
                    nullable: true
                  previous:
                    type: string
                    nullable: true
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Message'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/messages/customers/{customer_id}/consent-history:
    get:
      operationId: messages_customers_consent_history_list
      description: Retrieve audit trail of consent preference changes for a specific
        customer
      summary: Get customer consent history
      parameters:
      - in: query
        name: consent_type
        schema:
          type: string
          enum:
          - promotional_messages
          - reminder_messages
          - transactional_messages
        description: Filter by consent type
      - in: path
        name: customer_id
        schema:
          type: string
          format: uuid
        description: Customer UUID
        required: true
      tags:
      - Messaging
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ConsentEvent'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/messages/customers/{customer_id}/preferences:
    get:
      operationId: messages_customers_preferences_retrieve
      description: Retrieve communication preferences for a specific customer
      summary: Get customer preferences
      parameters:
      - in: path
        name: customer_id
        schema:
          type: string
          format: uuid
        description: Customer UUID
        required: true
      - in: query
        name: include_history
        schema:
          type: boolean
        description: 'Include consent change history (default: false)'
      tags:
      - Messaging
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CustomerPreferences'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
    put:
      operationId: messages_customers_preferences_update
      description: Update communication preferences for a specific customer. Requires
        reason for audit trail.
      summary: Update customer preferences
      parameters:
      - in: path
        name: customer_id
        schema:
          type: string
          format: uuid
        description: Customer UUID
        required: true
      tags:
      - Messaging
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerPreferencesUpdateRequest'
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CustomerPreferences'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/messages/rate-limit-status:
    get:
      operationId: messages_rate_limit_status_retrieve
      description: Get current message rate limit status for the tenant
      summary: Get rate limit status
      tags:
      - Messaging
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RateLimitStatus'
          description: ''
  /v1/messages/schedule:
    post:
      operationId: messages_schedule_create
      description: Schedule a message to be sent at a specific time in the future
      summary: Schedule message for future delivery
      tags:
      - Messaging
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ScheduleMessageRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScheduledMessage'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/messages/send:
    post:
      operationId: messages_send_create
      description: Send a message to a customer with consent validation and rate limiting
      summary: Send outbound message
      tags:
      - Messaging
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SendMessageRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  message_id:
                    type: string
                    format: uuid
                  status:
                    type: string
                  provider_msg_id:
                    type: string
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  rate_limit_status:
                    type: object
          description: ''
  /v1/messages/templates:
    get:
      operationId: messages_templates_list
      description: Get all message templates for the tenant
      summary: List message templates
      parameters:
      - in: query
        name: message_type
        schema:
          type: string
          enum:
          - promotional
          - reengagement
          - reminder
          - transactional
        description: Filter by message type
      tags:
      - Messaging
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MessageTemplate'
          description: ''
    post:
      operationId: messages_templates_create
      description: Create a new message template with placeholder support
      summary: Create message template
      tags:
      - Messaging
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MessageTemplateCreateRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageTemplate'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
  /v1/orders/:
    get:
      operationId: orders_list
      description: Retrieve paginated list of orders with optional filtering
      summary: List orders
      parameters:
      - in: query
        name: customer_id
        schema:
          type: string
          format: uuid
        description: Filter by customer ID
      - in: query
        name: from_date
        schema:
          type: string
          format: date
        description: Filter orders created on or after this date
      - in: query
        name: page
        schema:
          type: integer
        description: Page number
      - in: query
        name: page_size
        schema:
          type: integer
        description: Number of results per page (max 100)
      - in: query
        name: status
        schema:
          type: string
          enum:
          - canceled
          - draft
          - fulfilled
          - paid
          - placed
        description: Filter by order status
      - in: query
        name: to_date
        schema:
          type: string
          format: date
        description: Filter orders created on or before this date
      tags:
      - orders
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OrderList'
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: 'Forbidden - Missing required scope: orders:view'
          description: ''
    post:
      operationId: orders_create
      description: Create a new order for the authenticated tenant
      summary: Create order
      tags:
      - orders
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrderCreateRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderDetail'
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Bad Request - Invalid order data
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: 'Forbidden - Missing required scope: orders:edit'
          description: ''
  /v1/orders/{order_id}:
    get:
      operationId: orders_retrieve
      description: Retrieve detailed information about a specific order
      summary: Get order details
      parameters:
      - in: path
        name: order_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - orders
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderDetail'
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: 'Forbidden - Missing required scope: orders:view'
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Not Found - Order does not exist
          description: ''
    put:
      operationId: orders_update
      description: Update order status and metadata. Status changes trigger automated
        messages.
      summary: Update order
      parameters:
      - in: path
        name: order_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - orders
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrderUpdateRequest'
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderDetail'
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Bad Request - Invalid update data
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: 'Forbidden - Missing required scope: orders:edit'
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Not Found - Order does not exist
          description: ''
  /v1/payment-features:
    get:
      operationId: payment_features_retrieve
      description: "\nGet information about payment features for the authenticated\
        \ tenant.\n\nReturns:\n- Whether payment facilitation is enabled for the tenant's\
        \ tier\n- Wallet availability and balance (if applicable)\n- Transaction fee\
        \ percentage\n- Current subscription tier\n\nThis endpoint helps frontends\
        \ determine which payment features to display.\n        "
      summary: Get payment features info
      tags:
      - Payment Features
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  payment_facilitation_enabled:
                    type: boolean
                    description: Whether payment facilitation is enabled for this
                      tier
                  has_wallet:
                    type: boolean
                    description: Whether tenant has a wallet
                  wallet_balance:
                    type: number
                    nullable: true
                    description: Current wallet balance (if has_wallet is true)
                  currency:
                    type: string
                    nullable: true
                    description: Wallet currency (if has_wallet is true)
                  transaction_fee_percentage:
                    type: number
                    description: Platform transaction fee percentage
                  tier_name:
                    type: string
                    description: Current subscription tier name
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: 'Forbidden - Missing required scope: finance:view'
          description: ''
  /v1/permissions:
    get:
      operationId: permissions_list
      description: "\nList all available permissions in the system. Returns the canonical\
        \ permission set.\n\n**No specific scope required** - all authenticated users\
        \ can view available permissions.\n\nQuery parameters:\n- `category`: Filter\
        \ by permission category (e.g., 'Catalog', 'Finance')\n- `group_by_category`:\
        \ Set to 'true' to group permissions by category\n\nThis endpoint is useful\
        \ for:\n- Building role permission assignment UIs\n- Displaying available\
        \ permissions to administrators\n- Understanding the permission model\n  \
        \      "
      summary: List all permissions
      parameters:
      - in: query
        name: category
        schema:
          type: string
        description: Filter by permission category
      - in: query
        name: group_by_category
        schema:
          type: boolean
        description: Group results by category
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      - name: page_size
        required: false
        in: query
        description: Number of results to return per page.
        schema:
          type: integer
      tags:
      - RBAC - Permissions
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedPermissionList'
              examples:
                PermissionsList:
                  value:
                    count: 123
                    next: http://api.example.org/accounts/?page=4
                    previous: http://api.example.org/accounts/?page=2
                    results:
                    - count: 17
                      permissions:
                      - id: 123e4567-e89b-12d3-a456-426614174000
                        code: catalog:view
                        label: View Catalog
                        description: View products and catalog
                        category: Catalog
                      - id: 123e4567-e89b-12d3-a456-426614174001
                        code: finance:withdraw:approve
                        label: Approve Withdrawals
                        description: Approve withdrawal requests (four-eyes)
                        category: Finance
                  summary: Permissions List
          description: ''
  /v1/products/:
    get:
      operationId: products_list
      description: Retrieve paginated list of products with optional search and filtering
      summary: List products
      parameters:
      - in: query
        name: external_source
        schema:
          type: string
          enum:
          - manual
          - shopify
          - woocommerce
        description: Filter by external source
      - in: query
        name: in_stock
        schema:
          type: boolean
        description: Filter by stock availability
      - in: query
        name: is_active
        schema:
          type: boolean
        description: 'Filter by active status (default: true)'
      - in: query
        name: max_price
        schema:
          type: number
          format: double
        description: Maximum price filter
      - in: query
        name: min_price
        schema:
          type: number
          format: double
        description: Minimum price filter
      - in: query
        name: page
        schema:
          type: integer
        description: Page number
      - in: query
        name: page_size
        schema:
          type: integer
        description: Number of items per page (max 100)
      - in: query
        name: query
        schema:
          type: string
        description: Search query for title and description
      tags:
      - Products
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProductList'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
    post:
      operationId: products_create
      description: Create a new product. Feature limit enforcement applies based on
        subscription tier.
      summary: Create product
      tags:
      - Products
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProductCreateRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductDetail'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
  /v1/products/{product_id}:
    get:
      operationId: products_retrieve
      description: Retrieve detailed product information including all variants
      summary: Get product details
      parameters:
      - in: path
        name: product_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Products
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductDetail'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
    put:
      operationId: products_update
      description: Update product information. Cannot update tenant or external source
        fields.
      summary: Update product
      parameters:
      - in: path
        name: product_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Products
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProductUpdateRequest'
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductDetail'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
    delete:
      operationId: products_destroy
      description: Soft delete a product. The product will be marked as deleted but
        not removed from database.
      summary: Delete product
      parameters:
      - in: path
        name: product_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Products
      security:
      - JWTAuth: []
      responses:
        '204':
          description: No response body
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/products/{product_id}/variants:
    get:
      operationId: products_variants_list
      description: Retrieve all variants for a specific product
      summary: List product variants
      parameters:
      - in: path
        name: product_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Products
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProductVariant'
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: 'Forbidden - Missing required scope: catalog:view'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
    post:
      operationId: products_variants_create
      description: Create a new variant for a product
      summary: Create product variant
      parameters:
      - in: path
        name: product_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Products
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProductVariantCreateRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductVariant'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: 'Forbidden - Missing required scope: catalog:edit'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/products/{product_id}/variants/{variant_id}:
    get:
      operationId: products_variants_retrieve
      description: Retrieve detailed variant information
      summary: Get variant details
      parameters:
      - in: path
        name: product_id
        schema:
          type: string
          format: uuid
        required: true
      - in: path
        name: variant_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Products
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductVariant'
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: 'Forbidden - Missing required scope: catalog:view'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
    put:
      operationId: products_variants_update
      description: Update variant information
      summary: Update variant
      parameters:
      - in: path
        name: product_id
        schema:
          type: string
          format: uuid
        required: true
      - in: path
        name: variant_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Products
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProductVariantCreateRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductVariant'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: 'Forbidden - Missing required scope: catalog:edit'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
    delete:
      operationId: products_variants_destroy
      description: Soft delete a variant
      summary: Delete variant
      parameters:
      - in: path
        name: product_id
        schema:
          type: string
          format: uuid
        required: true
      - in: path
        name: variant_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Products
      security:
      - JWTAuth: []
      responses:
        '204':
          description: No response body
        '403':
          content:
            application/json:
              schema:
                description: 'Forbidden - Missing required scope: catalog:edit'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/products/sync/shopify:
    post:
      operationId: products_sync_shopify_create
      description: "\n        Trigger product synchronization from Shopify store.\n\
        \        \n        Requires Shopify credentials to be configured in tenant\
        \ metadata:\n        - shop_domain: Shopify store domain (e.g., mystore.myshopify.com)\n\
        \        - access_token: Admin API access token\n        \n        The sync\
        \ runs asynchronously via Celery task. Returns task ID for tracking.\n   \
        \     \n        Example curl:\n        ```bash\n        curl -X POST https://api.tulia.ai/v1/catalog/sync/shopify\
        \ \\\n          -H \"X-TENANT-ID: tenant-uuid\" \\\n          -H \"X-TENANT-API-KEY:\
        \ your-api-key\"\n        ```\n        "
      summary: Sync Shopify products
      tags:
      - Catalog Sync
      security:
      - JWTAuth: []
      responses:
        '202':
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: accepted
                  message:
                    type: string
                  task_id:
                    type: string
                  shop_domain:
                    type: string
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/products/sync/woocommerce:
    post:
      operationId: products_sync_woocommerce_create
      description: "\n        Trigger product synchronization from WooCommerce store.\n\
        \        \n        Requires WooCommerce credentials to be configured in tenant\
        \ metadata:\n        - store_url: WooCommerce store URL\n        - consumer_key:\
        \ REST API consumer key\n        - consumer_secret: REST API consumer secret\n\
        \        \n        The sync runs asynchronously via Celery task. Returns task\
        \ ID for tracking.\n        \n        Example curl:\n        ```bash\n   \
        \     curl -X POST https://api.tulia.ai/v1/catalog/sync/woocommerce \\\n \
        \         -H \"X-TENANT-ID: tenant-uuid\" \\\n          -H \"X-TENANT-API-KEY:\
        \ your-api-key\"\n        ```\n        "
      summary: Sync WooCommerce products
      tags:
      - Catalog Sync
      security:
      - JWTAuth: []
      responses:
        '202':
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: accepted
                  message:
                    type: string
                  task_id:
                    type: string
                  store_url:
                    type: string
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/roles:
    get:
      operationId: roles_list
      description: "\nList all roles for the authenticated tenant. Returns both system\
        \ and custom roles.\n\n**No specific scope required** - all authenticated\
        \ users can view roles.\n\nQuery parameters:\n- `type`: Filter by 'system'\
        \ or 'custom'\n- `include_permissions`: Set to 'true' to include permission\
        \ details\n        "
      summary: List tenant roles
      parameters:
      - in: query
        name: include_permissions
        schema:
          type: boolean
        description: Include permission details
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      - name: page_size
        required: false
        in: query
        description: Number of results to return per page.
        schema:
          type: integer
      - in: query
        name: type
        schema:
          type: string
        description: 'Filter by role type: system or custom'
      tags:
      - RBAC - Roles
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedRoleList'
          description: ''
  /v1/roles/{role_id}:
    get:
      operationId: roles_retrieve
      description: "\nGet detailed information about a role including all permissions.\n\
        \n**No specific scope required** - all authenticated users can view roles.\n\
        \        "
      summary: Get role details
      parameters:
      - in: path
        name: role_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - RBAC - Roles
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RoleDetail'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/roles/{role_id}/permissions:
    get:
      operationId: roles_permissions_list
      description: "\nList all permissions for a role.\n\n**No specific scope required**\
        \ - all authenticated users can view role permissions.\n        "
      summary: List role permissions
      parameters:
      - in: path
        name: role_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - RBAC - Roles
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Permission'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/roles/{role_id}/permissions/add:
    post:
      operationId: roles_permissions_add_create
      description: "\nAdd permissions to a role. Creates RolePermission records for\
        \ the specified permission codes.\n\n**Required scope:** `users:manage`\n\n\
        This immediately affects all users assigned to this role. Their scope cache\
        \ is invalidated.\n\n**Example curl:**\n```bash\ncurl -X POST https://api.tulia.ai/v1/roles/{role_id}/permissions\
        \ \\\n  -H \"X-TENANT-ID: {tenant_id}\" \\\n  -H \"X-TENANT-API-KEY: {api_key}\"\
        \ \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"permission_codes\"\
        : [\"catalog:view\", \"catalog:edit\", \"orders:view\"]\n  }'\n```\n     \
        \   "
      summary: Add permissions to role
      parameters:
      - in: path
        name: role_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - RBAC - Roles
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RolePermissionRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/roles/create:
    post:
      operationId: roles_create_create
      description: "\nCreate a new custom role for the tenant. System roles cannot\
        \ be created via API.\n\n**Required scope:** `users:manage`\n\nAfter creating\
        \ a role, use the `/v1/roles/{id}/permissions` endpoint to add permissions.\n\
        \        "
      summary: Create custom role
      tags:
      - RBAC - Roles
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RoleCreateRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Role'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/services/appointments/:
    get:
      operationId: services_appointments_list
      description: Get list of appointments for the authenticated tenant
      summary: List appointments
      parameters:
      - in: query
        name: customer_id
        schema:
          type: string
        description: Filter by customer ID
      - in: query
        name: from_dt
        schema:
          type: string
        description: Filter by start datetime >= from_dt
      - in: query
        name: page
        schema:
          type: integer
        description: Page number
      - in: query
        name: page_size
        schema:
          type: integer
        description: Number of items per page (max 100)
      - in: query
        name: service_id
        schema:
          type: string
        description: Filter by service ID
      - in: query
        name: status
        schema:
          type: string
        description: Filter by status
      - in: query
        name: to_dt
        schema:
          type: string
        description: Filter by start datetime <= to_dt
      tags:
      - services
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedAppointmentListList'
          description: ''
    post:
      operationId: services_appointments_create
      description: Create a new appointment with capacity validation
      summary: Create appointment
      tags:
      - services
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AppointmentCreateRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AppointmentDetail'
          description: ''
        '400':
          description: Validation error or no capacity
  /v1/services/appointments/{id}/:
    get:
      operationId: services_appointments_retrieve
      description: Get detailed information about an appointment
      summary: Get appointment details
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - services
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AppointmentDetail'
          description: ''
    put:
      operationId: services_appointments_update
      description: |-
        ViewSet for managing appointments.

        Provides CRUD operations for service appointments with capacity validation.

        Required scopes:
        - appointments:view: For GET operations
        - appointments:edit: For POST, PUT, PATCH, DELETE operations
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - services
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AppointmentDetailRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AppointmentDetail'
          description: ''
    patch:
      operationId: services_appointments_partial_update
      description: |-
        ViewSet for managing appointments.

        Provides CRUD operations for service appointments with capacity validation.

        Required scopes:
        - appointments:view: For GET operations
        - appointments:edit: For POST, PUT, PATCH, DELETE operations
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - services
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedAppointmentDetailRequest'
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AppointmentDetail'
          description: ''
    delete:
      operationId: services_appointments_destroy
      description: |-
        ViewSet for managing appointments.

        Provides CRUD operations for service appointments with capacity validation.

        Required scopes:
        - appointments:view: For GET operations
        - appointments:edit: For POST, PUT, PATCH, DELETE operations
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - services
      security:
      - JWTAuth: []
      responses:
        '204':
          description: No response body
  /v1/services/appointments/{id}/cancel/:
    post:
      operationId: services_appointments_cancel_create
      description: Cancel an appointment
      summary: Cancel appointment
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - services
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AppointmentCancelRequest'
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AppointmentDetail'
          description: ''
        '400':
          description: Cannot cancel appointment
  /v1/services/services/:
    get:
      operationId: services_services_list
      description: Get list of services for the authenticated tenant
      summary: List services
      parameters:
      - in: query
        name: is_active
        schema:
          type: boolean
        description: Filter by active status
      - in: query
        name: page
        schema:
          type: integer
        description: Page number
      - in: query
        name: page_size
        schema:
          type: integer
        description: Number of items per page (max 100)
      - in: query
        name: search
        schema:
          type: string
        description: Search in title and description
      tags:
      - services
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedServiceListList'
          description: ''
    post:
      operationId: services_services_create
      description: Create a new bookable service. Enforces max_services limit based
        on subscription tier.
      summary: Create service
      tags:
      - services
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceCreateRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceDetail'
          description: ''
        '403':
          description: Feature limit exceeded
  /v1/services/services/{id}/:
    get:
      operationId: services_services_retrieve
      description: Get detailed information about a service including variants
      summary: Get service details
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - services
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceDetail'
          description: ''
    put:
      operationId: services_services_update
      description: Update service information
      summary: Update service
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - services
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceCreateRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceDetail'
          description: ''
    patch:
      operationId: services_services_partial_update
      description: Partially update service information
      summary: Partial update service
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - services
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedServiceCreateRequest'
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceDetail'
          description: ''
    delete:
      operationId: services_services_destroy
      description: Soft delete a service
      summary: Delete service
      parameters:
      - in: path
        name: id
        schema:
          type: string
        required: true
      tags:
      - services
      security:
      - JWTAuth: []
      responses:
        '204':
          description: No response body
  /v1/services/services/{id}/availability/:
    get:
      operationId: services_services_availability_list
      description: Get available time slots for a service
      summary: Get service availability
      parameters:
      - in: query
        name: from_dt
        schema:
          type: string
        description: Start datetime (ISO 8601)
        required: true
      - in: path
        name: id
        schema:
          type: string
        required: true
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      - in: query
        name: to_dt
        schema:
          type: string
        description: End datetime (ISO 8601)
        required: true
      - in: query
        name: variant_id
        schema:
          type: string
        description: Service variant ID (optional)
      tags:
      - services
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedAvailabilitySlotList'
          description: ''
  /v1/settings:
    get:
      operationId: settings_retrieve
      description: "\nGet or update general tenant settings including notification\
        \ preferences, feature flags, business hours, branding, and compliance settings.\n\
        \n**GET**: Requires `integrations:view` scope\n**PATCH**: Requires `integrations:manage`\
        \ scope\n\n**Rate limit**: 60 requests/minute for PATCH\n    "
      summary: Get or update tenant settings
      tags:
      - Settings
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TenantSettingsRead'
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    patch:
      operationId: settings_partial_update
      description: "\nGet or update general tenant settings including notification\
        \ preferences, feature flags, business hours, branding, and compliance settings.\n\
        \n**GET**: Requires `integrations:view` scope\n**PATCH**: Requires `integrations:manage`\
        \ scope\n\n**Rate limit**: 60 requests/minute for PATCH\n    "
      summary: Get or update tenant settings
      tags:
      - Settings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedTenantSettingsReadRequest'
            examples:
              UpdateSettings:
                value:
                  notification_settings:
                    email_enabled: true
                    sms_enabled: false
                  feature_flags:
                    ai_enabled: true
                summary: Update Settings
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TenantSettingsRead'
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/settings/api-keys:
    get:
      operationId: settings_api_keys_retrieve
      description: "\nManage API keys for tenant authentication.\n\n**GET**: List\
        \ all API keys with masked values (first 8 characters shown)\n**POST**: Generate\
        \ new API key with SHA-256 hashing\n\n**Required scope**: `users:manage`\n\
        **Rate limit**: 60 requests/minute for POST\n\n**Security**:\n- API keys are\
        \ 32-character random strings\n- Only key hashes stored in database (SHA-256)\n\
        - Plain key shown once during generation\n- All operations logged to audit\
        \ trail\n\n**Requirements**: 13.1, 13.2, 13.3, 11.5\n    "
      summary: Manage API keys
      tags:
      - Settings - API Keys
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                ListResponse:
                  value:
                    api_keys:
                    - id: key_abc123
                      key_preview: AbCdEfGh
                      name: Production API Key
                      created_at: '2024-01-15T10:30:00Z'
                      created_by_email: user@example.com
                      last_used_at: '2024-01-16T14:20:00Z'
                    total: 1
                  summary: List Response
          description: ''
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/APIKeyResponse'
              examples:
                ListResponse:
                  value:
                    api_keys:
                    - id: key_abc123
                      key_preview: AbCdEfGh
                      name: Production API Key
                      created_at: '2024-01-15T10:30:00Z'
                      created_by_email: user@example.com
                      last_used_at: '2024-01-16T14:20:00Z'
                    total: 1
                  summary: List Response
                GenerateResponse:
                  value:
                    message: API key generated successfully
                    api_key: AbCdEfGhIjKlMnOpQrStUvWxYz012345
                    key_id: key_abc123
                    name: Production API Key
                    key_preview: AbCdEfGh
                    created_at: '2024-01-15T10:30:00Z'
                    warning: Save this key now. You will not be able to see it again.
                  summary: Generate Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    post:
      operationId: settings_api_keys_create
      description: "\nManage API keys for tenant authentication.\n\n**GET**: List\
        \ all API keys with masked values (first 8 characters shown)\n**POST**: Generate\
        \ new API key with SHA-256 hashing\n\n**Required scope**: `users:manage`\n\
        **Rate limit**: 60 requests/minute for POST\n\n**Security**:\n- API keys are\
        \ 32-character random strings\n- Only key hashes stored in database (SHA-256)\n\
        - Plain key shown once during generation\n- All operations logged to audit\
        \ trail\n\n**Requirements**: 13.1, 13.2, 13.3, 11.5\n    "
      summary: Manage API keys
      tags:
      - Settings - API Keys
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/APIKeyCreateRequest'
            examples:
              GenerateAPIKey:
                value:
                  name: Production API Key
                summary: Generate API Key
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                ListResponse:
                  value:
                    api_keys:
                    - id: key_abc123
                      key_preview: AbCdEfGh
                      name: Production API Key
                      created_at: '2024-01-15T10:30:00Z'
                      created_by_email: user@example.com
                      last_used_at: '2024-01-16T14:20:00Z'
                    total: 1
                  summary: List Response
          description: ''
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/APIKeyResponse'
              examples:
                ListResponse:
                  value:
                    api_keys:
                    - id: key_abc123
                      key_preview: AbCdEfGh
                      name: Production API Key
                      created_at: '2024-01-15T10:30:00Z'
                      created_by_email: user@example.com
                      last_used_at: '2024-01-16T14:20:00Z'
                    total: 1
                  summary: List Response
                GenerateResponse:
                  value:
                    message: API key generated successfully
                    api_key: AbCdEfGhIjKlMnOpQrStUvWxYz012345
                    key_id: key_abc123
                    name: Production API Key
                    key_preview: AbCdEfGh
                    created_at: '2024-01-15T10:30:00Z'
                    warning: Save this key now. You will not be able to see it again.
                  summary: Generate Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/settings/api-keys/{key_id}:
    delete:
      operationId: settings_api_keys_destroy
      description: "\nRevoke (delete) an API key.\n\nRemoves the API key from tenant\
        \ and logs the action to audit trail.\n\n**Required scope**: `users:manage`\n\
        **Rate limit**: 60 requests/minute\n\n**Requirements**: 13.4, 11.5\n    "
      summary: Revoke API key
      parameters:
      - in: path
        name: key_id
        schema:
          type: string
        required: true
      tags:
      - Settings - API Keys
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: API key revoked successfully
                    key_id: key_abc123
                    key_name: Production API Key
                  summary: Success Response
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                NotFound:
                  value:
                    error: API key not found
                    code: NOT_FOUND
                  summary: Not Found
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/settings/business:
    get:
      operationId: settings_business_retrieve
      description: "\nManage business settings including timezone, business hours,\
        \ quiet hours, and notification preferences.\n\n**GET**: Return current business\
        \ settings (no specific scope required)\n**PUT**: Update business settings\
        \ with validation (requires `users:manage` OR `integrations:manage` scope)\n\
        \n**Rate limit**: 60 requests/minute for PUT\n\n**Requirements**: 9.1, 9.2,\
        \ 9.3, 9.4, 9.5, 11.3, 11.5\n    "
      summary: Manage business settings
      tags:
      - Settings
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Business settings updated successfully
                    settings:
                      timezone: Africa/Nairobi
                      business_hours: {}
                      quiet_hours:
                        enabled: true
                        start: '22:00'
                        end: 08:00
                      notification_preferences: {}
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    put:
      operationId: settings_business_update
      description: "\nManage business settings including timezone, business hours,\
        \ quiet hours, and notification preferences.\n\n**GET**: Return current business\
        \ settings (no specific scope required)\n**PUT**: Update business settings\
        \ with validation (requires `users:manage` OR `integrations:manage` scope)\n\
        \n**Rate limit**: 60 requests/minute for PUT\n\n**Requirements**: 9.1, 9.2,\
        \ 9.3, 9.4, 9.5, 11.3, 11.5\n    "
      summary: Manage business settings
      tags:
      - Settings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BusinessSettingsRequest'
            examples:
              UpdateSettings:
                value:
                  timezone: Africa/Nairobi
                  business_hours:
                    monday:
                      open: 09:00
                      close: '17:00'
                    tuesday:
                      open: 09:00
                      close: '17:00'
                  quiet_hours:
                    enabled: true
                    start: '22:00'
                    end: 08:00
                  notification_preferences:
                    email:
                      order_created: true
                      payment_received: true
                summary: Update Settings
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Business settings updated successfully
                    settings:
                      timezone: Africa/Nairobi
                      business_hours: {}
                      quiet_hours:
                        enabled: true
                        start: '22:00'
                        end: 08:00
                      notification_preferences: {}
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/settings/integrations:
    get:
      operationId: settings_integrations_retrieve
      description: "\nList all integrations with their configuration status.\n\nReturns\
        \ masked credentials and last sync status for each integration (Twilio, WooCommerce,\
        \ Shopify, OpenAI).\n\n**Required scope**: `integrations:manage`\n\n**Requirements**:\
        \ 6.5, 11.1\n    "
      summary: List all integrations
      tags:
      - Integrations
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    integrations:
                    - name: twilio
                      display_name: Twilio
                      configured: true
                      credentials:
                        sid_masked: AC****cdef
                        has_token: true
                        has_webhook_secret: true
                      status:
                        last_sync: '2024-01-15T10:30:00Z'
                        status: active
                    total_configured: 2
                  summary: Success Response
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/settings/integrations/openai:
    post:
      operationId: settings_integrations_openai_create
      description: "\nSet OpenAI API credentials for AI-powered features.\n\n**Required\
        \ scope**: `integrations:manage`\n**Rate limit**: 60 requests/minute\n    "
      summary: Set OpenAI credentials
      tags:
      - Integrations
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OpenAICredentialsRequest'
            examples:
              SetCredentials:
                value:
                  api_key: sk-1234567890abcdef
                  org_id: org-1234567890
                summary: Set Credentials
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/settings/integrations/shopify:
    get:
      operationId: settings_integrations_shopify_retrieve
      description: "\nManage Shopify integration credentials with validation.\n\n\
        **GET**: Return masked credentials and configuration status\n**PUT**: Update\
        \ credentials with validation against Shopify API\n**DELETE**: Remove credentials\n\
        \n**Required scope**: `integrations:manage`\n**Rate limit**: 60 requests/minute\
        \ for PUT/DELETE\n\n**Requirements**: 6.1, 6.2, 6.3, 6.4, 6.5, 11.1, 11.5\n\
        \    "
      summary: Manage Shopify credentials
      tags:
      - Integrations
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Shopify credentials updated successfully
                    configured: true
                    credentials:
                      shop_domain: mystore.myshopify.com
                      has_access_token: true
                      has_webhook_secret: true
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    post:
      operationId: settings_integrations_shopify_create
      description: "\nManage Shopify integration credentials with validation.\n\n\
        **GET**: Return masked credentials and configuration status\n**PUT**: Update\
        \ credentials with validation against Shopify API\n**DELETE**: Remove credentials\n\
        \n**Required scope**: `integrations:manage`\n**Rate limit**: 60 requests/minute\
        \ for PUT/DELETE\n\n**Requirements**: 6.1, 6.2, 6.3, 6.4, 6.5, 11.1, 11.5\n\
        \    "
      summary: Manage Shopify credentials
      tags:
      - Integrations
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ShopifyCredentialsRequest'
            examples:
              UpdateCredentials:
                value:
                  shop_domain: mystore.myshopify.com
                  access_token: shpat_1234567890abcdef
                summary: Update Credentials
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Shopify credentials updated successfully
                    configured: true
                    credentials:
                      shop_domain: mystore.myshopify.com
                      has_access_token: true
                      has_webhook_secret: true
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    delete:
      operationId: settings_integrations_shopify_destroy
      description: "\nManage Shopify integration credentials with validation.\n\n\
        **GET**: Return masked credentials and configuration status\n**PUT**: Update\
        \ credentials with validation against Shopify API\n**DELETE**: Remove credentials\n\
        \n**Required scope**: `integrations:manage`\n**Rate limit**: 60 requests/minute\
        \ for PUT/DELETE\n\n**Requirements**: 6.1, 6.2, 6.3, 6.4, 6.5, 11.1, 11.5\n\
        \    "
      summary: Manage Shopify credentials
      tags:
      - Integrations
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Shopify credentials updated successfully
                    configured: true
                    credentials:
                      shop_domain: mystore.myshopify.com
                      has_access_token: true
                      has_webhook_secret: true
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/settings/integrations/together-ai:
    get:
      operationId: settings_integrations_together_ai_retrieve
      description: "\nManage Together AI integration credentials with optional validation.\n\
        \n**GET**: Return configuration status\n**POST**: Update credentials with\
        \ optional validation\n**DELETE**: Remove credentials\n\n**Required scope**:\
        \ `integrations:manage`\n**Rate limit**: 60 requests/minute for POST/DELETE\n\
        \n**Requirements**: 14.1, 14.2, 14.4\n    "
      summary: Manage Together AI credentials
      tags:
      - Integrations
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Together AI credentials updated successfully
                    configured: true
                    available_models: 7
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    post:
      operationId: settings_integrations_together_ai_create
      description: "\nManage Together AI integration credentials with optional validation.\n\
        \n**GET**: Return configuration status\n**POST**: Update credentials with\
        \ optional validation\n**DELETE**: Remove credentials\n\n**Required scope**:\
        \ `integrations:manage`\n**Rate limit**: 60 requests/minute for POST/DELETE\n\
        \n**Requirements**: 14.1, 14.2, 14.4\n    "
      summary: Manage Together AI credentials
      tags:
      - Integrations
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties: {}
              description: Unspecified request body
            examples:
              UpdateCredentials:
                value:
                  api_key: together_api_key_here
                  test_connection: true
                summary: Update Credentials
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Together AI credentials updated successfully
                    configured: true
                    available_models: 7
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    delete:
      operationId: settings_integrations_together_ai_destroy
      description: "\nManage Together AI integration credentials with optional validation.\n\
        \n**GET**: Return configuration status\n**POST**: Update credentials with\
        \ optional validation\n**DELETE**: Remove credentials\n\n**Required scope**:\
        \ `integrations:manage`\n**Rate limit**: 60 requests/minute for POST/DELETE\n\
        \n**Requirements**: 14.1, 14.2, 14.4\n    "
      summary: Manage Together AI credentials
      tags:
      - Integrations
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Together AI credentials updated successfully
                    configured: true
                    available_models: 7
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/settings/integrations/twilio:
    get:
      operationId: settings_integrations_twilio_retrieve
      description: "\nManage Twilio integration credentials with validation.\n\n**GET**:\
        \ Return masked credentials and configuration status\n**PUT**: Update credentials\
        \ with validation against Twilio API\n**DELETE**: Remove credentials\n\n**Required\
        \ scope**: `integrations:manage`\n**Rate limit**: 60 requests/minute for PUT/DELETE\n\
        \n**Requirements**: 5.1, 5.2, 5.3, 5.4, 5.5, 11.1, 11.5\n    "
      summary: Manage Twilio credentials
      tags:
      - Integrations
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Twilio credentials updated successfully
                    configured: true
                    credentials:
                      sid_masked: AC****cdef
                      has_token: true
                      has_webhook_secret: true
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    post:
      operationId: settings_integrations_twilio_create
      description: "\nManage Twilio integration credentials with validation.\n\n**GET**:\
        \ Return masked credentials and configuration status\n**PUT**: Update credentials\
        \ with validation against Twilio API\n**DELETE**: Remove credentials\n\n**Required\
        \ scope**: `integrations:manage`\n**Rate limit**: 60 requests/minute for PUT/DELETE\n\
        \n**Requirements**: 5.1, 5.2, 5.3, 5.4, 5.5, 11.1, 11.5\n    "
      summary: Manage Twilio credentials
      tags:
      - Integrations
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TwilioCredentialsRequest'
            examples:
              UpdateCredentials:
                value:
                  sid: AC1234567890abcdef
                  token: your_auth_token
                  webhook_secret: your_webhook_secret
                  whatsapp_number: whatsapp:+1234567890
                summary: Update Credentials
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Twilio credentials updated successfully
                    configured: true
                    credentials:
                      sid_masked: AC****cdef
                      has_token: true
                      has_webhook_secret: true
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    delete:
      operationId: settings_integrations_twilio_destroy
      description: "\nManage Twilio integration credentials with validation.\n\n**GET**:\
        \ Return masked credentials and configuration status\n**PUT**: Update credentials\
        \ with validation against Twilio API\n**DELETE**: Remove credentials\n\n**Required\
        \ scope**: `integrations:manage`\n**Rate limit**: 60 requests/minute for PUT/DELETE\n\
        \n**Requirements**: 5.1, 5.2, 5.3, 5.4, 5.5, 11.1, 11.5\n    "
      summary: Manage Twilio credentials
      tags:
      - Integrations
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Twilio credentials updated successfully
                    configured: true
                    credentials:
                      sid_masked: AC****cdef
                      has_token: true
                      has_webhook_secret: true
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/settings/integrations/woocommerce:
    get:
      operationId: settings_integrations_woocommerce_retrieve
      description: "\nManage WooCommerce integration credentials with validation.\n\
        \n**GET**: Return masked credentials and configuration status\n**PUT**: Update\
        \ credentials with validation against WooCommerce API\n**DELETE**: Remove\
        \ credentials\n\n**Required scope**: `integrations:manage`\n**Rate limit**:\
        \ 60 requests/minute for PUT/DELETE\n\n**Requirements**: 6.1, 6.2, 6.3, 6.4,\
        \ 6.5, 11.1, 11.5\n    "
      summary: Manage WooCommerce credentials
      tags:
      - Integrations
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: WooCommerce credentials updated successfully
                    configured: true
                    credentials:
                      store_url: https://mystore.com
                      consumer_key_masked: ck_****cdef
                      has_consumer_secret: true
                      has_webhook_secret: true
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                ValidationError:
                  value:
                    error: Invalid WooCommerce credentials
                    code: CREDENTIAL_VALIDATION_FAILED
                  summary: Validation Error
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    post:
      operationId: settings_integrations_woocommerce_create
      description: "\nManage WooCommerce integration credentials with validation.\n\
        \n**GET**: Return masked credentials and configuration status\n**PUT**: Update\
        \ credentials with validation against WooCommerce API\n**DELETE**: Remove\
        \ credentials\n\n**Required scope**: `integrations:manage`\n**Rate limit**:\
        \ 60 requests/minute for PUT/DELETE\n\n**Requirements**: 6.1, 6.2, 6.3, 6.4,\
        \ 6.5, 11.1, 11.5\n    "
      summary: Manage WooCommerce credentials
      tags:
      - Integrations
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WooCommerceCredentialsRequest'
            examples:
              UpdateCredentials:
                value:
                  store_url: https://mystore.com
                  consumer_key: ck_1234567890abcdef
                  consumer_secret: cs_1234567890abcdef
                summary: Update Credentials
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: WooCommerce credentials updated successfully
                    configured: true
                    credentials:
                      store_url: https://mystore.com
                      consumer_key_masked: ck_****cdef
                      has_consumer_secret: true
                      has_webhook_secret: true
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                ValidationError:
                  value:
                    error: Invalid WooCommerce credentials
                    code: CREDENTIAL_VALIDATION_FAILED
                  summary: Validation Error
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    delete:
      operationId: settings_integrations_woocommerce_destroy
      description: "\nManage WooCommerce integration credentials with validation.\n\
        \n**GET**: Return masked credentials and configuration status\n**PUT**: Update\
        \ credentials with validation against WooCommerce API\n**DELETE**: Remove\
        \ credentials\n\n**Required scope**: `integrations:manage`\n**Rate limit**:\
        \ 60 requests/minute for PUT/DELETE\n\n**Requirements**: 6.1, 6.2, 6.3, 6.4,\
        \ 6.5, 11.1, 11.5\n    "
      summary: Manage WooCommerce credentials
      tags:
      - Integrations
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: WooCommerce credentials updated successfully
                    configured: true
                    credentials:
                      store_url: https://mystore.com
                      consumer_key_masked: ck_****cdef
                      has_consumer_secret: true
                      has_webhook_secret: true
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                ValidationError:
                  value:
                    error: Invalid WooCommerce credentials
                    code: CREDENTIAL_VALIDATION_FAILED
                  summary: Validation Error
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/settings/llm/configuration:
    get:
      operationId: settings_llm_configuration_retrieve
      description: "\nManage LLM provider selection and configuration for the AI agent.\n\
        \n**GET**: Return current LLM configuration\n**PATCH**: Update LLM configuration\n\
        \n**Required scope**: `integrations:manage`\n**Rate limit**: 60 requests/minute\
        \ for PATCH\n\n**Requirements**: 14.1, 14.2, 14.4\n    "
      summary: Manage LLM configuration
      tags:
      - Integrations
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: LLM configuration updated successfully
                    configuration:
                      llm_provider: together
                      llm_timeout: 60.0
                      llm_max_retries: 3
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    patch:
      operationId: settings_llm_configuration_partial_update
      description: "\nManage LLM provider selection and configuration for the AI agent.\n\
        \n**GET**: Return current LLM configuration\n**PATCH**: Update LLM configuration\n\
        \n**Required scope**: `integrations:manage`\n**Rate limit**: 60 requests/minute\
        \ for PATCH\n\n**Requirements**: 14.1, 14.2, 14.4\n    "
      summary: Manage LLM configuration
      tags:
      - Integrations
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties: {}
              description: Unspecified request body
            examples:
              UpdateConfiguration:
                value:
                  llm_provider: together
                  llm_timeout: 60.0
                  llm_max_retries: 3
                summary: Update Configuration
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: LLM configuration updated successfully
                    configuration:
                      llm_provider: together
                      llm_timeout: 60.0
                      llm_max_retries: 3
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/settings/llm/providers:
    get:
      operationId: settings_llm_providers_retrieve
      description: "\nGet list of available LLM providers and their configuration\
        \ status.\n\nReturns information about each provider including:\n- Configuration\
        \ status\n- Available models\n- Pricing information\n\n**Required scope**:\
        \ `integrations:view`\n\n**Requirements**: 14.1, 14.2, 14.3\n    "
      summary: Get available LLM providers
      tags:
      - Integrations
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    providers:
                    - provider: openai
                      display_name: OpenAI
                      is_configured: true
                      available_models:
                      - name: gpt-4o
                        display_name: GPT-4o
                        context_window: 128000
                        input_cost_per_1k: '0.0025'
                        output_cost_per_1k: '0.01'
                    - provider: together
                      display_name: Together AI
                      is_configured: false
                      available_models: []
                  summary: Success Response
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/settings/onboarding:
    get:
      operationId: settings_onboarding_retrieve
      description: Get tenant onboarding completion status with step details
      summary: Get onboarding status
      tags:
      - Settings - Onboarding
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OnboardingStatus'
          description: ''
        '403':
          description: Missing required scope
  /v1/settings/onboarding/complete:
    post:
      operationId: settings_onboarding_complete_create
      description: Mark a specific onboarding step as complete and check overall completion
      summary: Mark onboarding step as complete
      tags:
      - Settings - Onboarding
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OnboardingCompleteRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OnboardingStatus'
          description: ''
        '400':
          description: Invalid step name
        '403':
          description: Missing required scope
  /v1/settings/payment-methods:
    get:
      operationId: settings_payment_methods_retrieve
      description: "\nManage payment methods for subscription billing.\n\n**GET**:\
        \ List all payment methods with masked card details\n**POST**: Add new payment\
        \ method via Stripe tokenization\n\n**Required scope**: `finance:manage`\n\
        **Rate limit**: 60 requests/minute for POST\n\n**Requirements**: 7.1, 7.2,\
        \ 7.3, 7.4, 7.5, 11.2, 11.5\n    "
      summary: Manage payment methods
      tags:
      - Finance - Payment Methods
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                ListResponse:
                  value:
                    stripe_customer_id: cus_1234567890
                    payment_methods:
                    - id: pm_1234567890
                      last4: '4242'
                      brand: visa
                      exp_month: 12
                      exp_year: 2025
                      is_default: true
                  summary: List Response
          description: ''
        '201':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                ListResponse:
                  value:
                    stripe_customer_id: cus_1234567890
                    payment_methods:
                    - id: pm_1234567890
                      last4: '4242'
                      brand: visa
                      exp_month: 12
                      exp_year: 2025
                      is_default: true
                  summary: List Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    post:
      operationId: settings_payment_methods_create
      description: "\nManage payment methods for subscription billing.\n\n**GET**:\
        \ List all payment methods with masked card details\n**POST**: Add new payment\
        \ method via Stripe tokenization\n\n**Required scope**: `finance:manage`\n\
        **Rate limit**: 60 requests/minute for POST\n\n**Requirements**: 7.1, 7.2,\
        \ 7.3, 7.4, 7.5, 11.2, 11.5\n    "
      summary: Manage payment methods
      tags:
      - Finance - Payment Methods
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties: {}
            examples:
              AddPaymentMethod:
                value:
                  stripe_token: tok_1234567890abcdef
                summary: Add Payment Method
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                ListResponse:
                  value:
                    stripe_customer_id: cus_1234567890
                    payment_methods:
                    - id: pm_1234567890
                      last4: '4242'
                      brand: visa
                      exp_month: 12
                      exp_year: 2025
                      is_default: true
                  summary: List Response
          description: ''
        '201':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                ListResponse:
                  value:
                    stripe_customer_id: cus_1234567890
                    payment_methods:
                    - id: pm_1234567890
                      last4: '4242'
                      brand: visa
                      exp_month: 12
                      exp_year: 2025
                      is_default: true
                  summary: List Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/settings/payment-methods/{payment_method_id}:
    delete:
      operationId: settings_payment_methods_destroy
      description: "\nRemove a payment method.\n\nDetaches payment method from Stripe\
        \ and removes from tenant settings.\n\n**Required scope**: `finance:manage`\n\
        **Rate limit**: 60 requests/minute\n\n**Requirements**: 7.5, 11.2, 11.5\n\
        \    "
      summary: Remove payment method
      parameters:
      - in: path
        name: payment_method_id
        schema:
          type: string
        required: true
      tags:
      - Finance - Payment Methods
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/settings/payment-methods/{payment_method_id}/default:
    put:
      operationId: settings_payment_methods_default_update
      description: "\nSet a payment method as the default for subscription billing.\n\
        \n**Required scope**: `finance:manage`\n**Rate limit**: 60 requests/minute\n\
        \n**Requirements**: 7.3, 11.2, 11.5\n    "
      summary: Set default payment method
      parameters:
      - in: path
        name: payment_method_id
        schema:
          type: string
        required: true
      tags:
      - Finance - Payment Methods
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/settings/payout-method:
    get:
      operationId: settings_payout_method_retrieve
      description: "\nManage payout method for receiving tenant earnings.\n\n**GET**:\
        \ Return masked payout method details\n**PUT**: Update payout method with\
        \ encrypted details\n**DELETE**: Remove payout method\n\n**Required scope**:\
        \ `finance:manage`\n**Rate limit**: 60 requests/minute for PUT/DELETE\n\n\
        **Note**: Payout method configuration requires payment facilitation to be\
        \ enabled for the tenant's subscription tier.\n\n**Requirements**: 8.1, 8.2,\
        \ 8.3, 8.4, 8.5, 11.2, 11.5\n    "
      summary: Manage payout method
      tags:
      - Finance - Payout Methods
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Payout method updated successfully
                    configured: true
                    payout_method: bank_transfer
                    details:
                      account_number: '****7890'
                      routing_number: '021000021'
                      account_holder_name: John Doe
                      bank_name: Chase Bank
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    put:
      operationId: settings_payout_method_update
      description: "\nManage payout method for receiving tenant earnings.\n\n**GET**:\
        \ Return masked payout method details\n**PUT**: Update payout method with\
        \ encrypted details\n**DELETE**: Remove payout method\n\n**Required scope**:\
        \ `finance:manage`\n**Rate limit**: 60 requests/minute for PUT/DELETE\n\n\
        **Note**: Payout method configuration requires payment facilitation to be\
        \ enabled for the tenant's subscription tier.\n\n**Requirements**: 8.1, 8.2,\
        \ 8.3, 8.4, 8.5, 11.2, 11.5\n    "
      summary: Manage payout method
      tags:
      - Finance - Payout Methods
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties: {}
            examples:
              BankTransfer:
                value:
                  method: bank_transfer
                  details:
                    account_number: '1234567890'
                    routing_number: '021000021'
                    account_holder_name: John Doe
                    bank_name: Chase Bank
                summary: Bank Transfer
              MobileMoney:
                value:
                  method: mobile_money
                  details:
                    phone_number: '+254712345678'
                    provider: M-Pesa
                summary: Mobile Money
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Payout method updated successfully
                    configured: true
                    payout_method: bank_transfer
                    details:
                      account_number: '****7890'
                      routing_number: '021000021'
                      account_holder_name: John Doe
                      bank_name: Chase Bank
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    delete:
      operationId: settings_payout_method_destroy
      description: "\nManage payout method for receiving tenant earnings.\n\n**GET**:\
        \ Return masked payout method details\n**PUT**: Update payout method with\
        \ encrypted details\n**DELETE**: Remove payout method\n\n**Required scope**:\
        \ `finance:manage`\n**Rate limit**: 60 requests/minute for PUT/DELETE\n\n\
        **Note**: Payout method configuration requires payment facilitation to be\
        \ enabled for the tenant's subscription tier.\n\n**Requirements**: 8.1, 8.2,\
        \ 8.3, 8.4, 8.5, 11.2, 11.5\n    "
      summary: Manage payout method
      tags:
      - Finance - Payout Methods
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
              examples:
                SuccessResponse:
                  value:
                    message: Payout method updated successfully
                    configured: true
                    payout_method: bank_transfer
                    details:
                      account_number: '****7890'
                      routing_number: '021000021'
                      account_holder_name: John Doe
                      bank_name: Chase Bank
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '429':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/tenants:
    get:
      operationId: tenants_list
      description: "\nList all tenants where the authenticated user has membership.\n\
        \nReturns tenant information including:\n- Basic tenant details (name, slug,\
        \ status)\n- User's primary role in each tenant\n- Onboarding completion status\n\
        - Subscription tier\n\nThis endpoint does not require any specific scope -\
        \ all authenticated users\ncan list the tenants they belong to.\n\n**Example\
        \ curl:**\n```bash\ncurl -X GET https://api.tulia.ai/v1/tenants \\\n  -H \"\
        Authorization: Bearer {jwt_token}\"\n```\n        "
      summary: List user's tenants
      tags:
      - Tenant Management
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TenantList'
          description: ''
        '401':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                description: Unauthorized - Invalid or missing JWT token
          description: ''
  /v1/tenants/{tenant_id}:
    get:
      operationId: tenants_retrieve
      description: "\nRetrieve full details for a specific tenant.\n\nReturns comprehensive\
        \ tenant information including:\n- Basic tenant details\n- User's roles in\
        \ the tenant\n- Detailed onboarding status with pending steps\n- Subscription\
        \ information\n- Contact information\n- Business settings\n\nUser must have\
        \ an active membership in the tenant to access this endpoint.\n\n**Example\
        \ curl:**\n```bash\ncurl -X GET https://api.tulia.ai/v1/tenants/{tenant_id}\
        \ \\\n  -H \"Authorization: Bearer {jwt_token}\"\n```\n        "
      summary: Get tenant details
      parameters:
      - in: path
        name: tenant_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Tenant Management
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TenantDetail'
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                description: Forbidden - User does not have access to this tenant
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                description: Not Found - Tenant does not exist
          description: ''
  /v1/tenants/{tenant_id}/delete:
    delete:
      operationId: tenants_delete_destroy
      description: "\nSoft delete a tenant and cascade to all related records.\n\n\
        **Required scope:** `users:manage`\n**Required role:** `Owner`\n\nThis operation:\n\
        1. Marks the tenant as deleted (soft delete)\n2. Sets tenant status to 'canceled'\n\
        3. Revokes all API keys\n4. Deactivates all tenant user memberships\n5. Cascades\
        \ soft delete to related records\n\nOnly tenant Owners can delete tenants.\
        \ This is a destructive operation\nthat cannot be easily undone.\n\n**Example\
        \ curl:**\n```bash\ncurl -X DELETE https://api.tulia.ai/v1/tenants/{tenant_id}\
        \ \\\n  -H \"Authorization: Bearer {jwt_token}\" \\\n  -H \"X-TENANT-ID: {tenant_id}\"\
        \ \\\n  -H \"X-TENANT-API-KEY: {api_key}\"\n```\n        "
      summary: Delete tenant
      parameters:
      - in: path
        name: tenant_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Tenant Management
      security:
      - JWTAuth: []
      responses:
        '204':
          content:
            application/json:
              schema:
                description: No Content - Tenant successfully deleted
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                description: Forbidden - Missing required scope or not an Owner
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/tenants/{tenant_id}/members:
    get:
      operationId: tenants_members_list
      description: "\nList all active members of a tenant with their roles and status.\n\
        \nReturns information about each member including:\n- User details (email,\
        \ name)\n- Assigned roles\n- Invitation status\n- Join date and last activity\n\
        \nUser must have an active membership in the tenant to access this endpoint.\n\
        \n**Example curl:**\n```bash\ncurl -X GET https://api.tulia.ai/v1/tenants/{tenant_id}/members\
        \ \\\n  -H \"Authorization: Bearer {jwt_token}\"\n```\n        "
      summary: List tenant members
      parameters:
      - in: path
        name: tenant_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Tenant Management
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TenantMember'
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/tenants/{tenant_id}/members/{user_id}:
    delete:
      operationId: tenants_members_destroy
      description: "\nRemove a user's membership from the tenant.\n\n**Required scope:**\
        \ `users:manage`\n\nThis deactivates the user's TenantUser membership, revoking\
        \ their access\nto the tenant. The user account itself is not deleted.\n\n\
        **Example curl:**\n```bash\ncurl -X DELETE https://api.tulia.ai/v1/tenants/{tenant_id}/members/{user_id}\
        \ \\\n  -H \"Authorization: Bearer {jwt_token}\" \\\n  -H \"X-TENANT-ID: {tenant_id}\"\
        \ \\\n  -H \"X-TENANT-API-KEY: {api_key}\"\n```\n        "
      summary: Remove member from tenant
      parameters:
      - in: path
        name: tenant_id
        schema:
          type: string
          format: uuid
        required: true
      - in: path
        name: user_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Tenant Management
      security:
      - JWTAuth: []
      responses:
        '204':
          content:
            application/json:
              schema:
                description: No Content - Member successfully removed
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/tenants/{tenant_id}/members/invite:
    post:
      operationId: tenants_members_invite_create
      description: "\nInvite a user to join the tenant with specified roles.\n\n**Required\
        \ scope:** `users:manage`\n\nIf the user doesn't exist, creates a new user\
        \ account with pending status.\nIf the user exists, creates a TenantUser membership\
        \ with pending invitation.\n\nThe invited user will receive an email invitation\
        \ to join the tenant.\n\n**Example curl:**\n```bash\ncurl -X POST https://api.tulia.ai/v1/tenants/{tenant_id}/members\
        \ \\\n  -H \"Authorization: Bearer {jwt_token}\" \\\n  -H \"X-TENANT-ID: {tenant_id}\"\
        \ \\\n  -H \"X-TENANT-API-KEY: {api_key}\" \\\n  -H \"Content-Type: application/json\"\
        \ \\\n  -d '{\n    \"email\": \"newuser@example.com\",\n    \"roles\": [\"\
        Admin\", \"Catalog Manager\"]\n  }'\n```\n        "
      summary: Invite user to tenant
      parameters:
      - in: path
        name: tenant_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Tenant Management
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TenantMemberInviteRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TenantMember'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/tenants/{tenant_id}/update:
    put:
      operationId: tenants_update_update
      description: "\nUpdate basic tenant information such as name, contact details,\
        \ and timezone.\n\n**Required scope:** `users:manage`\n\nOnly users with the\
        \ users:manage scope can update tenant information.\nTypically this is limited\
        \ to Owners and Admins.\n\n**Example curl:**\n```bash\ncurl -X PUT https://api.tulia.ai/v1/tenants/{tenant_id}\
        \ \\\n  -H \"Authorization: Bearer {jwt_token}\" \\\n  -H \"X-TENANT-ID: {tenant_id}\"\
        \ \\\n  -H \"X-TENANT-API-KEY: {api_key}\" \\\n  -H \"Content-Type: application/json\"\
        \ \\\n  -d '{\n    \"name\": \"Acme Corporation\",\n    \"contact_email\"\
        : \"contact@acme.com\",\n    \"timezone\": \"America/New_York\"\n  }'\n```\n\
        \        "
      summary: Update tenant information
      parameters:
      - in: path
        name: tenant_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - Tenant Management
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TenantUpdateRequest'
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TenantDetail'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                description: 'Forbidden - Missing required scope: users:manage'
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
          description: ''
  /v1/tenants/create:
    post:
      operationId: tenants_create_create
      description: "\nCreate a new tenant with the authenticated user as Owner.\n\n\
        The system automatically:\n1. Creates a Tenant record with 'trial' status\n\
        2. Generates a unique slug from the business name (if not provided)\n3. Creates\
        \ TenantSettings with default configuration\n4. Creates TenantUser membership\
        \ with Owner role and all permissions\n5. Initializes onboarding status tracking\n\
        \nThe user becomes the Owner of the new tenant with full access to all features.\n\
        \n**Example curl:**\n```bash\ncurl -X POST https://api.tulia.ai/v1/tenants\
        \ \\\n  -H \"Authorization: Bearer {jwt_token}\" \\\n  -H \"Content-Type:\
        \ application/json\" \\\n  -d '{\n    \"name\": \"Acme Corp\",\n    \"slug\"\
        : \"acme-corp\",\n    \"whatsapp_number\": \"+1234567890\"\n  }'\n```\n  \
        \      "
      summary: Create new tenant
      tags:
      - Tenant Management
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TenantCreateRequest'
            examples:
              CreateTenantRequest:
                value:
                  name: Acme Corp
                  slug: acme-corp
                  whatsapp_number: '+1234567890'
                summary: Create Tenant Request
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TenantDetail'
              examples:
                SuccessResponse:
                  value:
                    id: 123e4567-e89b-12d3-a456-426614174000
                    name: Acme Corp
                    slug: acme-corp
                    status: trial
                    whatsapp_number: '+1234567890'
                    role: Owner
                    roles:
                    - Owner
                    onboarding_status:
                      completed: false
                      completion_percentage: 0
                      pending_steps:
                      - twilio_configured
                      - payment_method_added
                      - business_settings_configured
                    created_at: '2025-11-12T10:00:00Z'
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
                description: Bad Request - Invalid input data
          description: ''
        '401':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                description: Unauthorized - Invalid or missing JWT token
          description: ''
  /v1/test/send-whatsapp/:
    post:
      operationId: test_send_whatsapp_create
      description: "\n        Send a test WhatsApp message using the tenant's Twilio\
        \ configuration.\n        \n        **Note:** This endpoint is only available\
        \ in development/testing environments (DEBUG=True).\n        It is automatically\
        \ disabled in production for security reasons.\n        \n        Required\
        \ scope: `integrations:manage`\n        "
      summary: Send test WhatsApp message
      tags:
      - Test Utilities
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                to:
                  type: string
                  description: Recipient phone number in E.164 format (e.g., +1234567890)
                  example: '+1234567890'
                body:
                  type: string
                  description: Message text content
                  example: This is a test message from Tulia AI
                media_url:
                  type: string
                  description: Optional media URL to send with the message
                  example: https://example.com/image.jpg
                  nullable: true
              required:
              - to
              - body
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message_sid:
                    type: string
                  status:
                    type: string
                  to:
                    type: string
                  from:
                    type: string
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  message:
                    type: string
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  message:
                    type: string
          description: ''
        '500':
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  error:
                    type: string
          description: ''
  /v1/users/{user_id}/permissions:
    get:
      operationId: users_permissions_list
      description: "\nList all permission overrides for a user. Shows both grants\
        \ and denies.\n\n**No specific scope required** - users can view their own\
        \ overrides.\nUsers with `users:manage` scope can view others' overrides.\n\
        \        "
      summary: List user permission overrides
      parameters:
      - in: path
        name: user_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - RBAC - Permissions
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserPermission'
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/users/{user_id}/permissions/manage:
    post:
      operationId: users_permissions_manage_create
      description: "\nGrant or deny a permission to a specific user.\nCreates a UserPermission\
        \ override that takes precedence over role permissions.\n\n**Required scope:**\
        \ `users:manage`\n\n**Deny overrides always win:** If a user has a permission\
        \ from a role but a UserPermission\ndenies it, the user will NOT have that\
        \ permission.\n\n**Example curl (grant):**\n```bash\ncurl -X POST https://api.tulia.ai/v1/users/{user_id}/permissions\
        \ \\\n  -H \"X-TENANT-ID: {tenant_id}\" \\\n  -H \"X-TENANT-API-KEY: {api_key}\"\
        \ \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"permission_code\"\
        : \"finance:reconcile\",\n    \"granted\": true,\n    \"reason\": \"Temporary\
        \ access for Q4 audit\"\n  }'\n```\n\n**Example curl (deny):**\n```bash\n\
        curl -X POST https://api.tulia.ai/v1/users/{user_id}/permissions \\\n  -H\
        \ \"X-TENANT-ID: {tenant_id}\" \\\n  -H \"X-TENANT-API-KEY: {api_key}\" \\\
        \n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"permission_code\"\
        : \"catalog:edit\",\n    \"granted\": false,\n    \"reason\": \"Suspended\
        \ pending investigation\"\n  }'\n```\n        "
      summary: Grant or deny user permission
      parameters:
      - in: path
        name: user_id
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - RBAC - Permissions
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserPermissionCreateRequest'
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPermission'
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '404':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/wallet/balance:
    get:
      operationId: wallet_balance_retrieve
      description: Retrieve current wallet balance for the authenticated tenant. Requires
        payment facilitation to be enabled for tenant's subscription tier.
      summary: Get wallet balance
      tags:
      - Wallet
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WalletBalance'
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
                description: Forbidden - Missing required scope or payment facilitation
                  not enabled
          description: ''
  /v1/wallet/transactions:
    get:
      operationId: wallet_transactions_list
      description: Retrieve paginated list of wallet transactions with optional filtering
      summary: List wallet transactions
      parameters:
      - in: query
        name: end_date
        schema:
          type: string
          format: date
        description: Filter by end date (YYYY-MM-DD)
      - in: query
        name: page
        schema:
          type: integer
        description: Page number
      - in: query
        name: page_size
        schema:
          type: integer
        description: Number of items per page (max 100)
      - in: query
        name: start_date
        schema:
          type: string
          format: date
        description: Filter by start date (YYYY-MM-DD)
      - in: query
        name: status
        schema:
          type: string
          enum:
          - canceled
          - completed
          - failed
          - pending
        description: Filter by status
      - in: query
        name: transaction_type
        schema:
          type: string
          enum:
          - adjustment
          - customer_payment
          - platform_fee
          - refund
          - withdrawal
        description: Filter by transaction type
      tags:
      - Wallet
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Transaction'
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  details:
                    type: object
          description: ''
  /v1/wallet/withdraw:
    post:
      operationId: wallet_withdraw_create
      description: "\nRequest a withdrawal from the tenant wallet. This is the first\
        \ step of the four-eyes approval process.\n\n**Required scope:** `finance:withdraw:initiate`\n\
        \nThe amount is immediately debited from the wallet and a transaction is created\
        \ with `pending_approval` status.\nA different user with `finance:withdraw:approve`\
        \ scope must approve the withdrawal.\n\n**Four-eyes validation:** The initiating\
        \ user CANNOT approve their own withdrawal.\n\n**Example curl:**\n```bash\n\
        curl -X POST https://api.tulia.ai/v1/wallet/withdraw \\\n  -H \"X-TENANT-ID:\
        \ {tenant_id}\" \\\n  -H \"X-TENANT-API-KEY: {api_key}\" \\\n  -H \"Content-Type:\
        \ application/json\" \\\n  -d '{\n    \"amount\": 1000.00,\n    \"currency\"\
        : \"USD\",\n    \"bank_account\": \"****1234\",\n    \"notes\": \"Monthly\
        \ payout\"\n  }'\n```\n\n**Response:** Transaction with `status: \"pending_approval\"\
        ` and `transaction_id` for approval.\n        "
      summary: Initiate withdrawal (four-eyes step 1)
      tags:
      - Finance - Withdrawals
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WithdrawalRequestRequest'
            examples:
              WithdrawalRequest:
                value:
                  amount: 1000.0
                  currency: USD
                  bank_account: '****1234'
                  notes: Monthly payout
                summary: Withdrawal Request
        required: true
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Transaction'
              examples:
                SuccessResponse:
                  value:
                    id: 123e4567-e89b-12d3-a456-426614174000
                    transaction_type: withdrawal
                    amount: 1000.0
                    currency: USD
                    status: pending_approval
                    initiated_by:
                      id: user-uuid-1
                      email: finance@example.com
                    created_at: '2025-11-10T12:00:00Z'
                  summary: Success Response
          description: ''
        '400':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '403':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /v1/wallet/withdrawal-options:
    get:
      operationId: wallet_withdrawal_options_retrieve
      description: "\nGet available withdrawal options for tenant including:\n- Available\
        \ withdrawal methods (based on configured providers)\n- Configured payout\
        \ method\n- Minimum withdrawal amounts by method\n- Withdrawal fees by method\n\
        - Current wallet balance\n\n**Required scope**: `finance:view`\n\n**Use case**:\
        \ Display withdrawal options to tenant before initiating withdrawal.\n   \
        \     "
      summary: Get withdrawal options
      tags:
      - Tenant Withdrawals
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  available_methods:
                    type: array
                    items:
                      type: string
                  configured_method:
                    type: object
                    nullable: true
                  minimum_amounts:
                    type: object
                  fees:
                    type: object
                  wallet_balance:
                    type: number
                  currency:
                    type: string
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Forbidden - Missing required scope
          description: ''
  /v1/wallet/withdrawals:
    get:
      operationId: wallet_withdrawals_retrieve
      description: "\nList withdrawal transactions for tenant with optional filtering.\n\
        \n**Required scope**: `finance:view`\n\n**Use case**: View withdrawal history\
        \ and pending approvals.\n        "
      summary: List withdrawal transactions
      parameters:
      - in: query
        name: limit
        schema:
          type: integer
        description: Number of results (default 50)
      - in: query
        name: status
        schema:
          type: string
        description: Filter by status (pending, completed, failed, canceled)
      tags:
      - Tenant Withdrawals
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  count:
                    type: integer
                  results:
                    type: array
                    items:
                      type: object
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Forbidden
          description: ''
    post:
      operationId: wallet_withdrawals_create
      description: "\nInitiate a withdrawal request from tenant wallet.\n\n**Required\
        \ scope**: `finance:withdraw:initiate`\n\n**Four-eyes approval**: Withdrawal\
        \ must be approved by a different user with `finance:withdraw:approve` scope.\n\
        \n**Fees**: Tenant pays withdrawal fees (deducted from gross amount).\n\n\
        **Use case**: Tenant requests withdrawal of their earnings.\n        "
      summary: Initiate withdrawal request
      tags:
      - Tenant Withdrawals
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                amount:
                  type: number
                  description: Gross withdrawal amount (includes fee)
                method_type:
                  type: string
                  enum:
                  - mpesa
                  - bank_transfer
                  - till
                  description: Withdrawal method
                method_details:
                  type: object
                  description: Method-specific details
                notes:
                  type: string
                  description: Optional notes
              required:
              - amount
              - method_type
              - method_details
            examples:
              M-PesaWithdrawal:
                value:
                  amount: 1000.0
                  method_type: mpesa
                  method_details:
                    phone_number: '254712345678'
                  notes: Monthly withdrawal
                summary: M-Pesa Withdrawal
              BankTransfer:
                value:
                  amount: 5000.0
                  method_type: bank_transfer
                  method_details:
                    account_number: '1234567890'
                    bank_code: '063'
                    account_name: Business Account
                summary: Bank Transfer
              TillWithdrawal:
                value:
                  amount: 2000.0
                  method_type: till
                  method_details:
                    till_number: '123456'
                summary: Till Withdrawal
      security:
      - JWTAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  transaction_id:
                    type: string
                  status:
                    type: string
                  amount:
                    type: number
                  fee:
                    type: number
                  net_amount:
                    type: number
              examples:
                M-PesaWithdrawal:
                  value:
                    amount: 1000.0
                    method_type: mpesa
                    method_details:
                      phone_number: '254712345678'
                    notes: Monthly withdrawal
                  summary: M-Pesa Withdrawal
                BankTransfer:
                  value:
                    amount: 5000.0
                    method_type: bank_transfer
                    method_details:
                      account_number: '1234567890'
                      bank_code: '063'
                      account_name: Business Account
                  summary: Bank Transfer
                TillWithdrawal:
                  value:
                    amount: 2000.0
                    method_type: till
                    method_details:
                      till_number: '123456'
                  summary: Till Withdrawal
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Invalid request or insufficient balance
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Forbidden
          description: ''
        '500':
          content:
            application/json:
              schema:
                description: Internal server error
          description: ''
  /v1/wallet/withdrawals/{transaction_id}/approve:
    post:
      operationId: wallet_withdrawals_approve_create
      description: "\nApprove and process a pending withdrawal request.\n\n**Required\
        \ scope**: `finance:withdraw:approve`\n\n**Four-eyes approval**: Approver\
        \ MUST be different from initiator.\n\n**Processing**: Upon approval, the\
        \ withdrawal is immediately processed through the payment provider.\n\n**Use\
        \ case**: Finance manager approves withdrawal initiated by another user.\n\
        \        "
      summary: Approve withdrawal request
      parameters:
      - in: path
        name: transaction_id
        schema:
          type: string
        description: Transaction UUID
        required: true
      tags:
      - Tenant Withdrawals
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  transaction_id:
                    type: string
                  amount:
                    type: number
                  net_amount:
                    type: number
                  fee:
                    type: number
                  provider_response:
                    type: object
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Invalid request or four-eyes violation
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Forbidden
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Transaction not found
          description: ''
        '500':
          content:
            application/json:
              schema:
                description: Processing failed
          description: ''
  /v1/wallet/withdrawals/{transaction_id}/cancel:
    post:
      operationId: wallet_withdrawals_cancel_create
      description: "\nCancel a pending withdrawal request.\n\n**Required scope**:\
        \ `finance:withdraw:initiate` OR `finance:withdraw:approve`\n\n**Use case**:\
        \ Cancel a withdrawal before it's approved or if no longer needed.\n     \
        \   "
      summary: Cancel withdrawal request
      parameters:
      - in: path
        name: transaction_id
        schema:
          type: string
        description: Transaction UUID
        required: true
      tags:
      - Tenant Withdrawals
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
                  description: Cancellation reason
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Withdrawal canceled
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Cannot cancel (not pending)
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Forbidden
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Transaction not found
          description: ''
  /v1/webhooks/mpesa/:
    post:
      operationId: webhooks_mpesa_create
      description: Receive and process M-Pesa STK Push payment callbacks
      summary: M-Pesa STK Push callback handler
      tags:
      - webhooks
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Webhook processed successfully
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Invalid webhook payload
          description: ''
        '500':
          content:
            application/json:
              schema:
                description: Webhook processing failed
          description: ''
  /v1/webhooks/paystack/:
    post:
      operationId: webhooks_paystack_create
      description: Receive and process Paystack payment webhooks with signature verification
      summary: Paystack webhook handler
      tags:
      - webhooks
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                event:
                  type: string
                data:
                  type: object
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Webhook processed successfully
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Invalid webhook payload or signature
          description: ''
        '500':
          content:
            application/json:
              schema:
                description: Webhook processing failed
          description: ''
  /v1/webhooks/pesapal/:
    get:
      operationId: webhooks_pesapal_retrieve
      description: Receive and process Pesapal Instant Payment Notifications
      summary: Pesapal IPN handler
      tags:
      - webhooks
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Webhook processed successfully
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Invalid webhook payload
          description: ''
        '500':
          content:
            application/json:
              schema:
                description: Webhook processing failed
          description: ''
    post:
      operationId: webhooks_pesapal_create
      description: Process Pesapal IPN (POST method).
      tags:
      - webhooks
      security:
      - JWTAuth: []
      responses:
        '200':
          description: No response body
  /v1/webhooks/stripe/:
    post:
      operationId: webhooks_stripe_create
      description: Receive and process Stripe payment webhooks
      summary: Stripe webhook handler
      tags:
      - webhooks
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                type:
                  type: string
                data:
                  type: object
      security:
      - JWTAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Webhook processed successfully
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Invalid webhook payload
          description: ''
        '500':
          content:
            application/json:
              schema:
                description: Webhook processing failed
          description: ''
components:
  schemas:
    APIKeyCreateRequest:
      type: object
      description: Serializer for creating a new API key.
      properties:
        name:
          type: string
          minLength: 1
          description: Descriptive name for the API key
          maxLength: 100
      required:
      - name
    APIKeyResponse:
      type: object
      description: Serializer for API key generation response (includes plain key
        once).
      properties:
        message:
          type: string
        api_key:
          type: string
          description: Plain API key - save this now, it won't be shown again
        key_id:
          type: string
        name:
          type: string
        key_preview:
          type: string
        created_at:
          type: string
          format: date-time
        warning:
          type: string
      required:
      - api_key
      - created_at
      - key_id
      - key_preview
      - message
      - name
      - warning
    ActionEnum:
      enum:
      - complete
      - fail
      type: string
      description: |-
        * `complete` - complete
        * `fail` - fail
    AdminSubscriptionChangeRequest:
      type: object
      description: Serializer for admin subscription tier change.
      properties:
        tier_id:
          type: string
          format: uuid
          description: ID of the new subscription tier
        billing_cycle:
          allOf:
          - $ref: '#/components/schemas/BillingCycleEnum'
          default: monthly
          description: |-
            Billing cycle

            * `monthly` - monthly
            * `yearly` - yearly
        notes:
          type: string
          description: Admin notes for the change
      required:
      - tier_id
    AdminSubscriptionWaiverRequest:
      type: object
      description: Serializer for admin subscription waiver.
      properties:
        waived:
          type: boolean
          description: Whether to waive subscription fees
        notes:
          type: string
          description: Admin notes for the waiver
      required:
      - waived
    AdminTenantDetail:
      type: object
      description: Serializer for admin tenant detail view.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        name:
          type: string
          readOnly: true
          description: Business name
        slug:
          type: string
          readOnly: true
          description: URL-friendly identifier
          pattern: ^[-a-zA-Z0-9_]+$
        status:
          allOf:
          - $ref: '#/components/schemas/Status179Enum'
          readOnly: true
          description: |-
            Current tenant status

            * `active` - Active
            * `trial` - Free Trial
            * `trial_expired` - Trial Expired
            * `suspended` - Suspended
            * `canceled` - Canceled
        subscription_tier:
          type: string
          format: uuid
          description: Current subscription tier
          readOnly: true
          nullable: true
        tier_name:
          type: string
          readOnly: true
          nullable: true
        subscription_waived:
          type: boolean
          readOnly: true
          description: Whether subscription fees are waived
        trial_start_date:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: Free trial start date
        trial_end_date:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: Free trial end date
        whatsapp_number:
          type: string
          readOnly: true
          description: WhatsApp business number (E.164 format)
        contact_email:
          type: string
          format: email
          readOnly: true
          nullable: true
          description: Primary contact email for notifications
        contact_phone:
          type: string
          readOnly: true
          nullable: true
          description: Primary contact phone
        timezone:
          type: string
          readOnly: true
          description: Tenant timezone for scheduling
        quiet_hours_start:
          type: string
          format: time
          readOnly: true
          description: Start of quiet hours (no automated messages)
        quiet_hours_end:
          type: string
          format: time
          readOnly: true
          description: End of quiet hours
        allowed_origins:
          readOnly: true
          description: CORS allowed origins for this tenant
        subscription:
          type: string
          readOnly: true
        wallet:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - allowed_origins
      - contact_email
      - contact_phone
      - created_at
      - id
      - name
      - quiet_hours_end
      - quiet_hours_start
      - slug
      - status
      - subscription
      - subscription_tier
      - subscription_waived
      - tier_name
      - timezone
      - trial_end_date
      - trial_start_date
      - updated_at
      - wallet
      - whatsapp_number
    AdminTenantList:
      type: object
      description: Serializer for admin tenant list view.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        name:
          type: string
          readOnly: true
          description: Business name
        slug:
          type: string
          readOnly: true
          description: URL-friendly identifier
          pattern: ^[-a-zA-Z0-9_]+$
        status:
          allOf:
          - $ref: '#/components/schemas/Status179Enum'
          readOnly: true
          description: |-
            Current tenant status

            * `active` - Active
            * `trial` - Free Trial
            * `trial_expired` - Trial Expired
            * `suspended` - Suspended
            * `canceled` - Canceled
        tier_name:
          type: string
          readOnly: true
          nullable: true
        subscription_status:
          type: string
          readOnly: true
        subscription_waived:
          type: boolean
          readOnly: true
          description: Whether subscription fees are waived
        trial_start_date:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: Free trial start date
        trial_end_date:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: Free trial end date
        whatsapp_number:
          type: string
          readOnly: true
          description: WhatsApp business number (E.164 format)
        contact_email:
          type: string
          format: email
          readOnly: true
          nullable: true
          description: Primary contact email for notifications
        contact_phone:
          type: string
          readOnly: true
          nullable: true
          description: Primary contact phone
        wallet_balance:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - contact_email
      - contact_phone
      - created_at
      - id
      - name
      - slug
      - status
      - subscription_status
      - subscription_waived
      - tier_name
      - trial_end_date
      - trial_start_date
      - updated_at
      - wallet_balance
      - whatsapp_number
    AgentConfiguration:
      type: object
      description: |-
        Serializer for AgentConfiguration.

        Provides full read/write access to agent configuration fields
        with validation for all constraints.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        tenant:
          type: string
          format: uuid
          description: Tenant this configuration belongs to
          readOnly: true
        tenant_name:
          type: string
          readOnly: true
        agent_name:
          type: string
          description: Name of the AI agent (e.g., 'Sarah', 'TechBot')
          maxLength: 100
        personality_traits:
          description: 'Personality traits as key-value pairs (e.g., {''helpful'':
            true, ''empathetic'': true})'
        tone:
          allOf:
          - $ref: '#/components/schemas/ToneEnum'
          description: |-
            Communication tone for the agent

            * `professional` - Professional
            * `friendly` - Friendly
            * `casual` - Casual
            * `formal` - Formal
        default_model:
          type: string
          description: Default LLM model to use (e.g., 'gpt-4o', 'o1-preview', 'o1-mini')
          maxLength: 50
        fallback_models:
          description: List of fallback models to try if default fails (e.g., ['gpt-4o-mini',
            'gpt-3.5-turbo'])
        temperature:
          type: number
          format: double
          maximum: 2.0
          minimum: 0.0
          description: Temperature for response generation (0.0-2.0, higher = more
            creative)
        max_response_length:
          type: integer
          maximum: 2000
          minimum: 50
          description: Maximum length of agent responses in characters
        behavioral_restrictions:
          description: List of topics or behaviors to avoid (e.g., ['politics', 'medical
            advice'])
        required_disclaimers:
          description: List of disclaimers to include in responses (e.g., ['I am an
            AI assistant'])
        confidence_threshold:
          type: number
          format: double
          maximum: 1.0
          minimum: 0.0
          description: Minimum confidence score to proceed without handoff (0.0-1.0)
        auto_handoff_topics:
          description: Topics that always trigger handoff to human (e.g., ['refund',
            'complaint'])
        max_low_confidence_attempts:
          type: integer
          maximum: 10
          minimum: 1
          description: Number of low-confidence responses before triggering handoff
        enable_proactive_suggestions:
          type: boolean
          description: Enable proactive product/service suggestions
        enable_spelling_correction:
          type: boolean
          description: Enable automatic spelling correction for customer messages
        enable_rich_messages:
          type: boolean
          description: Enable rich WhatsApp messages (buttons, lists, media)
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - created_at
      - id
      - tenant
      - tenant_name
      - updated_at
    AgentConfigurationUpdateRequest:
      type: object
      description: |-
        Serializer for updating AgentConfiguration.

        Allows partial updates to agent configuration fields.
      properties:
        agent_name:
          type: string
          minLength: 1
          description: Name of the AI agent (e.g., 'Sarah', 'TechBot')
          maxLength: 100
        personality_traits:
          description: 'Personality traits as key-value pairs (e.g., {''helpful'':
            true, ''empathetic'': true})'
        tone:
          allOf:
          - $ref: '#/components/schemas/ToneEnum'
          description: |-
            Communication tone for the agent

            * `professional` - Professional
            * `friendly` - Friendly
            * `casual` - Casual
            * `formal` - Formal
        default_model:
          type: string
          minLength: 1
          description: Default LLM model to use (e.g., 'gpt-4o', 'o1-preview', 'o1-mini')
          maxLength: 50
        fallback_models:
          description: List of fallback models to try if default fails (e.g., ['gpt-4o-mini',
            'gpt-3.5-turbo'])
        temperature:
          type: number
          format: double
          maximum: 2.0
          minimum: 0.0
          description: Temperature for response generation (0.0-2.0, higher = more
            creative)
        max_response_length:
          type: integer
          maximum: 2000
          minimum: 50
          description: Maximum length of agent responses in characters
        behavioral_restrictions:
          description: List of topics or behaviors to avoid (e.g., ['politics', 'medical
            advice'])
        required_disclaimers:
          description: List of disclaimers to include in responses (e.g., ['I am an
            AI assistant'])
        confidence_threshold:
          type: number
          format: double
          maximum: 1.0
          minimum: 0.0
          description: Minimum confidence score to proceed without handoff (0.0-1.0)
        auto_handoff_topics:
          description: Topics that always trigger handoff to human (e.g., ['refund',
            'complaint'])
        max_low_confidence_attempts:
          type: integer
          maximum: 10
          minimum: 1
          description: Number of low-confidence responses before triggering handoff
        enable_proactive_suggestions:
          type: boolean
          description: Enable proactive product/service suggestions
        enable_spelling_correction:
          type: boolean
          description: Enable automatic spelling correction for customer messages
        enable_rich_messages:
          type: boolean
          description: Enable rich WhatsApp messages (buttons, lists, media)
    AgentInteraction:
      type: object
      description: |-
        Serializer for AgentInteraction with full field access.

        Provides read-only access to agent interaction tracking data
        for analytics and monitoring purposes.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        conversation:
          type: string
          format: uuid
          description: Conversation this interaction belongs to
          readOnly: true
        tenant_id:
          type: string
          format: uuid
          readOnly: true
        tenant_name:
          type: string
          readOnly: true
        customer_phone:
          type: string
          readOnly: true
        customer_message:
          type: string
          description: Original customer message text
        detected_intents:
          description: List of detected intents with confidence scores
        intent_names:
          type: string
          readOnly: true
        primary_intent:
          type: string
          readOnly: true
        model_used:
          type: string
          readOnly: true
          description: LLM model used for this interaction (e.g., 'gpt-4o', 'o1-preview')
        context_size:
          type: integer
          description: Size of context provided to the model in tokens
        processing_time_ms:
          type: integer
          description: Time taken to process and generate response in milliseconds
        agent_response:
          type: string
          description: Generated agent response text
        confidence_score:
          type: number
          format: double
          readOnly: true
          description: Confidence score for the response (0.0-1.0)
        handoff_triggered:
          type: boolean
          readOnly: true
          description: Whether this interaction triggered a handoff to human agent
        handoff_reason:
          type: string
          description: Reason for handoff (e.g., 'low_confidence', 'explicit_request',
            'restricted_topic')
          maxLength: 100
        message_type:
          allOf:
          - $ref: '#/components/schemas/MessageType352Enum'
          readOnly: true
          description: |-
            Type of message sent to customer

            * `text` - Text
            * `button` - Button
            * `list` - List
            * `media` - Media
        token_usage:
          description: 'Token usage breakdown (e.g., {''prompt_tokens'': 100, ''completion_tokens'':
            50, ''total_tokens'': 150})'
        total_tokens:
          type: string
          readOnly: true
        estimated_cost:
          type: string
          format: decimal
          pattern: ^-?\d{0,4}(?:\.\d{0,6})?$
          readOnly: true
          description: Estimated cost in USD for this interaction
        cost_per_token:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - agent_response
      - confidence_score
      - conversation
      - cost_per_token
      - created_at
      - customer_message
      - customer_phone
      - estimated_cost
      - handoff_triggered
      - id
      - intent_names
      - message_type
      - model_used
      - primary_intent
      - tenant_id
      - tenant_name
      - total_tokens
      - updated_at
    AgentInteractionList:
      type: object
      description: |-
        Simplified serializer for listing agent interactions.

        Provides essential fields for list views without heavy computed fields.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        conversation:
          type: string
          format: uuid
          description: Conversation this interaction belongs to
          readOnly: true
        tenant_name:
          type: string
          readOnly: true
        model_used:
          type: string
          readOnly: true
          description: LLM model used for this interaction (e.g., 'gpt-4o', 'o1-preview')
        confidence_score:
          type: number
          format: double
          readOnly: true
          description: Confidence score for the response (0.0-1.0)
        handoff_triggered:
          type: boolean
          readOnly: true
          description: Whether this interaction triggered a handoff to human agent
        message_type:
          allOf:
          - $ref: '#/components/schemas/MessageType352Enum'
          readOnly: true
          description: |-
            Type of message sent to customer

            * `text` - Text
            * `button` - Button
            * `list` - List
            * `media` - Media
        estimated_cost:
          type: string
          format: decimal
          pattern: ^-?\d{0,4}(?:\.\d{0,6})?$
          readOnly: true
          description: Estimated cost in USD for this interaction
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
      required:
      - confidence_score
      - conversation
      - created_at
      - estimated_cost
      - handoff_triggered
      - id
      - message_type
      - model_used
      - tenant_name
    AgentInteractionStats:
      type: object
      description: |-
        Serializer for agent interaction statistics.

        Provides aggregated metrics for analytics dashboards.
      properties:
        total_interactions:
          type: integer
          readOnly: true
        total_cost:
          type: string
          format: decimal
          pattern: ^-?\d{0,4}(?:\.\d{0,6})?$
          readOnly: true
        avg_confidence:
          type: number
          format: double
          readOnly: true
        handoff_count:
          type: integer
          readOnly: true
        handoff_rate:
          type: number
          format: double
          readOnly: true
        interactions_by_model:
          type: object
          additionalProperties: {}
          readOnly: true
        cost_by_model:
          type: object
          additionalProperties: {}
          readOnly: true
        interactions_by_type:
          type: object
          additionalProperties: {}
          readOnly: true
        high_confidence_count:
          type: integer
          readOnly: true
        low_confidence_count:
          type: integer
          readOnly: true
        avg_processing_time_ms:
          type: number
          format: double
          readOnly: true
        avg_tokens:
          type: number
          format: double
          readOnly: true
      required:
      - avg_confidence
      - avg_processing_time_ms
      - avg_tokens
      - cost_by_model
      - handoff_count
      - handoff_rate
      - high_confidence_count
      - interactions_by_model
      - interactions_by_type
      - low_confidence_count
      - total_cost
      - total_interactions
    AppointmentCancelRequest:
      type: object
      description: Serializer for canceling appointments.
      properties:
        reason:
          type: string
    AppointmentCreateRequest:
      type: object
      description: Serializer for creating appointments.
      properties:
        customer_id:
          type: string
          format: uuid
        service_id:
          type: string
          format: uuid
        variant_id:
          type: string
          format: uuid
          nullable: true
        start_dt:
          type: string
          format: date-time
        end_dt:
          type: string
          format: date-time
        notes:
          type: string
          nullable: true
        status:
          allOf:
          - $ref: '#/components/schemas/AppointmentCreateStatusEnum'
          default: pending
      required:
      - customer_id
      - end_dt
      - service_id
      - start_dt
    AppointmentCreateStatusEnum:
      enum:
      - pending
      - confirmed
      type: string
      description: |-
        * `pending` - pending
        * `confirmed` - confirmed
    AppointmentDetail:
      type: object
      description: Serializer for appointment detail view.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        customer:
          type: string
          readOnly: true
        service:
          allOf:
          - $ref: '#/components/schemas/ServiceList'
          readOnly: true
        variant:
          allOf:
          - $ref: '#/components/schemas/ServiceVariant'
          readOnly: true
        start_dt:
          type: string
          format: date-time
          description: Appointment start date and time
        end_dt:
          type: string
          format: date-time
          description: Appointment end date and time
        duration_minutes:
          type: string
          readOnly: true
        status:
          allOf:
          - $ref: '#/components/schemas/StatusD3bEnum'
          description: |-
            Current appointment status

            * `pending` - Pending
            * `confirmed` - Confirmed
            * `done` - Done
            * `canceled` - Canceled
            * `no_show` - No Show
        notes:
          type: string
          nullable: true
          description: Customer notes or special requests
        provider_ref:
          type: string
          nullable: true
          description: External calendar or booking system reference
          maxLength: 255
        metadata:
          description: Additional appointment metadata
        can_cancel:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - can_cancel
      - created_at
      - customer
      - duration_minutes
      - end_dt
      - id
      - service
      - start_dt
      - updated_at
      - variant
    AppointmentDetailRequest:
      type: object
      description: Serializer for appointment detail view.
      properties:
        start_dt:
          type: string
          format: date-time
          description: Appointment start date and time
        end_dt:
          type: string
          format: date-time
          description: Appointment end date and time
        status:
          allOf:
          - $ref: '#/components/schemas/StatusD3bEnum'
          description: |-
            Current appointment status

            * `pending` - Pending
            * `confirmed` - Confirmed
            * `done` - Done
            * `canceled` - Canceled
            * `no_show` - No Show
        notes:
          type: string
          nullable: true
          description: Customer notes or special requests
        provider_ref:
          type: string
          nullable: true
          description: External calendar or booking system reference
          maxLength: 255
        metadata:
          description: Additional appointment metadata
      required:
      - end_dt
      - start_dt
    AppointmentList:
      type: object
      description: Serializer for appointment list view.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        customer_name:
          type: string
          readOnly: true
        service_title:
          type: string
          readOnly: true
        variant_title:
          type: string
          readOnly: true
          nullable: true
        start_dt:
          type: string
          format: date-time
          description: Appointment start date and time
        end_dt:
          type: string
          format: date-time
          description: Appointment end date and time
        duration_minutes:
          type: string
          readOnly: true
        status:
          allOf:
          - $ref: '#/components/schemas/StatusD3bEnum'
          description: |-
            Current appointment status

            * `pending` - Pending
            * `confirmed` - Confirmed
            * `done` - Done
            * `canceled` - Canceled
            * `no_show` - No Show
        notes:
          type: string
          nullable: true
          description: Customer notes or special requests
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
      required:
      - created_at
      - customer_name
      - duration_minutes
      - end_dt
      - id
      - service_title
      - start_dt
      - variant_title
    AssignRolesRequest:
      type: object
      description: Serializer for assigning roles to a user.
      properties:
        role_ids:
          type: array
          items:
            type: string
            format: uuid
          description: List of role IDs to assign
      required:
      - role_ids
    AuditLog:
      type: object
      description: Serializer for AuditLog model.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        tenant_name:
          type: string
          readOnly: true
        user_email:
          type: string
          format: email
          readOnly: true
        action:
          type: string
          readOnly: true
          description: Action performed (e.g., 'role_assigned', 'permission_denied',
            'product_created')
        target_type:
          type: string
          readOnly: true
          description: Type of target entity (e.g., 'Role', 'Product', 'Withdrawal')
        target_id:
          type: string
          format: uuid
          readOnly: true
          nullable: true
          description: ID of target entity
        diff:
          readOnly: true
          description: Before/after changes in JSON format
        metadata:
          readOnly: true
          description: Additional context metadata
        ip_address:
          type: string
          readOnly: true
          nullable: true
          description: IP address of the request
        user_agent:
          type: string
          readOnly: true
          description: User agent string
        request_id:
          type: string
          format: uuid
          readOnly: true
          nullable: true
          description: Request ID for tracing
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
      required:
      - action
      - created_at
      - diff
      - id
      - ip_address
      - metadata
      - request_id
      - target_id
      - target_type
      - tenant_name
      - user_agent
      - user_email
    AvailabilitySlot:
      type: object
      description: Serializer for available time slots.
      properties:
        start_dt:
          type: string
          format: date-time
        end_dt:
          type: string
          format: date-time
        capacity_left:
          type: integer
        window_id:
          type: string
          format: uuid
        window_capacity:
          type: integer
      required:
      - capacity_left
      - end_dt
      - start_dt
      - window_capacity
      - window_id
    BillingCycleEnum:
      enum:
      - monthly
      - yearly
      type: string
      description: |-
        * `monthly` - monthly
        * `yearly` - yearly
    BlankEnum:
      enum:
      - ''
    BusinessSettingsRequest:
      type: object
      description: |-
        Serializer for business settings.

        Includes timezone, business hours, quiet hours, and notification preferences.
      properties:
        timezone:
          type: string
          minLength: 1
          maxLength: 50
        business_hours:
          type: object
          additionalProperties: {}
        quiet_hours:
          type: object
          additionalProperties: {}
        notification_preferences:
          type: object
          additionalProperties: {}
    ButtonTypeEnum:
      enum:
      - reply
      - url
      - call
      type: string
      description: |-
        * `reply` - reply
        * `url` - url
        * `call` - call
    CampaignButtonInteraction:
      type: object
      description: Serializer for campaign button interactions.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        campaign_id:
          type: string
          format: uuid
          readOnly: true
        customer_id:
          type: string
          format: uuid
          readOnly: true
        message_id:
          type: string
          format: uuid
          readOnly: true
        button_id:
          type: string
          readOnly: true
        button_title:
          type: string
          readOnly: true
        button_type:
          type: string
          readOnly: true
        clicked_at:
          type: string
          format: date-time
          readOnly: true
        led_to_conversion:
          type: boolean
          readOnly: true
        conversion_type:
          type: string
          readOnly: true
          nullable: true
        conversion_reference_id:
          type: string
          format: uuid
          readOnly: true
          nullable: true
      required:
      - button_id
      - button_title
      - button_type
      - campaign_id
      - clicked_at
      - conversion_reference_id
      - conversion_type
      - customer_id
      - id
      - led_to_conversion
      - message_id
    CampaignExecuteRequest:
      type: object
      description: Serializer for executing a campaign.
      properties:
        confirm:
          type: boolean
          default: false
          description: Confirm campaign execution
    CampaignReport:
      type: object
      description: Serializer for campaign analytics report.
      properties:
        campaign_id:
          type: string
          format: uuid
          readOnly: true
        name:
          type: string
          readOnly: true
        description:
          type: string
          readOnly: true
        status:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
        started_at:
          type: string
          format: date-time
          readOnly: true
          nullable: true
        completed_at:
          type: string
          format: date-time
          readOnly: true
          nullable: true
        duration_seconds:
          type: integer
          readOnly: true
          nullable: true
        targeting:
          readOnly: true
        delivery:
          readOnly: true
        engagement:
          readOnly: true
        ab_test:
          readOnly: true
        button_analytics:
          readOnly: true
      required:
      - ab_test
      - button_analytics
      - campaign_id
      - completed_at
      - created_at
      - delivery
      - description
      - duration_seconds
      - engagement
      - name
      - started_at
      - status
      - targeting
    ChannelEnum:
      enum:
      - whatsapp
      - sms
      - telegram
      - web
      type: string
      description: |-
        * `whatsapp` - WhatsApp
        * `sms` - SMS
        * `telegram` - Telegram
        * `web` - Web Chat
    ConsentEvent:
      type: object
      description: Serializer for ConsentEvent (audit trail).
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        tenant:
          type: string
          format: uuid
          description: Tenant this event belongs to
        customer:
          type: string
          format: uuid
          description: Customer this event is for
          readOnly: true
        customer_id:
          type: string
          format: uuid
          readOnly: true
        customer_name:
          type: string
          readOnly: true
          nullable: true
        preferences:
          type: string
          format: uuid
          description: Preferences record this event relates to
        consent_type:
          allOf:
          - $ref: '#/components/schemas/ConsentTypeEnum'
          readOnly: true
          description: |-
            Type of consent that changed

            * `transactional_messages` - Transactional Messages
            * `reminder_messages` - Reminder Messages
            * `promotional_messages` - Promotional Messages
        consent_type_display:
          type: string
          readOnly: true
        previous_value:
          type: boolean
          readOnly: true
          description: Previous consent value
        new_value:
          type: boolean
          readOnly: true
          description: New consent value
        source:
          allOf:
          - $ref: '#/components/schemas/SourceEnum'
          readOnly: true
          description: |-
            Source of the change

            * `customer_initiated` - Customer Initiated
            * `tenant_updated` - Tenant Updated
            * `system_default` - System Default
        source_display:
          type: string
          readOnly: true
        reason:
          type: string
          readOnly: true
          description: Reason for the change (if provided)
        changed_by:
          type: string
          format: uuid
          description: User who made the change (if tenant_updated)
          readOnly: true
          nullable: true
        changed_by_email:
          type: string
          format: email
          readOnly: true
          nullable: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
      required:
      - changed_by
      - changed_by_email
      - consent_type
      - consent_type_display
      - created_at
      - customer
      - customer_id
      - customer_name
      - id
      - new_value
      - preferences
      - previous_value
      - reason
      - source
      - source_display
      - tenant
    ConsentTypeEnum:
      enum:
      - transactional_messages
      - reminder_messages
      - promotional_messages
      type: string
      description: |-
        * `transactional_messages` - Transactional Messages
        * `reminder_messages` - Reminder Messages
        * `promotional_messages` - Promotional Messages
    ConversationDetail:
      type: object
      description: Serializer for conversation detail view.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        customer:
          allOf:
          - $ref: '#/components/schemas/CustomerBasic'
          readOnly: true
        status:
          allOf:
          - $ref: '#/components/schemas/ConversationDetailStatusEnum'
          readOnly: true
          description: |-
            Current conversation status

            * `open` - Open
            * `bot` - Bot Handling
            * `handoff` - Human Handoff
            * `closed` - Closed
            * `dormant` - Dormant
        channel:
          allOf:
          - $ref: '#/components/schemas/ChannelEnum'
          readOnly: true
          description: |-
            Communication channel

            * `whatsapp` - WhatsApp
            * `sms` - SMS
            * `telegram` - Telegram
            * `web` - Web Chat
        last_intent:
          type: string
          readOnly: true
          nullable: true
          description: Last detected intent
        intent_confidence:
          type: number
          format: double
          readOnly: true
          nullable: true
          description: Confidence score of last intent
        low_confidence_count:
          type: integer
          readOnly: true
          description: Count of consecutive low-confidence intents
        last_agent:
          type: string
          format: uuid
          description: Last human agent assigned
          readOnly: true
          nullable: true
        handoff_at:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: Timestamp when handed off to human
        metadata:
          readOnly: true
          description: Additional conversation metadata
        message_count:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - channel
      - created_at
      - customer
      - handoff_at
      - id
      - intent_confidence
      - last_agent
      - last_intent
      - low_confidence_count
      - message_count
      - metadata
      - status
      - updated_at
    ConversationDetailStatusEnum:
      enum:
      - open
      - bot
      - handoff
      - closed
      - dormant
      type: string
      description: |-
        * `open` - Open
        * `bot` - Bot Handling
        * `handoff` - Human Handoff
        * `closed` - Closed
        * `dormant` - Dormant
    ConversationHandoffRequest:
      type: object
      description: Serializer for handoff request.
      properties:
        agent_id:
          type: string
          format: uuid
          nullable: true
          description: Optional agent ID to assign conversation to
        reason:
          type: string
          description: Optional reason for handoff
          maxLength: 500
    CorrectionApprovalRequest:
      type: object
      description: Serializer for approving corrections for training.
      properties:
        approved:
          type: boolean
        quality_score:
          type: number
          format: double
          maximum: 5.0
          minimum: 0.0
      required:
      - approved
    CorrectionCategoryEnum:
      enum:
      - factual_error
      - tone_inappropriate
      - missing_information
      - wrong_intent
      - poor_recommendation
      - other
      type: string
      description: |-
        * `factual_error` - Factual Error
        * `tone_inappropriate` - Inappropriate Tone
        * `missing_information` - Missing Information
        * `wrong_intent` - Wrong Intent Detection
        * `poor_recommendation` - Poor Recommendation
        * `other` - Other
    CustomerBasic:
      type: object
      description: Basic customer information for conversation listings.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        name:
          type: string
          readOnly: true
          nullable: true
          description: Customer name (if provided)
        phone_e164:
          type: string
          readOnly: true
          description: Encrypted phone number in E.164 format
        tags:
          readOnly: true
          description: Customer tags for segmentation (e.g., ['vip', 'new_customer'])
        last_seen_at:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: Last interaction timestamp
      required:
      - id
      - last_seen_at
      - name
      - phone_e164
      - tags
    CustomerDetail:
      type: object
      description: Serializer for customer detail view.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        phone_e164:
          type: string
          readOnly: true
          description: Encrypted phone number in E.164 format
        name:
          type: string
          readOnly: true
          nullable: true
          description: Customer name (if provided)
        timezone:
          type: string
          readOnly: true
          nullable: true
          description: Customer timezone (detected or provided)
        language:
          type: string
          readOnly: true
          nullable: true
          description: Preferred language code
        tags:
          readOnly: true
          description: Customer tags for segmentation (e.g., ['vip', 'new_customer'])
        metadata:
          readOnly: true
          description: Additional customer metadata
        last_seen_at:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: Last interaction timestamp
        first_interaction_at:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: First interaction timestamp
        consent_status:
          type: string
          readOnly: true
        conversation_count:
          type: string
          readOnly: true
        recent_conversations:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - consent_status
      - conversation_count
      - created_at
      - first_interaction_at
      - id
      - language
      - last_seen_at
      - metadata
      - name
      - phone_e164
      - recent_conversations
      - tags
      - timezone
      - updated_at
    CustomerExportRequest:
      type: object
      description: Serializer for customer data export request.
      properties:
        mask_pii:
          type: boolean
          default: false
          description: Whether to mask PII fields (phone numbers)
        include_conversations:
          type: boolean
          default: false
          description: Whether to include conversation history
        include_consent_history:
          type: boolean
          default: false
          description: Whether to include consent change history
        format:
          allOf:
          - $ref: '#/components/schemas/FormatEnum'
          default: json
          description: |-
            Export format

            * `json` - json
            * `csv` - csv
    CustomerPreferences:
      type: object
      description: Serializer for CustomerPreferences.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        tenant:
          type: string
          format: uuid
          description: Tenant this preference record belongs to
          readOnly: true
        customer:
          type: string
          format: uuid
          description: Customer these preferences belong to
          readOnly: true
        customer_id:
          type: string
          format: uuid
          readOnly: true
        customer_name:
          type: string
          readOnly: true
          nullable: true
        customer_phone:
          type: string
          readOnly: true
        transactional_messages:
          type: boolean
          description: Consent for transactional messages (order updates, payment
            confirmations)
        reminder_messages:
          type: boolean
          description: Consent for reminder messages (appointment reminders, cart
            abandonment)
        promotional_messages:
          type: boolean
          description: Consent for promotional messages (marketing, offers, campaigns)
        last_updated_by:
          type: string
          nullable: true
          description: Source of last update (customer, tenant, system)
          maxLength: 50
        notes:
          type: string
          description: Additional notes about preference changes (max 5,000 characters)
          maxLength: 5000
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - created_at
      - customer
      - customer_id
      - customer_name
      - customer_phone
      - id
      - tenant
      - updated_at
    CustomerPreferencesUpdateRequest:
      type: object
      description: Serializer for updating customer preferences.
      properties:
        transactional_messages:
          type: boolean
        reminder_messages:
          type: boolean
        promotional_messages:
          type: boolean
        reason:
          type: string
          description: Reason for updating preferences
          maxLength: 500
    Document:
      type: object
      description: Serializer for Document model.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        file_name:
          type: string
          maxLength: 255
        file_type:
          allOf:
          - $ref: '#/components/schemas/FileTypeEnum'
          readOnly: true
        file_size:
          type: integer
          readOnly: true
          description: File size in bytes
        status:
          allOf:
          - $ref: '#/components/schemas/DocumentStatusEnum'
          readOnly: true
        processing_progress:
          type: integer
          readOnly: true
          description: Processing progress percentage (0-100)
        error_message:
          type: string
          readOnly: true
          nullable: true
        chunk_count:
          type: integer
          readOnly: true
        total_tokens:
          type: integer
          readOnly: true
        uploaded_by:
          type: string
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        processed_at:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: When processing was completed
      required:
      - chunk_count
      - created_at
      - error_message
      - file_name
      - file_size
      - file_type
      - id
      - processed_at
      - processing_progress
      - status
      - total_tokens
    DocumentChunk:
      type: object
      description: Serializer for DocumentChunk model.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        document:
          type: string
          format: uuid
          description: Unique identifier
        document_name:
          type: string
          readOnly: true
        chunk_index:
          type: integer
        content:
          type: string
        token_count:
          type: integer
        page_number:
          type: integer
          nullable: true
          description: Page number in source document (if applicable)
        section:
          type: string
          nullable: true
          description: Section or heading title (if applicable)
          maxLength: 255
        embedding_model:
          type: string
          description: Embedding model used for this chunk
          maxLength: 100
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
      required:
      - chunk_index
      - content
      - created_at
      - document
      - document_name
      - id
    DocumentStatusEnum:
      enum:
      - pending
      - processing
      - completed
      - failed
      type: string
      description: |-
        * `pending` - Pending
        * `processing` - Processing
        * `completed` - Completed
        * `failed` - Failed
    EmailVerificationRequest:
      type: object
      description: Serializer for email verification.
      properties:
        token:
          type: string
          minLength: 1
      required:
      - token
    EntryTypeEnum:
      enum:
      - faq
      - policy
      - product_info
      - service_info
      - procedure
      - general
      type: string
      description: |-
        * `faq` - FAQ
        * `policy` - Policy
        * `product_info` - Product Information
        * `service_info` - Service Information
        * `procedure` - Procedure
        * `general` - General Knowledge
    ExternalSourceEnum:
      enum:
      - woocommerce
      - shopify
      - manual
      type: string
      description: |-
        * `woocommerce` - WooCommerce
        * `shopify` - Shopify
        * `manual` - Manual
    FeedbackAnalytics:
      type: object
      description: Serializer for feedback analytics.
      properties:
        total_feedback:
          type: integer
        helpful_count:
          type: integer
        not_helpful_count:
          type: integer
        helpful_rate:
          type: number
          format: double
        avg_implicit_score:
          type: number
          format: double
        feedback_with_comments:
          type: integer
        user_continued_rate:
          type: number
          format: double
        completed_action_rate:
          type: number
          format: double
        requested_human_rate:
          type: number
          format: double
      required:
      - avg_implicit_score
      - completed_action_rate
      - feedback_with_comments
      - helpful_count
      - helpful_rate
      - not_helpful_count
      - requested_human_rate
      - total_feedback
      - user_continued_rate
    FeedbackSubmitRatingEnum:
      enum:
      - helpful
      - not_helpful
      type: string
      description: |-
        * `helpful` - helpful
        * `not_helpful` - not_helpful
    FeedbackSubmitRequest:
      type: object
      description: Serializer for submitting feedback.
      properties:
        agent_interaction_id:
          type: integer
        rating:
          $ref: '#/components/schemas/FeedbackSubmitRatingEnum'
        feedback_text:
          type: string
          maxLength: 1000
      required:
      - agent_interaction_id
      - rating
    FileTypeEnum:
      enum:
      - pdf
      - txt
      - docx
      type: string
      description: |-
        * `pdf` - PDF
        * `txt` - Text
        * `docx` - Word Document
    FormatEnum:
      enum:
      - json
      - csv
      type: string
      description: |-
        * `json` - json
        * `csv` - csv
    HumanCorrection:
      type: object
      description: Serializer for human corrections.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        agent_interaction:
          type: string
          format: uuid
          description: Agent interaction that was corrected
        conversation:
          type: string
          format: uuid
          description: Conversation this correction belongs to
        bot_response:
          type: string
          description: Original bot response that was incorrect
        human_response:
          type: string
          description: Corrected response from human agent
        correction_reason:
          type: string
          description: Explanation of why correction was needed
        correction_category:
          allOf:
          - $ref: '#/components/schemas/CorrectionCategoryEnum'
          description: |-
            Category of correction

            * `factual_error` - Factual Error
            * `tone_inappropriate` - Inappropriate Tone
            * `missing_information` - Missing Information
            * `wrong_intent` - Wrong Intent Detection
            * `poor_recommendation` - Poor Recommendation
            * `other` - Other
        corrected_by:
          type: string
          format: uuid
          description: Human agent who made the correction
          nullable: true
        corrected_by_name:
          type: string
          readOnly: true
        approved_for_training:
          type: boolean
          description: Whether this correction is approved for training data
        approved_by:
          type: string
          format: uuid
          description: User who approved this correction for training
          nullable: true
        approved_by_name:
          type: string
          readOnly: true
        approved_at:
          type: string
          format: date-time
          nullable: true
          description: When this correction was approved
        quality_score:
          type: number
          format: double
          maximum: 5.0
          minimum: 0.0
          nullable: true
          description: Quality rating of the correction (0-5)
        metadata:
          description: Additional correction metadata
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
      required:
      - agent_interaction
      - approved_by_name
      - bot_response
      - conversation
      - corrected_by_name
      - correction_category
      - correction_reason
      - created_at
      - human_response
      - id
    HumanCorrectionRequest:
      type: object
      description: Serializer for human corrections.
      properties:
        agent_interaction:
          type: string
          format: uuid
          description: Agent interaction that was corrected
        conversation:
          type: string
          format: uuid
          description: Conversation this correction belongs to
        bot_response:
          type: string
          minLength: 1
          description: Original bot response that was incorrect
        human_response:
          type: string
          minLength: 1
          description: Corrected response from human agent
        correction_reason:
          type: string
          minLength: 1
          description: Explanation of why correction was needed
        correction_category:
          allOf:
          - $ref: '#/components/schemas/CorrectionCategoryEnum'
          description: |-
            Category of correction

            * `factual_error` - Factual Error
            * `tone_inappropriate` - Inappropriate Tone
            * `missing_information` - Missing Information
            * `wrong_intent` - Wrong Intent Detection
            * `poor_recommendation` - Poor Recommendation
            * `other` - Other
        corrected_by:
          type: string
          format: uuid
          description: Human agent who made the correction
          nullable: true
        approved_for_training:
          type: boolean
          description: Whether this correction is approved for training data
        approved_by:
          type: string
          format: uuid
          description: User who approved this correction for training
          nullable: true
        approved_at:
          type: string
          format: date-time
          nullable: true
          description: When this correction was approved
        quality_score:
          type: number
          format: double
          maximum: 5.0
          minimum: 0.0
          nullable: true
          description: Quality rating of the correction (0-5)
        metadata:
          description: Additional correction metadata
      required:
      - agent_interaction
      - bot_response
      - conversation
      - correction_category
      - correction_reason
      - human_response
    InteractionFeedback:
      type: object
      description: Serializer for interaction feedback.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        agent_interaction:
          type: string
          format: uuid
          description: Agent interaction being rated
        conversation:
          type: string
          format: uuid
          description: Conversation this feedback belongs to
          readOnly: true
        customer:
          type: string
          format: uuid
          description: Customer who provided feedback
          readOnly: true
        rating:
          allOf:
          - $ref: '#/components/schemas/InteractionFeedbackRatingEnum'
          description: |-
            User rating (helpful/not_helpful)

            * `helpful` - Helpful
            * `not_helpful` - Not Helpful
        feedback_text:
          type: string
          description: Optional text feedback from user
        user_continued:
          type: boolean
          description: User continued conversation after bot response
        completed_action:
          type: boolean
          description: User completed intended action (purchase, booking, etc.)
        requested_human:
          type: boolean
          description: User requested human handoff
        response_time_seconds:
          type: integer
          nullable: true
          description: Time taken for user to respond (engagement metric)
        implicit_satisfaction_score:
          type: number
          format: double
          description: |-
            Calculate implicit satisfaction score (0.0 to 1.0).

            Based on behavioral signals:
            - User continued: +0.3
            - Completed action: +0.5
            - Requested human: -0.5
            - Fast response (<30s): +0.2
          readOnly: true
        feedback_source:
          type: string
          description: Source of feedback (whatsapp_button, api, etc.)
          maxLength: 50
        metadata:
          description: Additional feedback metadata
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
      required:
      - agent_interaction
      - conversation
      - created_at
      - customer
      - id
      - implicit_satisfaction_score
      - rating
    InteractionFeedbackRatingEnum:
      enum:
      - helpful
      - not_helpful
      type: string
      description: |-
        * `helpful` - Helpful
        * `not_helpful` - Not Helpful
    InviteMemberRequest:
      type: object
      description: Serializer for inviting a new member to a tenant.
      properties:
        email:
          type: string
          format: email
          minLength: 1
        role_ids:
          type: array
          items:
            type: string
            format: uuid
          description: List of role IDs to assign to the invited user
      required:
      - email
    InviteStatusEnum:
      enum:
      - pending
      - accepted
      - revoked
      type: string
      description: |-
        * `pending` - Pending
        * `accepted` - Accepted
        * `revoked` - Revoked
    KnowledgeEntry:
      type: object
      description: |-
        Serializer for KnowledgeEntry with full field access.

        Provides read/write access to all knowledge entry fields including
        embeddings, metadata, and versioning information.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        tenant:
          type: string
          format: uuid
          description: Tenant this knowledge entry belongs to
          readOnly: true
        tenant_name:
          type: string
          readOnly: true
        entry_type:
          allOf:
          - $ref: '#/components/schemas/EntryTypeEnum'
          description: |-
            Type of knowledge entry

            * `faq` - FAQ
            * `policy` - Policy
            * `product_info` - Product Information
            * `service_info` - Service Information
            * `procedure` - Procedure
            * `general` - General Knowledge
        category:
          type: string
          description: Category for organizing entries (e.g., 'shipping', 'returns',
            'technical')
          maxLength: 100
        title:
          type: string
          description: Title or question for this entry
          maxLength: 255
        content:
          type: string
          description: Full content or answer for this entry
        keywords:
          type: string
          description: Comma-separated keywords for search optimization
        embedding:
          readOnly: true
          nullable: true
          description: Vector embedding for semantic search (generated from title
            + content)
        metadata:
          description: Additional metadata (source, author, related_entries, etc.)
        priority:
          type: integer
          maximum: 100
          minimum: 0
          description: Priority for ranking search results (0-100, higher = more important)
        is_active:
          type: boolean
          description: Whether this entry is active and should be used by the agent
        version:
          type: integer
          readOnly: true
          description: Version number for tracking updates
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - content
      - created_at
      - embedding
      - id
      - tenant
      - tenant_name
      - title
      - updated_at
      - version
    KnowledgeEntryBulkImportRequest:
      type: object
      description: |-
        Serializer for bulk importing knowledge entries.

        Accepts a list of entry data and validates each entry before import.
      properties:
        entries:
          type: array
          items:
            type: object
            additionalProperties: {}
          description: List of knowledge entries to import (max 100 per request)
          maxItems: 100
          minItems: 1
      required:
      - entries
    KnowledgeEntryCreateRequest:
      type: object
      description: |-
        Serializer for creating new knowledge entries.

        Simplified serializer for entry creation that accepts keywords as a list
        and handles embedding generation automatically.
      properties:
        entry_type:
          allOf:
          - $ref: '#/components/schemas/EntryTypeEnum'
          description: |-
            Type of knowledge entry

            * `faq` - FAQ
            * `policy` - Policy
            * `product_info` - Product Information
            * `service_info` - Service Information
            * `procedure` - Procedure
            * `general` - General Knowledge
        category:
          type: string
          description: Category for organizing entries (e.g., 'shipping', 'returns',
            'technical')
          maxLength: 100
        title:
          type: string
          minLength: 1
          description: Title or question for this entry
          maxLength: 255
        content:
          type: string
          minLength: 1
          description: Full content or answer for this entry
        keywords_list:
          type: array
          items:
            type: string
            minLength: 1
          description: List of keywords for search optimization
        metadata:
          description: Additional metadata (source, author, related_entries, etc.)
        priority:
          type: integer
          maximum: 100
          minimum: 0
          description: Priority for ranking search results (0-100, higher = more important)
        is_active:
          type: boolean
          description: Whether this entry is active and should be used by the agent
      required:
      - content
      - title
    KnowledgeEntrySearch:
      type: object
      description: |-
        Serializer for knowledge entry search results.

        Includes the entry data plus the similarity score from semantic search.
      properties:
        entry:
          allOf:
          - $ref: '#/components/schemas/KnowledgeEntry'
          readOnly: true
        similarity_score:
          type: number
          format: double
          readOnly: true
          description: Semantic similarity score (0.0-1.0)
      required:
      - entry
      - similarity_score
    KnowledgeEntryUpdateRequest:
      type: object
      description: |-
        Serializer for updating knowledge entries.

        Supports partial updates and handles embedding regeneration when
        title or content changes.
      properties:
        entry_type:
          allOf:
          - $ref: '#/components/schemas/EntryTypeEnum'
          description: |-
            Type of knowledge entry

            * `faq` - FAQ
            * `policy` - Policy
            * `product_info` - Product Information
            * `service_info` - Service Information
            * `procedure` - Procedure
            * `general` - General Knowledge
        category:
          type: string
          description: Category for organizing entries (e.g., 'shipping', 'returns',
            'technical')
          maxLength: 100
        title:
          type: string
          minLength: 1
          description: Title or question for this entry
          maxLength: 255
        content:
          type: string
          minLength: 1
          description: Full content or answer for this entry
        keywords_list:
          type: array
          items:
            type: string
            minLength: 1
          description: List of keywords for search optimization
        metadata:
          description: Additional metadata (source, author, related_entries, etc.)
        priority:
          type: integer
          maximum: 100
          minimum: 0
          description: Priority for ranking search results (0-100, higher = more important)
        is_active:
          type: boolean
          description: Whether this entry is active and should be used by the agent
      required:
      - content
      - title
    LoginRequest:
      type: object
      description: Serializer for user login.
      properties:
        email:
          type: string
          format: email
          minLength: 1
        password:
          type: string
          writeOnly: true
          minLength: 1
      required:
      - email
      - password
    MembershipDetail:
      type: object
      description: Detailed serializer for membership with full role details.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        user:
          allOf:
          - $ref: '#/components/schemas/User'
          readOnly: true
        tenant_id:
          type: string
          format: uuid
          readOnly: true
        tenant_name:
          type: string
          readOnly: true
        is_active:
          type: boolean
          description: Whether membership is active
        invite_status:
          allOf:
          - $ref: '#/components/schemas/InviteStatusEnum'
          description: |-
            Invitation status

            * `pending` - Pending
            * `accepted` - Accepted
            * `revoked` - Revoked
        roles:
          type: array
          items:
            $ref: '#/components/schemas/TenantUserRole'
          readOnly: true
        invited_by_email:
          type: string
          format: email
          readOnly: true
        invited_at:
          type: string
          format: date-time
          readOnly: true
          description: When invitation was sent
        joined_at:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: When user accepted invitation
        last_seen_at:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: Last activity timestamp in this tenant
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - created_at
      - id
      - invited_at
      - invited_by_email
      - joined_at
      - last_seen_at
      - roles
      - tenant_id
      - tenant_name
      - updated_at
      - user
    MessageCampaign:
      type: object
      description: Serializer for MessageCampaign.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        tenant:
          type: string
          format: uuid
          description: Tenant this campaign belongs to
          readOnly: true
        tenant_id:
          type: string
          format: uuid
          readOnly: true
        name:
          type: string
          description: Campaign name for identification
          maxLength: 255
        description:
          type: string
          description: Campaign description and notes
        message_content:
          type: string
          description: Default message content to send (max 10,000 characters)
          maxLength: 10000
        template:
          type: string
          format: uuid
          description: Template used for this campaign
          nullable: true
        template_id:
          type: string
          format: uuid
          readOnly: true
          nullable: true
        target_criteria:
          description: Criteria for selecting recipients (tags, purchase_history,
            activity)
        is_ab_test:
          type: boolean
          description: Whether this campaign is an A/B test
        variants:
          description: 'A/B test variants: [{name, content, customer_ids, metrics}]'
        media_type:
          allOf:
          - $ref: '#/components/schemas/MessageCampaignMediaTypeEnum'
          description: |-
            Type of media included in campaign

            * `text` - Text Only
            * `image` - Image
            * `video` - Video
            * `document` - Document
        media_url:
          type: string
          format: uri
          nullable: true
          description: URL to media file (image, video, or document)
          maxLength: 500
        media_caption:
          type: string
          description: Caption for media (used with images, videos, documents)
        buttons:
          description: 'List of button configurations (max 3): [{id, title, type}]'
        delivery_count:
          type: integer
          readOnly: true
          description: Total customers targeted
        delivered_count:
          type: integer
          readOnly: true
          description: Successfully delivered messages
        failed_count:
          type: integer
          readOnly: true
          description: Failed delivery attempts
        read_count:
          type: integer
          readOnly: true
          description: Messages read by customers
        response_count:
          type: integer
          readOnly: true
          description: Customer responses received
        conversion_count:
          type: integer
          readOnly: true
          description: Conversions (orders/bookings) from campaign
        status:
          allOf:
          - $ref: '#/components/schemas/MessageCampaignStatusEnum'
          readOnly: true
          description: |-
            Current campaign status

            * `draft` - Draft
            * `scheduled` - Scheduled
            * `sending` - Sending
            * `completed` - Completed
            * `canceled` - Canceled
        scheduled_at:
          type: string
          format: date-time
          nullable: true
          description: When to execute this campaign
        started_at:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: When campaign execution started
        completed_at:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: When campaign execution completed
        created_by:
          type: string
          format: uuid
          description: User who created this campaign
          readOnly: true
          nullable: true
        created_by_id:
          type: string
          format: uuid
          readOnly: true
          nullable: true
        metadata:
          readOnly: true
          description: Additional campaign metadata
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
        delivery_rate:
          type: number
          format: double
          description: Get delivery success rate.
          readOnly: true
        engagement_rate:
          type: number
          format: double
          description: Get engagement rate.
          readOnly: true
        conversion_rate:
          type: number
          format: double
          description: Get conversion rate.
          readOnly: true
        read_rate:
          type: number
          format: double
          description: Get read rate.
          readOnly: true
      required:
      - completed_at
      - conversion_count
      - conversion_rate
      - created_at
      - created_by
      - created_by_id
      - delivered_count
      - delivery_count
      - delivery_rate
      - engagement_rate
      - failed_count
      - id
      - message_content
      - metadata
      - name
      - read_count
      - read_rate
      - response_count
      - started_at
      - status
      - template_id
      - tenant
      - tenant_id
      - updated_at
    MessageCampaignCreateMediaTypeEnum:
      enum:
      - text
      - image
      - video
      - document
      type: string
      description: |-
        * `text` - text
        * `image` - image
        * `video` - video
        * `document` - document
    MessageCampaignCreateRequest:
      type: object
      description: Serializer for creating message campaigns.
      properties:
        name:
          type: string
          minLength: 1
          description: Campaign name
          maxLength: 255
        description:
          type: string
          description: Campaign description
        message_content:
          type: string
          minLength: 1
          description: Message content to send
        template_id:
          type: string
          format: uuid
          nullable: true
          description: Optional template ID
        target_criteria:
          description: Targeting criteria (tags, purchase_history, activity)
        scheduled_at:
          type: string
          format: date-time
          nullable: true
          description: When to execute campaign (ISO 8601 format)
        is_ab_test:
          type: boolean
          default: false
          description: Whether this is an A/B test
        variants:
          type: array
          items: {}
          description: 'A/B test variants: [{name, content}]'
        media_type:
          allOf:
          - $ref: '#/components/schemas/MessageCampaignCreateMediaTypeEnum'
          default: text
          description: |-
            Type of media to include

            * `text` - text
            * `image` - image
            * `video` - video
            * `document` - document
        media_url:
          type: string
          format: uri
          nullable: true
          minLength: 1
          description: URL to media file (required for non-text media types)
          maxLength: 500
        media_caption:
          type: string
          description: Caption for media (max 1024 characters)
          maxLength: 1024
        buttons:
          type: array
          items: {}
          description: 'Button configurations (max 3): [{id, title, type, url?, phone_number?}]'
          maxItems: 3
      required:
      - message_content
      - name
    MessageCampaignMediaTypeEnum:
      enum:
      - text
      - image
      - video
      - document
      type: string
      description: |-
        * `text` - Text Only
        * `image` - Image
        * `video` - Video
        * `document` - Document
    MessageCampaignStatusEnum:
      enum:
      - draft
      - scheduled
      - sending
      - completed
      - canceled
      type: string
      description: |-
        * `draft` - Draft
        * `scheduled` - Scheduled
        * `sending` - Sending
        * `completed` - Completed
        * `canceled` - Canceled
    MessageTemplate:
      type: object
      description: Serializer for MessageTemplate.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        tenant:
          type: string
          format: uuid
          description: Tenant this template belongs to
          readOnly: true
        name:
          type: string
          description: Template name for identification
          maxLength: 255
        content:
          type: string
          description: Template content with {{placeholder}} syntax (max 5,000 characters)
          maxLength: 5000
        message_type:
          allOf:
          - $ref: '#/components/schemas/MessageType384Enum'
          description: |-
            Type of message this template is for

            * `transactional` - Transactional
            * `reminder` - Reminder
            * `promotional` - Promotional
            * `reengagement` - Re-engagement
        message_type_display:
          type: string
          readOnly: true
        usage_count:
          type: integer
          readOnly: true
          description: Number of times this template has been used
        description:
          type: string
          description: Template description
        variables:
          description: List of available variables/placeholders
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - content
      - created_at
      - id
      - message_type
      - message_type_display
      - name
      - tenant
      - updated_at
      - usage_count
    MessageTemplateCreateRequest:
      type: object
      description: Serializer for creating message templates.
      properties:
        name:
          type: string
          minLength: 1
          description: Template name
          maxLength: 255
        content:
          type: string
          minLength: 1
          description: Template content with {{placeholder}} syntax
        message_type:
          allOf:
          - $ref: '#/components/schemas/MessageType384Enum'
          description: |-
            Type of message

            * `transactional` - Transactional
            * `reminder` - Reminder
            * `promotional` - Promotional
            * `reengagement` - Re-engagement
        description:
          type: string
          description: Template description
        variables:
          type: array
          items:
            type: string
            minLength: 1
          description: List of available variables
      required:
      - content
      - message_type
      - name
    MessageType352Enum:
      enum:
      - text
      - button
      - list
      - media
      type: string
      description: |-
        * `text` - Text
        * `button` - Button
        * `list` - List
        * `media` - Media
    MessageType384Enum:
      enum:
      - transactional
      - reminder
      - promotional
      - reengagement
      type: string
      description: |-
        * `transactional` - Transactional
        * `reminder` - Reminder
        * `promotional` - Promotional
        * `reengagement` - Re-engagement
    NullEnum:
      enum:
      - null
    OnboardingCompleteRequest:
      type: object
      description: Serializer for marking an onboarding step as complete.
      properties:
        step:
          type: string
          minLength: 1
          description: Name of the onboarding step to mark as complete
      required:
      - step
    OnboardingStatus:
      type: object
      description: |-
        Serializer for onboarding status response.

        Returns:
        - Overall completion status
        - Completion percentage (based on required steps)
        - Status of each required step
        - Status of each optional step
        - List of pending required steps
      properties:
        completed:
          type: boolean
          description: Whether all required onboarding steps are complete
        completion_percentage:
          type: integer
          description: Completion percentage based on required steps (0-100)
        required_steps:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/OnboardingStep'
          description: Status of each required onboarding step
        optional_steps:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/OnboardingStep'
          description: Status of each optional onboarding step
        pending_steps:
          type: array
          items:
            type: string
          description: List of pending required step names
      required:
      - completed
      - completion_percentage
      - optional_steps
      - pending_steps
      - required_steps
    OnboardingStep:
      type: object
      description: Serializer for individual onboarding step status.
      properties:
        completed:
          type: boolean
        completed_at:
          type: string
          format: date-time
          nullable: true
      required:
      - completed
      - completed_at
    OpenAICredentialsRequest:
      type: object
      description: Serializer for setting OpenAI credentials.
      properties:
        api_key:
          type: string
          minLength: 20
        org_id:
          type: string
      required:
      - api_key
    OrderCreateRequest:
      type: object
      description: Serializer for creating Order.
      properties:
        customer:
          type: string
          format: uuid
          description: Customer who placed the order
        currency:
          type: string
          minLength: 1
          description: Currency code (ISO 4217)
          maxLength: 3
        subtotal:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Order subtotal (sum of item prices)
        shipping:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Shipping cost
        total:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Total order amount (subtotal + shipping)
        status:
          allOf:
          - $ref: '#/components/schemas/Status5f7Enum'
          description: |-
            Order status

            * `draft` - Draft
            * `pending_payment` - Pending Payment
            * `placed` - Placed
            * `paid` - Paid
            * `fulfilled` - Fulfilled
            * `canceled` - Canceled
        items:
          type: array
          items:
            $ref: '#/components/schemas/OrderItemRequest'
        payment_ref:
          type: string
          nullable: true
          description: External payment reference ID
          maxLength: 255
        metadata:
          description: Additional order metadata
      required:
      - currency
      - customer
      - items
      - subtotal
      - total
    OrderDetail:
      type: object
      description: Serializer for Order detail view (with items).
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        tenant_name:
          type: string
          readOnly: true
        customer:
          type: string
          format: uuid
          description: Customer who placed the order
        customer_name:
          type: string
          readOnly: true
        customer_phone:
          type: string
          readOnly: true
        currency:
          type: string
          description: Currency code (ISO 4217)
          maxLength: 3
        subtotal:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Order subtotal (sum of item prices)
        shipping:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Shipping cost
        total:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Total order amount (subtotal + shipping)
        status:
          allOf:
          - $ref: '#/components/schemas/Status5f7Enum'
          description: |-
            Order status

            * `draft` - Draft
            * `pending_payment` - Pending Payment
            * `placed` - Placed
            * `paid` - Paid
            * `fulfilled` - Fulfilled
            * `canceled` - Canceled
        items:
          type: array
          items:
            $ref: '#/components/schemas/OrderItem'
          readOnly: true
        item_count:
          type: integer
          readOnly: true
        payment_ref:
          type: string
          nullable: true
          description: External payment reference ID
          maxLength: 255
        paid_at:
          type: string
          format: date-time
          nullable: true
          description: Timestamp when payment was received
        fulfilled_at:
          type: string
          format: date-time
          nullable: true
          description: Timestamp when order was fulfilled
        tracking_number:
          type: string
          nullable: true
          description: Shipping tracking number
          maxLength: 255
        checkout_url:
          type: string
          readOnly: true
        payment_provider:
          type: string
          readOnly: true
        metadata:
          description: Additional order metadata
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - checkout_url
      - created_at
      - currency
      - customer
      - customer_name
      - customer_phone
      - id
      - item_count
      - items
      - payment_provider
      - subtotal
      - tenant_name
      - total
      - updated_at
    OrderItem:
      type: object
      description: Serializer for order item (embedded in Order).
      properties:
        product_id:
          type: string
          format: uuid
        variant_id:
          type: string
          format: uuid
          nullable: true
        title:
          type: string
        quantity:
          type: integer
          minimum: 1
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
        currency:
          type: string
          nullable: true
          maxLength: 3
      required:
      - price
      - product_id
      - quantity
      - title
    OrderItemRequest:
      type: object
      description: Serializer for order item (embedded in Order).
      properties:
        product_id:
          type: string
          format: uuid
        variant_id:
          type: string
          format: uuid
          nullable: true
        title:
          type: string
          minLength: 1
        quantity:
          type: integer
          minimum: 1
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
        currency:
          type: string
          nullable: true
          minLength: 1
          maxLength: 3
      required:
      - price
      - product_id
      - quantity
      - title
    OrderList:
      type: object
      description: Serializer for Order list view.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        tenant_name:
          type: string
          readOnly: true
        customer:
          type: string
          format: uuid
          description: Customer who placed the order
        customer_name:
          type: string
          readOnly: true
        customer_phone:
          type: string
          readOnly: true
        currency:
          type: string
          description: Currency code (ISO 4217)
          maxLength: 3
        subtotal:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Order subtotal (sum of item prices)
        shipping:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Shipping cost
        total:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Total order amount (subtotal + shipping)
        status:
          allOf:
          - $ref: '#/components/schemas/Status5f7Enum'
          description: |-
            Order status

            * `draft` - Draft
            * `pending_payment` - Pending Payment
            * `placed` - Placed
            * `paid` - Paid
            * `fulfilled` - Fulfilled
            * `canceled` - Canceled
        item_count:
          type: integer
          readOnly: true
        payment_ref:
          type: string
          nullable: true
          description: External payment reference ID
          maxLength: 255
        paid_at:
          type: string
          format: date-time
          nullable: true
          description: Timestamp when payment was received
        fulfilled_at:
          type: string
          format: date-time
          nullable: true
          description: Timestamp when order was fulfilled
        tracking_number:
          type: string
          nullable: true
          description: Shipping tracking number
          maxLength: 255
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - created_at
      - currency
      - customer
      - customer_name
      - customer_phone
      - id
      - item_count
      - subtotal
      - tenant_name
      - total
      - updated_at
    OrderUpdateRequest:
      type: object
      description: Serializer for updating Order (status changes).
      properties:
        status:
          allOf:
          - $ref: '#/components/schemas/Status5f7Enum'
          description: |-
            Order status

            * `draft` - Draft
            * `pending_payment` - Pending Payment
            * `placed` - Placed
            * `paid` - Paid
            * `fulfilled` - Fulfilled
            * `canceled` - Canceled
        payment_ref:
          type: string
          nullable: true
          description: External payment reference ID
          maxLength: 255
        tracking_number:
          type: string
          nullable: true
          description: Shipping tracking number
          maxLength: 255
        metadata:
          description: Additional order metadata
    PaginatedAgentInteractionListList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/AgentInteractionList'
    PaginatedAppointmentListList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/AppointmentList'
    PaginatedAuditLogList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/AuditLog'
    PaginatedAvailabilitySlotList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/AvailabilitySlot'
    PaginatedDocumentChunkList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/DocumentChunk'
    PaginatedDocumentList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/Document'
    PaginatedHumanCorrectionList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/HumanCorrection'
    PaginatedInteractionFeedbackList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/InteractionFeedback'
    PaginatedKnowledgeEntryList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/KnowledgeEntry'
    PaginatedKnowledgeEntrySearchList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/KnowledgeEntrySearch'
    PaginatedPermissionList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/Permission'
    PaginatedRoleList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/Role'
    PaginatedServiceListList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/ServiceList'
    PasswordResetRequest:
      type: object
      description: Serializer for resetting password with token.
      properties:
        token:
          type: string
          minLength: 1
        new_password:
          type: string
          writeOnly: true
          minLength: 1
      required:
      - new_password
      - token
    PasswordResetRequestRequest:
      type: object
      description: Serializer for requesting password reset.
      properties:
        email:
          type: string
          format: email
          minLength: 1
      required:
      - email
    PatchedAppointmentDetailRequest:
      type: object
      description: Serializer for appointment detail view.
      properties:
        start_dt:
          type: string
          format: date-time
          description: Appointment start date and time
        end_dt:
          type: string
          format: date-time
          description: Appointment end date and time
        status:
          allOf:
          - $ref: '#/components/schemas/StatusD3bEnum'
          description: |-
            Current appointment status

            * `pending` - Pending
            * `confirmed` - Confirmed
            * `done` - Done
            * `canceled` - Canceled
            * `no_show` - No Show
        notes:
          type: string
          nullable: true
          description: Customer notes or special requests
        provider_ref:
          type: string
          nullable: true
          description: External calendar or booking system reference
          maxLength: 255
        metadata:
          description: Additional appointment metadata
    PatchedHumanCorrectionRequest:
      type: object
      description: Serializer for human corrections.
      properties:
        agent_interaction:
          type: string
          format: uuid
          description: Agent interaction that was corrected
        conversation:
          type: string
          format: uuid
          description: Conversation this correction belongs to
        bot_response:
          type: string
          minLength: 1
          description: Original bot response that was incorrect
        human_response:
          type: string
          minLength: 1
          description: Corrected response from human agent
        correction_reason:
          type: string
          minLength: 1
          description: Explanation of why correction was needed
        correction_category:
          allOf:
          - $ref: '#/components/schemas/CorrectionCategoryEnum'
          description: |-
            Category of correction

            * `factual_error` - Factual Error
            * `tone_inappropriate` - Inappropriate Tone
            * `missing_information` - Missing Information
            * `wrong_intent` - Wrong Intent Detection
            * `poor_recommendation` - Poor Recommendation
            * `other` - Other
        corrected_by:
          type: string
          format: uuid
          description: Human agent who made the correction
          nullable: true
        approved_for_training:
          type: boolean
          description: Whether this correction is approved for training data
        approved_by:
          type: string
          format: uuid
          description: User who approved this correction for training
          nullable: true
        approved_at:
          type: string
          format: date-time
          nullable: true
          description: When this correction was approved
        quality_score:
          type: number
          format: double
          maximum: 5.0
          minimum: 0.0
          nullable: true
          description: Quality rating of the correction (0-5)
        metadata:
          description: Additional correction metadata
    PatchedKnowledgeEntryUpdateRequest:
      type: object
      description: |-
        Serializer for updating knowledge entries.

        Supports partial updates and handles embedding regeneration when
        title or content changes.
      properties:
        entry_type:
          allOf:
          - $ref: '#/components/schemas/EntryTypeEnum'
          description: |-
            Type of knowledge entry

            * `faq` - FAQ
            * `policy` - Policy
            * `product_info` - Product Information
            * `service_info` - Service Information
            * `procedure` - Procedure
            * `general` - General Knowledge
        category:
          type: string
          description: Category for organizing entries (e.g., 'shipping', 'returns',
            'technical')
          maxLength: 100
        title:
          type: string
          minLength: 1
          description: Title or question for this entry
          maxLength: 255
        content:
          type: string
          minLength: 1
          description: Full content or answer for this entry
        keywords_list:
          type: array
          items:
            type: string
            minLength: 1
          description: List of keywords for search optimization
        metadata:
          description: Additional metadata (source, author, related_entries, etc.)
        priority:
          type: integer
          maximum: 100
          minimum: 0
          description: Priority for ranking search results (0-100, higher = more important)
        is_active:
          type: boolean
          description: Whether this entry is active and should be used by the agent
    PatchedServiceCreateRequest:
      type: object
      description: Serializer for creating services.
      properties:
        title:
          type: string
          minLength: 1
          description: Service title
          maxLength: 500
        description:
          type: string
          nullable: true
          description: Service description
        images:
          description: List of image URLs
        base_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          nullable: true
          description: Base price (can be overridden by variants)
        currency:
          type: string
          minLength: 1
          description: Currency code
          maxLength: 3
        is_active:
          type: boolean
          description: Whether service is active and bookable
        requires_slot:
          type: boolean
          description: Whether service requires time slot booking
        metadata:
          description: Additional service metadata
        variants:
          type: array
          items:
            $ref: '#/components/schemas/ServiceVariantRequest'
    PatchedTenantSettingsReadRequest:
      type: object
      description: |-
        Read-only serializer for TenantSettings.

        Security:
        - Excludes all encrypted credential fields
        - Returns masked versions for configured integrations
        - Safe for general viewing with integrations:view scope
      properties:
        woo_store_url:
          type: string
          format: uri
          nullable: true
          description: WooCommerce store URL
          maxLength: 200
        shopify_shop_domain:
          type: string
          nullable: true
          description: Shopify shop domain (e.g., mystore.myshopify.com)
          maxLength: 255
        stripe_customer_id:
          type: string
          nullable: true
          description: Stripe customer ID for this tenant
          maxLength: 255
        stripe_payment_methods:
          description: 'List of Stripe PaymentMethod IDs: [{id, last4, brand, exp_month,
            exp_year, is_default}]'
        payout_method:
          nullable: true
          description: |-
            Payout method for tenant earnings

            * `bank_transfer` - Bank Transfer
            * `mobile_money` - Mobile Money
            * `paypal` - PayPal
          oneOf:
          - $ref: '#/components/schemas/PayoutMethodEnum'
          - $ref: '#/components/schemas/BlankEnum'
          - $ref: '#/components/schemas/NullEnum'
        notification_settings:
          description: Notification preferences by channel and event type
        feature_flags:
          description: Feature flags for gradual rollout and A/B testing
        business_hours:
          description: Business hours by day of week
        integrations_status:
          description: Status and metadata for each integration
        branding:
          description: Branding and customization settings
        compliance_settings:
          description: GDPR, data retention, and legal compliance settings
    PayoutMethodEnum:
      enum:
      - bank_transfer
      - mobile_money
      - paypal
      type: string
      description: |-
        * `bank_transfer` - Bank Transfer
        * `mobile_money` - Mobile Money
        * `paypal` - PayPal
    Permission:
      type: object
      description: Serializer for Permission model.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        code:
          type: string
          description: Unique permission code (e.g., 'catalog:view')
          maxLength: 100
        label:
          type: string
          description: Human-readable label (e.g., 'View Catalog')
          maxLength: 255
        description:
          type: string
          description: Detailed description of what this permission grants
        category:
          type: string
          description: Permission category (e.g., 'catalog', 'finance', 'users')
          maxLength: 50
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - category
      - code
      - created_at
      - id
      - label
      - updated_at
    ProductCreateRequest:
      type: object
      description: Serializer for creating Product.
      properties:
        external_source:
          nullable: true
          description: |-
            Source system for synchronized products

            * `woocommerce` - WooCommerce
            * `shopify` - Shopify
            * `manual` - Manual
          oneOf:
          - $ref: '#/components/schemas/ExternalSourceEnum'
          - $ref: '#/components/schemas/BlankEnum'
          - $ref: '#/components/schemas/NullEnum'
        external_id:
          type: string
          nullable: true
          description: Product ID in external system
          maxLength: 255
        title:
          type: string
          minLength: 1
          description: Product title
          maxLength: 500
        description:
          type: string
          nullable: true
          description: Product description
        images:
          description: List of image URLs
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Base price
        currency:
          type: string
          minLength: 1
          description: Currency code (ISO 4217)
          maxLength: 3
        sku:
          type: string
          nullable: true
          description: Stock Keeping Unit
          maxLength: 255
        stock:
          type: integer
          nullable: true
          description: Available stock quantity (null = unlimited)
        is_active:
          type: boolean
          description: Whether product is active and visible
        metadata:
          description: Additional product metadata
        variants:
          type: array
          items:
            $ref: '#/components/schemas/ProductVariantCreateRequest'
      required:
      - price
      - title
    ProductDetail:
      type: object
      description: Serializer for Product detail view (with variants).
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        tenant:
          type: string
          format: uuid
          description: Tenant this product belongs to
          readOnly: true
        tenant_name:
          type: string
          readOnly: true
        external_source:
          nullable: true
          description: |-
            Source system for synchronized products

            * `woocommerce` - WooCommerce
            * `shopify` - Shopify
            * `manual` - Manual
          oneOf:
          - $ref: '#/components/schemas/ExternalSourceEnum'
          - $ref: '#/components/schemas/BlankEnum'
          - $ref: '#/components/schemas/NullEnum'
        external_id:
          type: string
          nullable: true
          description: Product ID in external system
          maxLength: 255
        title:
          type: string
          description: Product title
          maxLength: 500
        description:
          type: string
          nullable: true
          description: Product description
        images:
          description: List of image URLs
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Base price
        currency:
          type: string
          description: Currency code (ISO 4217)
          maxLength: 3
        sku:
          type: string
          nullable: true
          description: Stock Keeping Unit
          maxLength: 255
        stock:
          type: integer
          nullable: true
          description: Available stock quantity (null = unlimited)
        is_active:
          type: boolean
          description: Whether product is active and visible
        is_in_stock:
          type: boolean
          readOnly: true
        variant_count:
          type: integer
          readOnly: true
        variants:
          type: array
          items:
            $ref: '#/components/schemas/ProductVariant'
          readOnly: true
        metadata:
          description: Additional product metadata
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - created_at
      - external_id
      - external_source
      - id
      - is_in_stock
      - price
      - tenant
      - tenant_name
      - title
      - updated_at
      - variant_count
      - variants
    ProductList:
      type: object
      description: Serializer for Product list view (without variants).
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        tenant:
          type: string
          format: uuid
          description: Tenant this product belongs to
          readOnly: true
        tenant_name:
          type: string
          readOnly: true
        external_source:
          nullable: true
          description: |-
            Source system for synchronized products

            * `woocommerce` - WooCommerce
            * `shopify` - Shopify
            * `manual` - Manual
          oneOf:
          - $ref: '#/components/schemas/ExternalSourceEnum'
          - $ref: '#/components/schemas/BlankEnum'
          - $ref: '#/components/schemas/NullEnum'
        external_id:
          type: string
          nullable: true
          description: Product ID in external system
          maxLength: 255
        title:
          type: string
          description: Product title
          maxLength: 500
        description:
          type: string
          nullable: true
          description: Product description
        images:
          description: List of image URLs
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Base price
        currency:
          type: string
          description: Currency code (ISO 4217)
          maxLength: 3
        sku:
          type: string
          nullable: true
          description: Stock Keeping Unit
          maxLength: 255
        stock:
          type: integer
          nullable: true
          description: Available stock quantity (null = unlimited)
        is_active:
          type: boolean
          description: Whether product is active and visible
        is_in_stock:
          type: boolean
          readOnly: true
        variant_count:
          type: integer
          readOnly: true
        metadata:
          description: Additional product metadata
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - created_at
      - external_id
      - external_source
      - id
      - is_in_stock
      - price
      - tenant
      - tenant_name
      - title
      - updated_at
      - variant_count
    ProductUpdateRequest:
      type: object
      description: Serializer for updating Product.
      properties:
        title:
          type: string
          minLength: 1
          description: Product title
          maxLength: 500
        description:
          type: string
          nullable: true
          description: Product description
        images:
          description: List of image URLs
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Base price
        currency:
          type: string
          minLength: 1
          description: Currency code (ISO 4217)
          maxLength: 3
        sku:
          type: string
          nullable: true
          description: Stock Keeping Unit
          maxLength: 255
        stock:
          type: integer
          nullable: true
          description: Available stock quantity (null = unlimited)
        is_active:
          type: boolean
          description: Whether product is active and visible
        metadata:
          description: Additional product metadata
    ProductVariant:
      type: object
      description: Serializer for ProductVariant.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        product:
          type: string
          format: uuid
          description: Product this variant belongs to
          readOnly: true
        title:
          type: string
          description: Variant title (e.g., 'Large / Red')
          maxLength: 255
        sku:
          type: string
          nullable: true
          description: Stock Keeping Unit for this variant
          maxLength: 255
        stock:
          type: integer
          nullable: true
          description: Available stock quantity (null = unlimited)
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          nullable: true
          description: Variant-specific price (null = use product price)
        effective_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          readOnly: true
          description: Effective price (variant price or product price)
        currency:
          type: string
          readOnly: true
        attrs:
          description: 'Variant attributes (e.g., {''size'': ''L'', ''color'': ''red''})'
        metadata:
          description: Additional variant metadata
        is_in_stock:
          type: boolean
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - created_at
      - currency
      - effective_price
      - id
      - is_in_stock
      - product
      - title
      - updated_at
    ProductVariantCreateRequest:
      type: object
      description: Serializer for creating ProductVariant.
      properties:
        title:
          type: string
          minLength: 1
          description: Variant title (e.g., 'Large / Red')
          maxLength: 255
        sku:
          type: string
          nullable: true
          description: Stock Keeping Unit for this variant
          maxLength: 255
        stock:
          type: integer
          nullable: true
          description: Available stock quantity (null = unlimited)
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          nullable: true
          description: Variant-specific price (null = use product price)
        attrs:
          description: 'Variant attributes (e.g., {''size'': ''L'', ''color'': ''red''})'
        metadata:
          description: Additional variant metadata
      required:
      - title
    RateLimitStatus:
      type: object
      description: Serializer for rate limit status.
      properties:
        current_count:
          type: integer
          readOnly: true
        daily_limit:
          type: integer
          readOnly: true
          nullable: true
        percentage_used:
          type: number
          format: double
          readOnly: true
        remaining:
          type: integer
          readOnly: true
          nullable: true
        is_unlimited:
          type: boolean
          readOnly: true
        warning_threshold_reached:
          type: boolean
          readOnly: true
      required:
      - current_count
      - daily_limit
      - is_unlimited
      - percentage_used
      - remaining
      - warning_threshold_reached
    RegistrationRequest:
      type: object
      description: Serializer for user registration.
      properties:
        email:
          type: string
          format: email
          minLength: 1
        password:
          type: string
          writeOnly: true
          minLength: 1
        first_name:
          type: string
          minLength: 1
          maxLength: 100
        last_name:
          type: string
          minLength: 1
          maxLength: 100
        business_name:
          type: string
          minLength: 1
          maxLength: 255
      required:
      - business_name
      - email
      - first_name
      - last_name
      - password
    Role:
      type: object
      description: Serializer for Role model.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        name:
          type: string
          description: Role name (e.g., 'Owner', 'Catalog Manager')
          maxLength: 100
        description:
          type: string
          description: Role description
        is_system:
          type: boolean
          readOnly: true
          description: Whether this is a system-seeded role
        permission_count:
          type: string
          readOnly: true
        permissions:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - created_at
      - id
      - is_system
      - name
      - permission_count
      - permissions
      - updated_at
    RoleCreateRequest:
      type: object
      description: Serializer for creating roles.
      properties:
        name:
          type: string
          minLength: 1
          description: Role name (e.g., 'Owner', 'Catalog Manager')
          maxLength: 100
        description:
          type: string
          description: Role description
      required:
      - name
    RoleDetail:
      type: object
      description: Detailed serializer for Role with full permission list.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        name:
          type: string
          description: Role name (e.g., 'Owner', 'Catalog Manager')
          maxLength: 100
        description:
          type: string
          description: Role description
        is_system:
          type: boolean
          readOnly: true
          description: Whether this is a system-seeded role
        permission_count:
          type: string
          readOnly: true
        permissions:
          type: array
          items:
            $ref: '#/components/schemas/Permission'
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - created_at
      - id
      - is_system
      - name
      - permission_count
      - permissions
      - updated_at
    RolePermissionRequest:
      type: object
      description: Serializer for adding permissions to a role.
      properties:
        permission_codes:
          type: array
          items:
            type: string
            minLength: 1
          description: List of permission codes to add to the role
      required:
      - permission_codes
    ScheduleMessageMessageTypeEnum:
      enum:
      - scheduled_promotional
      - automated_reminder
      - automated_reengagement
      type: string
      description: |-
        * `scheduled_promotional` - Scheduled Promotional
        * `automated_reminder` - Automated Reminder
        * `automated_reengagement` - Automated Re-engagement
    ScheduleMessageRequest:
      type: object
      description: Serializer for scheduling messages.
      properties:
        customer_id:
          type: string
          format: uuid
          nullable: true
          description: Customer ID (null for broadcast)
        content:
          type: string
          minLength: 1
          description: Message content
          maxLength: 4096
        scheduled_at:
          type: string
          format: date-time
          description: When to send the message (ISO 8601 format)
        message_type:
          allOf:
          - $ref: '#/components/schemas/ScheduleMessageMessageTypeEnum'
          default: scheduled_promotional
          description: |-
            Type of message

            * `scheduled_promotional` - Scheduled Promotional
            * `automated_reminder` - Automated Reminder
            * `automated_reengagement` - Automated Re-engagement
        template_id:
          type: string
          format: uuid
          nullable: true
          description: Optional template ID
        template_context:
          description: Template context variables
        recipient_criteria:
          description: Criteria for broadcast targeting
        metadata:
          description: Additional metadata
      required:
      - content
      - scheduled_at
    ScheduledMessage:
      type: object
      description: Serializer for ScheduledMessage.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        tenant:
          type: string
          format: uuid
          description: Tenant this scheduled message belongs to
          readOnly: true
        customer:
          type: string
          format: uuid
          description: Target customer (null for broadcast campaigns)
          nullable: true
        customer_name:
          type: string
          readOnly: true
          nullable: true
        content:
          type: string
          description: Message content to send (max 10,000 characters)
          maxLength: 10000
        template:
          type: string
          format: uuid
          description: Template used for this message
          nullable: true
        template_context:
          description: Context data for template rendering
        scheduled_at:
          type: string
          format: date-time
          description: When to send this message
        status:
          allOf:
          - $ref: '#/components/schemas/ScheduledMessageStatusEnum'
          readOnly: true
          description: |-
            Current status of scheduled message

            * `pending` - Pending
            * `sent` - Sent
            * `failed` - Failed
            * `canceled` - Canceled
        status_display:
          type: string
          readOnly: true
        recipient_criteria:
          description: Criteria for selecting recipients (for broadcast messages)
        message_type:
          type: string
          description: Type of message for consent checking
          maxLength: 30
        sent_at:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: Timestamp when message was actually sent
        failed_at:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: Timestamp when sending failed
        error_message:
          type: string
          readOnly: true
          nullable: true
          description: Error message if sending failed
        message:
          type: string
          format: uuid
          description: Message record created when sent
          readOnly: true
          nullable: true
        metadata:
          description: Additional metadata (campaign_id, appointment_id, etc.)
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
      required:
      - content
      - created_at
      - customer_name
      - error_message
      - failed_at
      - id
      - message
      - scheduled_at
      - sent_at
      - status
      - status_display
      - tenant
    ScheduledMessageStatusEnum:
      enum:
      - pending
      - sent
      - failed
      - canceled
      type: string
      description: |-
        * `pending` - Pending
        * `sent` - Sent
        * `failed` - Failed
        * `canceled` - Canceled
    SendMessageMessageTypeEnum:
      enum:
      - manual_outbound
      - automated_transactional
      - automated_reminder
      - automated_reengagement
      - scheduled_promotional
      type: string
      description: |-
        * `manual_outbound` - Manual Outbound
        * `automated_transactional` - Automated Transactional
        * `automated_reminder` - Automated Reminder
        * `automated_reengagement` - Automated Re-engagement
        * `scheduled_promotional` - Scheduled Promotional
    SendMessageRequest:
      type: object
      description: Serializer for sending outbound messages.
      properties:
        customer_id:
          type: string
          format: uuid
          description: Customer ID to send message to
        content:
          type: string
          minLength: 1
          description: Message content
          maxLength: 4096
        message_type:
          allOf:
          - $ref: '#/components/schemas/SendMessageMessageTypeEnum'
          default: manual_outbound
          description: |-
            Type of message

            * `manual_outbound` - Manual Outbound
            * `automated_transactional` - Automated Transactional
            * `automated_reminder` - Automated Reminder
            * `automated_reengagement` - Automated Re-engagement
            * `scheduled_promotional` - Scheduled Promotional
        template_id:
          type: string
          format: uuid
          nullable: true
          description: Optional template ID
        template_context:
          description: Template context variables
        media_url:
          type: string
          format: uri
          nullable: true
          minLength: 1
          description: Optional media URL
        skip_consent_check:
          type: boolean
          default: false
          description: Skip consent validation (for transactional messages)
      required:
      - content
      - customer_id
    ServiceCreateRequest:
      type: object
      description: Serializer for creating services.
      properties:
        title:
          type: string
          minLength: 1
          description: Service title
          maxLength: 500
        description:
          type: string
          nullable: true
          description: Service description
        images:
          description: List of image URLs
        base_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          nullable: true
          description: Base price (can be overridden by variants)
        currency:
          type: string
          minLength: 1
          description: Currency code
          maxLength: 3
        is_active:
          type: boolean
          description: Whether service is active and bookable
        requires_slot:
          type: boolean
          description: Whether service requires time slot booking
        metadata:
          description: Additional service metadata
        variants:
          type: array
          items:
            $ref: '#/components/schemas/ServiceVariantRequest'
      required:
      - title
    ServiceDetail:
      type: object
      description: Serializer for service detail view with variants.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        title:
          type: string
          description: Service title
          maxLength: 500
        description:
          type: string
          nullable: true
          description: Service description
        images:
          description: List of image URLs
        base_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          nullable: true
          description: Base price (can be overridden by variants)
        price_display:
          type: string
          readOnly: true
        currency:
          type: string
          description: Currency code
          maxLength: 3
        is_active:
          type: boolean
          description: Whether service is active and bookable
        requires_slot:
          type: boolean
          description: Whether service requires time slot booking
        variants:
          type: array
          items:
            $ref: '#/components/schemas/ServiceVariant'
          readOnly: true
        metadata:
          description: Additional service metadata
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - created_at
      - id
      - price_display
      - title
      - updated_at
      - variants
    ServiceList:
      type: object
      description: Serializer for service list view.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        title:
          type: string
          description: Service title
          maxLength: 500
        description:
          type: string
          nullable: true
          description: Service description
        images:
          description: List of image URLs
        base_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          nullable: true
          description: Base price (can be overridden by variants)
        price_display:
          type: string
          readOnly: true
        currency:
          type: string
          description: Currency code
          maxLength: 3
        is_active:
          type: boolean
          description: Whether service is active and bookable
        requires_slot:
          type: boolean
          description: Whether service requires time slot booking
        variant_count:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
      required:
      - created_at
      - id
      - price_display
      - title
      - variant_count
    ServiceListRequest:
      type: object
      description: Serializer for service list view.
      properties:
        title:
          type: string
          minLength: 1
          description: Service title
          maxLength: 500
        description:
          type: string
          nullable: true
          description: Service description
        images:
          description: List of image URLs
        base_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          nullable: true
          description: Base price (can be overridden by variants)
        currency:
          type: string
          minLength: 1
          description: Currency code
          maxLength: 3
        is_active:
          type: boolean
          description: Whether service is active and bookable
        requires_slot:
          type: boolean
          description: Whether service requires time slot booking
      required:
      - title
    ServiceVariant:
      type: object
      description: Serializer for service variants.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        title:
          type: string
          description: Variant title (e.g., '30-minute session')
          maxLength: 255
        duration_minutes:
          type: integer
          description: Duration in minutes
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          nullable: true
          description: Variant price (overrides service base_price if set)
        price_display:
          type: string
          readOnly: true
        attrs:
          description: 'Custom attributes (e.g., {''level'': ''premium'', ''therapist'':
            ''senior''})'
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - created_at
      - duration_minutes
      - id
      - price_display
      - title
      - updated_at
    ServiceVariantRequest:
      type: object
      description: Serializer for service variants.
      properties:
        title:
          type: string
          minLength: 1
          description: Variant title (e.g., '30-minute session')
          maxLength: 255
        duration_minutes:
          type: integer
          description: Duration in minutes
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          nullable: true
          description: Variant price (overrides service base_price if set)
        attrs:
          description: 'Custom attributes (e.g., {''level'': ''premium'', ''therapist'':
            ''senior''})'
      required:
      - duration_minutes
      - title
    ShopifyCredentialsRequest:
      type: object
      description: Serializer for setting Shopify credentials.
      properties:
        shop_domain:
          type: string
          minLength: 1
        access_token:
          type: string
          minLength: 10
        webhook_secret:
          type: string
        test_connection:
          type: boolean
          default: true
      required:
      - access_token
      - shop_domain
    SourceEnum:
      enum:
      - customer_initiated
      - tenant_updated
      - system_default
      type: string
      description: |-
        * `customer_initiated` - Customer Initiated
        * `tenant_updated` - Tenant Updated
        * `system_default` - System Default
    Status179Enum:
      enum:
      - active
      - trial
      - trial_expired
      - suspended
      - canceled
      type: string
      description: |-
        * `active` - Active
        * `trial` - Free Trial
        * `trial_expired` - Trial Expired
        * `suspended` - Suspended
        * `canceled` - Canceled
    Status5f7Enum:
      enum:
      - draft
      - pending_payment
      - placed
      - paid
      - fulfilled
      - canceled
      type: string
      description: |-
        * `draft` - Draft
        * `pending_payment` - Pending Payment
        * `placed` - Placed
        * `paid` - Paid
        * `fulfilled` - Fulfilled
        * `canceled` - Canceled
    StatusD3bEnum:
      enum:
      - pending
      - confirmed
      - done
      - canceled
      - no_show
      type: string
      description: |-
        * `pending` - Pending
        * `confirmed` - Confirmed
        * `done` - Done
        * `canceled` - Canceled
        * `no_show` - No Show
    TenantCreateRequest:
      type: object
      description: Serializer for tenant creation.
      properties:
        name:
          type: string
          minLength: 1
          description: Business name
          maxLength: 255
        slug:
          type: string
          description: URL-friendly identifier (auto-generated if not provided)
          maxLength: 100
          pattern: ^[-a-zA-Z0-9_]+$
        whatsapp_number:
          type: string
          description: WhatsApp business number in E.164 format (optional)
          maxLength: 20
      required:
      - name
    TenantDetail:
      type: object
      description: Serializer for tenant detail view.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        name:
          type: string
          readOnly: true
          description: Business name
        slug:
          type: string
          readOnly: true
          description: URL-friendly identifier
          pattern: ^[-a-zA-Z0-9_]+$
        status:
          allOf:
          - $ref: '#/components/schemas/Status179Enum'
          readOnly: true
          description: |-
            Current tenant status

            * `active` - Active
            * `trial` - Free Trial
            * `trial_expired` - Trial Expired
            * `suspended` - Suspended
            * `canceled` - Canceled
        subscription_tier:
          type: string
          format: uuid
          description: Current subscription tier
          readOnly: true
          nullable: true
        tier_name:
          type: string
          readOnly: true
          nullable: true
        subscription_waived:
          type: boolean
          readOnly: true
          description: Whether subscription fees are waived
        trial_start_date:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: Free trial start date
        trial_end_date:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: Free trial end date
        whatsapp_number:
          type: string
          readOnly: true
          description: WhatsApp business number (E.164 format)
        contact_email:
          type: string
          format: email
          readOnly: true
          nullable: true
          description: Primary contact email for notifications
        contact_phone:
          type: string
          readOnly: true
          nullable: true
          description: Primary contact phone
        timezone:
          type: string
          readOnly: true
          description: Tenant timezone for scheduling
        quiet_hours_start:
          type: string
          format: time
          readOnly: true
          description: Start of quiet hours (no automated messages)
        quiet_hours_end:
          type: string
          format: time
          readOnly: true
          description: End of quiet hours
        role:
          type: string
          readOnly: true
        roles:
          type: string
          readOnly: true
        onboarding_status:
          type: string
          readOnly: true
        subscription:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - contact_email
      - contact_phone
      - created_at
      - id
      - name
      - onboarding_status
      - quiet_hours_end
      - quiet_hours_start
      - role
      - roles
      - slug
      - status
      - subscription
      - subscription_tier
      - subscription_waived
      - tier_name
      - timezone
      - trial_end_date
      - trial_start_date
      - updated_at
      - whatsapp_number
    TenantList:
      type: object
      description: Serializer for tenant list view.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        name:
          type: string
          readOnly: true
          description: Business name
        slug:
          type: string
          readOnly: true
          description: URL-friendly identifier
          pattern: ^[-a-zA-Z0-9_]+$
        status:
          allOf:
          - $ref: '#/components/schemas/Status179Enum'
          readOnly: true
          description: |-
            Current tenant status

            * `active` - Active
            * `trial` - Free Trial
            * `trial_expired` - Trial Expired
            * `suspended` - Suspended
            * `canceled` - Canceled
        tier_name:
          type: string
          readOnly: true
          nullable: true
        whatsapp_number:
          type: string
          readOnly: true
          description: WhatsApp business number (E.164 format)
        role:
          type: string
          readOnly: true
        onboarding_status:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - created_at
      - id
      - name
      - onboarding_status
      - role
      - slug
      - status
      - tier_name
      - updated_at
      - whatsapp_number
    TenantMember:
      type: object
      description: Serializer for tenant member.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        user_id:
          type: string
          format: uuid
          readOnly: true
        email:
          type: string
          format: email
          readOnly: true
        first_name:
          type: string
          readOnly: true
        last_name:
          type: string
          readOnly: true
        roles:
          type: string
          readOnly: true
        invite_status:
          type: string
          readOnly: true
        joined_at:
          type: string
          format: date-time
          readOnly: true
        last_seen_at:
          type: string
          format: date-time
          readOnly: true
      required:
      - email
      - first_name
      - id
      - invite_status
      - joined_at
      - last_name
      - last_seen_at
      - roles
      - user_id
    TenantMemberInviteRequest:
      type: object
      description: Serializer for inviting a member to tenant.
      properties:
        email:
          type: string
          format: email
          minLength: 1
          description: Email address of user to invite
        roles:
          type: array
          items:
            type: string
            minLength: 1
          description: List of role names to assign (e.g., ['Admin', 'Catalog Manager'])
      required:
      - email
      - roles
    TenantSettingsRead:
      type: object
      description: |-
        Read-only serializer for TenantSettings.

        Security:
        - Excludes all encrypted credential fields
        - Returns masked versions for configured integrations
        - Safe for general viewing with integrations:view scope
      properties:
        tenant:
          type: string
          format: uuid
          description: Associated tenant
          readOnly: true
        has_woocommerce:
          type: string
          readOnly: true
        has_shopify:
          type: string
          readOnly: true
        has_twilio:
          type: string
          readOnly: true
        has_openai:
          type: string
          readOnly: true
        woo_configured:
          type: string
          readOnly: true
        shopify_configured:
          type: string
          readOnly: true
        twilio_configured:
          type: string
          readOnly: true
        woo_store_url:
          type: string
          format: uri
          nullable: true
          description: WooCommerce store URL
          maxLength: 200
        shopify_shop_domain:
          type: string
          nullable: true
          description: Shopify shop domain (e.g., mystore.myshopify.com)
          maxLength: 255
        stripe_customer_id:
          type: string
          nullable: true
          description: Stripe customer ID for this tenant
          maxLength: 255
        stripe_payment_methods:
          description: 'List of Stripe PaymentMethod IDs: [{id, last4, brand, exp_month,
            exp_year, is_default}]'
        payout_method:
          nullable: true
          description: |-
            Payout method for tenant earnings

            * `bank_transfer` - Bank Transfer
            * `mobile_money` - Mobile Money
            * `paypal` - PayPal
          oneOf:
          - $ref: '#/components/schemas/PayoutMethodEnum'
          - $ref: '#/components/schemas/BlankEnum'
          - $ref: '#/components/schemas/NullEnum'
        notification_settings:
          description: Notification preferences by channel and event type
        feature_flags:
          description: Feature flags for gradual rollout and A/B testing
        business_hours:
          description: Business hours by day of week
        integrations_status:
          description: Status and metadata for each integration
        branding:
          description: Branding and customization settings
        compliance_settings:
          description: GDPR, data retention, and legal compliance settings
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - created_at
      - has_openai
      - has_shopify
      - has_twilio
      - has_woocommerce
      - shopify_configured
      - tenant
      - twilio_configured
      - updated_at
      - woo_configured
    TenantUpdateRequest:
      type: object
      description: Serializer for tenant update.
      properties:
        name:
          type: string
          minLength: 1
          description: Business name
          maxLength: 255
        contact_email:
          type: string
          format: email
          description: Primary contact email
        contact_phone:
          type: string
          description: Primary contact phone
          maxLength: 20
        timezone:
          type: string
          minLength: 1
          description: Tenant timezone
          maxLength: 50
    TenantUserRole:
      type: object
      description: Serializer for TenantUserRole (role assignments).
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        role:
          allOf:
          - $ref: '#/components/schemas/Role'
          readOnly: true
        assigned_by_email:
          type: string
          format: email
          readOnly: true
        assigned_at:
          type: string
          format: date-time
          readOnly: true
          description: When role was assigned
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
      required:
      - assigned_at
      - assigned_by_email
      - created_at
      - id
      - role
    ToneEnum:
      enum:
      - professional
      - friendly
      - casual
      - formal
      type: string
      description: |-
        * `professional` - Professional
        * `friendly` - Friendly
        * `casual` - Casual
        * `formal` - Formal
    TrackButtonClickRequest:
      type: object
      description: Serializer for tracking button clicks.
      properties:
        button_id:
          type: string
          minLength: 1
          description: ID of the button that was clicked
        button_title:
          type: string
          minLength: 1
          description: Title/text of the button
          maxLength: 100
        button_type:
          allOf:
          - $ref: '#/components/schemas/ButtonTypeEnum'
          default: reply
          description: |-
            Type of button clicked

            * `reply` - reply
            * `url` - url
            * `call` - call
        message_id:
          type: string
          format: uuid
          description: ID of the campaign message containing the button
        metadata:
          description: Additional metadata
      required:
      - button_id
      - button_title
      - message_id
    Transaction:
      type: object
      description: Serializer for Transaction.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        tenant:
          type: string
          format: uuid
          description: Tenant this transaction belongs to
          readOnly: true
        tenant_name:
          type: string
          readOnly: true
        wallet:
          type: string
          format: uuid
          description: Wallet this transaction affects
          readOnly: true
        transaction_type:
          allOf:
          - $ref: '#/components/schemas/TransactionTypeEnum'
          description: |-
            Type of transaction

            * `customer_payment` - Customer Payment
            * `platform_fee` - Platform Fee
            * `withdrawal` - Withdrawal
            * `refund` - Refund
            * `adjustment` - Adjustment
        amount:
          type: string
          format: decimal
          pattern: ^-?\d{0,10}(?:\.\d{0,2})?$
          description: Transaction amount (gross)
        fee:
          type: string
          format: decimal
          pattern: ^-?\d{0,10}(?:\.\d{0,2})?$
          description: Platform fee (for customer_payment type)
        net_amount:
          type: string
          format: decimal
          pattern: ^-?\d{0,10}(?:\.\d{0,2})?$
          description: Net amount after fees
        currency:
          type: string
          readOnly: true
        status:
          allOf:
          - $ref: '#/components/schemas/TransactionStatusEnum'
          description: |-
            Transaction status

            * `pending` - Pending
            * `completed` - Completed
            * `failed` - Failed
            * `canceled` - Canceled
        reference_type:
          type: string
          nullable: true
          description: Type of related entity (e.g., 'order', 'appointment')
          maxLength: 50
        reference_id:
          type: string
          format: uuid
          nullable: true
          description: ID of related entity
        metadata:
          description: Additional transaction metadata
        notes:
          type: string
          description: Internal notes about the transaction
        initiated_by:
          type: string
          format: uuid
          description: User who initiated the transaction (for four-eyes approval)
          readOnly: true
          nullable: true
        initiated_by_email:
          type: string
          readOnly: true
          nullable: true
        approved_by:
          type: string
          format: uuid
          description: User who approved the transaction (for four-eyes approval)
          readOnly: true
          nullable: true
        approved_by_email:
          type: string
          readOnly: true
          nullable: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - amount
      - approved_by
      - approved_by_email
      - created_at
      - currency
      - id
      - initiated_by
      - initiated_by_email
      - net_amount
      - tenant
      - tenant_name
      - transaction_type
      - updated_at
      - wallet
    TransactionStatusEnum:
      enum:
      - pending
      - completed
      - failed
      - canceled
      type: string
      description: |-
        * `pending` - Pending
        * `completed` - Completed
        * `failed` - Failed
        * `canceled` - Canceled
    TransactionTypeEnum:
      enum:
      - customer_payment
      - platform_fee
      - withdrawal
      - refund
      - adjustment
      type: string
      description: |-
        * `customer_payment` - Customer Payment
        * `platform_fee` - Platform Fee
        * `withdrawal` - Withdrawal
        * `refund` - Refund
        * `adjustment` - Adjustment
    TwilioCredentialsRequest:
      type: object
      description: Serializer for setting Twilio credentials.
      properties:
        sid:
          type: string
          minLength: 34
          maxLength: 34
        token:
          type: string
          minLength: 32
        webhook_secret:
          type: string
        whatsapp_number:
          type: string
      required:
      - sid
      - token
    User:
      type: object
      description: Serializer for User model.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        email:
          type: string
          format: email
          description: User email address (unique globally)
          maxLength: 254
        first_name:
          type: string
          description: User first name
          maxLength: 100
        last_name:
          type: string
          description: User last name
          maxLength: 100
        full_name:
          type: string
          readOnly: true
        is_active:
          type: boolean
          description: Whether user account is active
        two_factor_enabled:
          type: boolean
          description: Whether 2FA is enabled
        last_login_at:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: Last login timestamp
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - created_at
      - email
      - full_name
      - id
      - last_login_at
      - updated_at
    UserPermission:
      type: object
      description: Serializer for UserPermission (permission overrides).
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        permission:
          allOf:
          - $ref: '#/components/schemas/Permission'
          readOnly: true
        granted:
          type: boolean
          description: True = grant, False = deny (deny wins over role grants)
        reason:
          type: string
          description: Reason for this override
        granted_by_email:
          type: string
          format: email
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
      required:
      - created_at
      - granted
      - granted_by_email
      - id
      - permission
      - updated_at
    UserPermissionCreateRequest:
      type: object
      description: Serializer for creating user permission overrides.
      properties:
        permission_code:
          type: string
          minLength: 1
        granted:
          type: boolean
        reason:
          type: string
          description: Reason for this permission override
      required:
      - granted
      - permission_code
    UserProfile:
      type: object
      description: |-
        Comprehensive serializer for user profile (GET /v1/auth/me).

        Returns complete user information including:
        - Basic profile (name, email, phone)
        - Account status (active, verified, 2FA)
        - All tenant memberships with roles and permissions
        - Activity timestamps
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
          description: Unique identifier
        email:
          type: string
          format: email
          readOnly: true
          description: User email address (unique globally)
        first_name:
          type: string
          description: User first name
          maxLength: 100
        last_name:
          type: string
          description: User last name
          maxLength: 100
        full_name:
          type: string
          readOnly: true
        phone:
          type: string
          nullable: true
          description: Encrypted phone number
          maxLength: 500
        is_active:
          type: boolean
          readOnly: true
          description: Whether user account is active
        is_superuser:
          type: boolean
          readOnly: true
          description: Platform administrator (use sparingly in production)
        email_verified:
          type: boolean
          readOnly: true
          description: Whether email has been verified
        two_factor_enabled:
          type: boolean
          readOnly: true
          description: Whether 2FA is enabled
        last_login_at:
          type: string
          format: date-time
          readOnly: true
          nullable: true
          description: Last login timestamp
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the record was last updated
        tenants:
          type: string
          readOnly: true
        total_tenants:
          type: string
          readOnly: true
        pending_invites:
          type: string
          readOnly: true
      required:
      - created_at
      - email
      - email_verified
      - full_name
      - id
      - is_active
      - is_superuser
      - last_login_at
      - pending_invites
      - tenants
      - total_tenants
      - two_factor_enabled
      - updated_at
    WalletBalance:
      type: object
      description: Serializer for wallet balance response.
      properties:
        balance:
          type: string
          format: decimal
          pattern: ^-?\d{0,10}(?:\.\d{0,2})?$
        currency:
          type: string
          maxLength: 3
        minimum_withdrawal:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
      required:
      - balance
      - currency
      - minimum_withdrawal
    WithdrawalProcessRequest:
      type: object
      description: Serializer for processing withdrawal (admin).
      properties:
        action:
          allOf:
          - $ref: '#/components/schemas/ActionEnum'
          description: |-
            Action to take: complete or fail

            * `complete` - complete
            * `fail` - fail
        reason:
          type: string
          description: Reason for failure (required if action is 'fail')
        notes:
          type: string
          description: Admin notes
      required:
      - action
    WithdrawalRequestRequest:
      type: object
      description: Serializer for withdrawal request.
      properties:
        amount:
          type: string
          format: decimal
          pattern: ^-?\d{0,10}(?:\.\d{0,2})?$
          description: Withdrawal amount
        bank_account:
          type: string
          description: Bank account information
        notes:
          type: string
          description: Additional notes
      required:
      - amount
    WooCommerceCredentialsRequest:
      type: object
      description: Serializer for setting WooCommerce credentials.
      properties:
        store_url:
          type: string
          format: uri
          minLength: 1
        consumer_key:
          type: string
          minLength: 10
        consumer_secret:
          type: string
          minLength: 10
        webhook_secret:
          type: string
        test_connection:
          type: boolean
          default: true
      required:
      - consumer_key
      - consumer_secret
      - store_url
  securitySchemes:
    JWTAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: 'JWT token obtained from /v1/auth/login or /v1/auth/register. Include
        as: Authorization: Bearer <token>. For tenant-scoped operations, also include
        X-TENANT-ID header.'
servers:
- url: http://localhost:8000
  description: Development server
- url: https://api-staging.tulia.ai
  description: Staging server
- url: https://api.tulia.ai
  description: Production server
tags:
- name: Authentication
  description: User registration, login, and profile management
- name: Tenant Management
  description: Tenant creation, listing, and member management
- name: Settings
  description: General tenant settings and business configuration
- name: Settings - API Keys
  description: API key generation and management
- name: Settings - Onboarding
  description: Onboarding status tracking and completion
- name: Integrations
  description: External service integrations (Twilio, WooCommerce, Shopify, OpenAI)
- name: Finance - Payment Methods
  description: Payment method management for subscription billing
- name: Finance - Payout Methods
  description: Payout method configuration for receiving earnings
- name: Finance - Wallet
  description: Wallet balance and transaction management
- name: Finance - Withdrawals
  description: Withdrawal requests with four-eyes approval
- name: RBAC - Memberships
  description: User membership and invitation management
- name: RBAC - Roles
  description: Role management and permission assignments
- name: RBAC - Permissions
  description: Permission listing and user-specific overrides
- name: RBAC - Audit
  description: Audit log viewing for compliance
- name: Catalog
  description: Product catalog management
- name: Services
  description: Bookable services and availability
- name: Orders
  description: Order management
- name: Appointments
  description: Appointment booking and management
- name: Messaging
  description: WhatsApp messaging and conversations
- name: Analytics
  description: Business analytics and reporting
- name: Test Utilities
  description: Testing and development utilities (disable in production)
